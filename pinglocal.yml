{"id":"f41e03e3-5ffa-4562-8a47-aed454396cfd","updated_at":"2025-03-26T03:12:19.305Z","updated_by":"purple1","created_at":"2025-03-25T02:37:48.368Z","created_by":"elastic","name":"UC409 : Linux Scheduled Cron Task/Job","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Detects cron activities which could indicates potential persistence.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"71bab070-c29c-4a31-9a27-5853a07fdf83","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1007","name":"System Service Discovery","reference":"https://attack.mitre.org/techniques/T1007","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1053","name":"Scheduled Task/Job","reference":"https://attack.mitre.org/techniques/T1053","subtechnique":[]}]}],"to":"now","references":["https://gtfobins.github.io/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\nand\n(\n    (\n        event.action : \"cwd\"\n        and \n        (\n            process.working_directory : \"/etc/cron.d/*\"\n            or process.working_directory : \"/etc/cron.daily/*\"\n            or process.working_directory : \"/etc/cron.hourly/*\"\n            or process.working_directory : \"/etc/cron.monthly/*\"\n            or process.working_directory : \"/etc/cron.weekly/*\"\n            or process.working_directory : \"/var/spool/cron/crontabs/*\"\n        )\n    )\n    or\n    (\n        event.action : \"cwd\" and process.working_directory in (\"/etc/cron.allow\", \"/etc/cron.deny\", \"/etc/crontab\")\n    )\n    or\n    (\n        event.action : \"execve\" and process.args in (\"at\", \"atd\")\n    )\n    or\n    (\n        event.action : \"execve\" and process.executable : \"crontab\" and process.args in (\"-l\", \"-r\", \"/tmp/\")\n    )\n    or\n    (\n        event.action : \"execve\" and process.executable : \"cp\" and process.args : \"/bin/sh\" and process.args : \"/crond\"\n    )\n)","filters":[],"actions":[]}
{"id":"8a229a12-e350-462b-9a23-221ecc9b4545","updated_at":"2025-03-26T02:07:15.062Z","updated_by":"purple1","created_at":"2025-03-25T02:36:56.125Z","created_by":"elastic","name":"UC174 : Reverse Shell Detection","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Detects suspicious shell commands or program code that may be executed or used in command line to establish a reverse shell\n","risk_score":99,"severity":"critical","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"41377617-3a4f-4cc2-bddb-2eb40b85cb0d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.004","name":"Unix Shell","reference":"https://attack.mitre.org/techniques/T1059/004"}]}]}],"to":"now","references":["https://attack.mitre.org/techniques/T1059/004/","https://github.com/SigmaHQ/sigma/blob/master/rules/linux/lnx_shell_susp_rev_shells.yml"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"syscall\"\n        and\n        (\n            (process.executable : \"sh\" and process.args : \"-i\")\n            or (process.executable : \"python\" and process.args : \"-c\" and process.args : \"import\")\n            or (process.executable : \"php\" and process.args : \"-r\")\n            or (process.executable : \"nc\" and process.args : \"-\")\n            or (process.executable : \"python\" and process.args : \"-c\")\n        )","filters":[],"actions":[]}
{"id":"b814ca81-9573-425d-b193-48c04257f10a","updated_at":"2025-03-25T02:37:24.262Z","updated_by":"elastic","created_at":"2025-03-25T02:37:24.262Z","created_by":"elastic","name":"UC249 : Data exfiltration using linux binaries","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"Data exfiltration using linux binaries","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"74a13596-bf11-4cb1-af6d-12a82743442f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.hackingarticles.in/data-exfiltration-using-linux-binaries/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action : \"execve\"\n    and \n    (\n        (process.args : \"cancel\" and process.args : \"-u\" and process.args : \"h\")\n        or (process.args : \"wget\" and process.args : \"--post\" and process.args : \"-file\")\n        or (process.args : \"whois\" and process.args : \"-h\" and process.args :\"-p\")\n        or (process.args : \"openssl\" and process.args : \"s_client\" and process.args :\"-quiet\" and process.args : \"-connect\")\n        or (process.args : \"busybox\" and process.args : \"httpd\")\n        or (process.args : \"nc\" and process.args : \"-lvp\")\n        or (process.args : \"ksh\" and process.args : \"/tcp\")\n        or (process.args : \"ruby\" and process.args : \"-run\" and process.args :\"httpd\")\n    )","filters":[],"actions":[]}
{"id":"6a070718-4d30-443b-abaf-d784f0a9de91","updated_at":"2025-03-26T02:01:43.998Z","updated_by":"purple1","created_at":"2025-03-25T02:36:52.107Z","created_by":"elastic","name":"UC171 : password policy discovery","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may attempt to access detailed information about the password policy used within an enterprise network or cloud environment. Password policies are a way to enforce complex passwords that are difficult to guess or crack through Brute Force. This information may help the adversary to create a list of common passwords and launch dictionary and/or brute force attacks which adheres to the policy (e.g. if the minimum password length should be 8, then not trying passwords such as 'pass123'; not checking for more than 3-4 passwords per account if the lockout is set to 6 as to not lock out accounts).\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"798b3854-2f74-48a7-be31-7429a2dd8394","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1201","name":"Password Policy Discovery","reference":"https://attack.mitre.org/techniques/T1201","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and\n        (\n            (\n                process.executable : \"change\"\n                and \n                (\n                    process.args : \"--list\" \n                    or process.args : \"-l\" \n                )\n            )\n            or\n            (\n                process.executable : \"passwd\"\n                and \n                (\n                    process.args : \"--status\" \n                    or process.args : \"-S\" \n                )\n            )\n        )","filters":[],"actions":[]}
{"id":"64e2a8d8-7fb0-4f1b-b9a6-7182992846ba","updated_at":"2025-03-26T02:23:17.368Z","updated_by":"purple1","created_at":"2025-03-25T02:37:18.243Z","created_by":"elastic","name":"UC203 : Suspicious Defense Evasion by Reversed Obfuscation of Commands (via process_creation)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"This rule identifies terms reversed (e.g tlcmetsys - systemclt) for obfuscation found in offensive linux tools.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"91037a5f-6d77-4551-adff-af7d629117dd","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://askubuntu.com/questions/983480/showing-text-file-content-right-to-left-in-the-terminal"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":" any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and \n        (\n            process.executable : \"sh\"\n            or process.executable : \"crond\"\n        )\n        and\n        (\n            process.args : \"hsab/nib/\" \n            or process.args : \"hs/nib/\" \n            or process.args : \"dwssap/cte/\"\n            or process.args : \"wodahs/cte/\" \n            or process.args : \"pmt/rav\"  \n            or process.args : \"//:ptth\" \n            or process.args : \"//:sptth\" \n            or process.args : \"/efil.\" \n            or process.args : \"/eman.\" \n            or process.args : \"/etis.\" \n            or process.args : \"/moc.\"  \n            or process.args : \"/oc.\"   \n            or process.args : \"/ten.\" \n            or process.args : \"/ue.\" \n            or process.args : \"teg-tpa\" \n            or process.args : \"tpecca\" \n            or process.args : \"edutitpa\" \n            or process.args : \"hsab\" \n            or process.args : \"kaerb\" \n            or process.args : \"prghc\" \n            or process.args : \"domhc\" \n            or process.args : \"dnammoc\" \n            or process.args : \"batnorc\"\n            or process.args : \"lruc\" \n            or process.args : \"eucserdd\" \n            or process.args : \"elbasid\" \n            or process.args : \"pi_tsd\" \n            or process.args : \"trop_tsd\" \n            or process.args : \"elbane\" \n            or process.args : \"llawerif\" \n            or process.args : \"ddapuorg\" \n            or process.args : \"dompuorg\" \n            or process.args : \"emantsoh\" \n            or process.args : \"gifnocfi\" \n            or process.args : \"ridkm\" \n            or process.args : \"tatsten\" \n            or process.args : \"dwssap\" \n            or process.args : \"llikp\" \n            or process.args : \"nohtyp\"\n            or process.args : \"lacol.cr\" \n            or process.args : \"xuniles\" \n            or process.args : \"nwodtuhs\" \n            or process.args : \"ecruos\" \n            or process.args : \"pi_crs\" \n            or process.args : \"tlcmetsys\"\n            or process.args : \"ddaresu\" \n            or process.args : \"ledresu\" \n            or process.args : \"domresu\" \n            or process.args : \"sresu\" \n            or process.args : \"imaohw\"\n            or process.args : \"tegw\"\n            or process.args : \"sgrax\" \n        )\n        and not(\n            process.args : \"activeSandbox\"\n            or process.args : \"InstallerSandboxes\"\n        )","filters":[],"actions":[]}
{"id":"6cdb401b-cc27-4504-afee-dceff35e9a6c","updated_at":"2025-03-26T02:21:36.333Z","updated_by":"purple1","created_at":"2025-03-25T02:37:16.235Z","created_by":"elastic","name":"UC189 : Changed Login Configuration Files (via auditd)","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":" Detects when changes are made to login configuration files are made. The files monitored in this rule are used to configure logging and policies around user logins on linux systems.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"19ff9705-b3cf-485d-bab3-5e38880fe0cf","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[{"id":"T1562.001","name":"Disable or Modify Tools","reference":"https://attack.mitre.org/techniques/T1562/001"},{"id":"T1562.006","name":"Indicator Blocking","reference":"https://attack.mitre.org/techniques/T1562/006"}]}]}],"to":"now","references":["https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/app-audit_reference#sec-Audit_Events_Fields","https://man7.org/linux/man-pages/man5/login.defs.5.html","https://linux.die.net/man/8/pam_securetty"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action : \"cwd\"\n    and process.working_directory in (\"login.defs\", \"securetty\",\"faillog\",\"lastlog\",\"tallylog\")","filters":[],"actions":[]}
{"id":"bebfbb60-b922-49b7-89f4-629fcb6a5499","updated_at":"2025-04-09T09:24:02.855Z","updated_by":"purple1","created_at":"2025-04-09T09:24:02.855Z","created_by":"purple1","name":"UC101 : Windows Auto Atart Execution using Registry Run Keys / Startup Folder","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"The alert detects that an attacker tries to maintain persistence by setting executables to be run when the system is restarted or when the user logs on.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a6ccde60-6d5d-4f9c-99d2-630011098619","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.001/T1547.001.md","https://attack.mitre.org/techniques/T1547/001/","https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.004/T1547.004.md","https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1037.001/T1037.001.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and (\n      winlog.event_data.CommandLine : \"* \\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run *\" \n      or winlog.event_data.CommandLine : \"* \\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\User Shell Folders *\" \n      or winlog.event_data.CommandLine : \"* \\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders *\"\n      or winlog.event_data.CommandLine : \"* \\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run *\"\n      or winlog.event_data.CommandLine : \"* HKCU\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows *\"\n      or winlog.event_data.CommandLine : \"* HKEY_LOCAL_MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager *\"\n      or winlog.event_data.CommandLine : \"* \\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Userinit *\"\n      or winlog.event_data.CommandLine : \"* \\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell *\"\n      or winlog.event_data.CommandLine : \"* \\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify *\"\n      or winlog.event_data.CommandLine : \"* UserInitMprLogonScript *\"\n      )","filters":[],"actions":[]}
{"id":"f8637f81-35bd-4af6-9587-b6191ffb9013","updated_at":"2025-03-27T01:55:02.090Z","updated_by":"purple1","created_at":"2025-02-27T10:31:31.706Z","created_by":"elastic","name":"UC316 : SystemNightmare Exploitation Script Execution","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects the exploitation of PrinterNightmare to get a shell as LOCAL_SYSTEM","risk_score":99,"severity":"critical","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"4bdc29b6-7a39-4b6c-b24b-d6f576f316ae","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068","subtechnique":[]}]}],"to":"now","references":["https://github.com/GossiTheDog/SystemNightmare"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and\n    (\n        winlog.event_data.CommandLine : \"*printnightmare.gentilkiwi.com*\"\n        or winlog.event_data.CommandLine : \"*//user:gentilguest*\"\n        or winlog.event_data.CommandLine : \"*Kiwi Legit Printer*\"\n    )","filters":[],"actions":[]}
{"id":"bf0abe4e-c37e-44e5-8fea-1ba66d1ae1af","updated_at":"2025-03-26T02:32:10.588Z","updated_by":"purple1","created_at":"2025-03-25T02:37:32.300Z","created_by":"elastic","name":"UC269 : BlackCat Ransomware Detect (via cmdline)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"BlackCat (aka AlphaVM, AlphaV) is a newly established RaaS (Ransomware as a Service) with payloads written in Rust. While BlackCat is not the first ransomware written in the Rust language, it joins a small (yet growing) sliver of the malware landscape making use of this popular cross-platform language.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"1adc1078-edd2-41ee-8794-a6e3f9c74229","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]}],"to":"now","references":["https://www.varonis.com/blog/alphv-blackcat-ransomware","https://www.sentinelone.com/labs/blackcat-ransomware-highly-configurable-rust-driven-raas-on-the-prowl-for-victims/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.kind : \"event\"\n    and event.action : \"execve\"\n    and \n    (\n        process.args like \"--access-token\"\n        or process.args like \"--no-prop\"\n        or process.args like \"--no-prop-servers\"\n        or process.args like \"--no-vm-kill\"\n        or process.args like \"--no-vm-snapshot-kill\"\n        or process.args like \"--no-wall\"\n        or process.args like \"--drag-and-drop\"\n        or process.args like \"--drop-drag-and-drop-target\"\n        or process.args like \"--extra-verbose\"\n        or process.args like \"--no-net\"\n        or process.args like \"--propagated\" \n    )","filters":[],"actions":[]}
{"id":"4cb58ff9-7ad2-4757-b45f-4c3766ec7e1e","updated_at":"2025-04-15T09:03:15.773Z","updated_by":"purple1","created_at":"2025-02-27T10:31:55.832Z","created_by":"elastic","name":"UC339 : Possible Gost Tunneling Tool (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"GOST is a golang based tunneling tool for command and control.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"d88b2283-4eef-4969-8688-dbe99647a592","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1573","name":"Encrypted Channel","reference":"https://attack.mitre.org/techniques/T1573","subtechnique":[]},{"id":"T1095","name":"Non-Application Layer Protocol","reference":"https://attack.mitre.org/techniques/T1095","subtechnique":[]},{"id":"T1090","name":"Proxy","reference":"https://attack.mitre.org/techniques/T1090","subtechnique":[]},{"id":"T1071","name":"Application Layer Protocol","reference":"https://attack.mitre.org/techniques/T1071","subtechnique":[]}]}],"to":"now","references":["https://github.com/ginuerzh/gost"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n      winlog.event_data.CommandLine : \"* http2://*\"\n      or winlog.event_data.CommandLine : \"* socks5:// *\"\n      or winlog.event_data.CommandLine : \"* ss:// *\"\n      or winlog.event_data.CommandLine : \"* ssu:// *\"\n      or winlog.event_data.CommandLine : \"* quic:// *\"\n      or winlog.event_data.CommandLine : \"* tcp:// *\"\n      or winlog.event_data.CommandLine : \"* ssh:// *\"\n      or winlog.event_data.CommandLine : \"* rtcp:// *\"\n      or winlog.event_data.CommandLine : \"* rudp:// *\"\n      or winlog.event_data.CommandLine : \"* kcp:// *\"\n      or winlog.event_data.CommandLine : \"* redirect:// *\"\n      or winlog.event_data.CommandLine : \"* obfs4:// *\"\n      or winlog.event_data.CommandLine : \"* https+ *\"\n    )","filters":[],"actions":[]}
{"id":"0a652273-20c0-4caa-a147-49118ae86651","updated_at":"2025-04-14T02:50:39.862Z","updated_by":"purple1","created_at":"2025-04-14T02:50:39.862Z","created_by":"purple1","name":"UC275 : Possible Outdated Golden Ticket Attack Detection (via system)","tags":["product: windows","service: system"],"interval":"5m","enabled":true,"revision":0,"description":"If the domain controller cannot validate the TGT, it revokes it, thus generating an unsuccessful issuance event for TGS (4769), which may indicate an attempt to use a Kerberos golden ticket using outdated methods/tools for its creation (PAC format/fake data issues).","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"26eb7177-11a5-4a09-8fbe-2341a29c8e95","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1558","name":"Steal or Forge Kerberos Tickets","reference":"https://attack.mitre.org/techniques/T1558","subtechnique":[{"id":"T1558.001","name":"Golden Ticket","reference":"https://attack.mitre.org/techniques/T1558/001"}]}]}],"to":"now","references":["https://support.microsoft.com/en-gb/topic/kb5008380-authentication-updates-cve-2021-42287-9dafac11-e0d0-4cb8-959a-143bd0201041"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and (event.code : \"36\" or event.code : \"37\" or event.code : \"38\")  and winlog.event_data.ProviderName : \"Kerberos\"","filters":[],"actions":[]}
{"id":"6996aa06-ffb9-4c5a-b49a-bd9d9c39aaf2","updated_at":"2025-04-16T08:10:20.732Z","updated_by":"purple1","created_at":"2025-04-16T08:10:20.732Z","created_by":"purple1","name":"UC360 : Suspicious Processes with Recycle.Bin Path (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to create malicious process via $Recycle.bin in order to avoid detection","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e7ce6380-40db-497d-9600-8828d23581bc","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]}],"to":"now","references":["https://www.infosecurity-magazine.com/news/signature-techniques-of-asian-apt/","https://www.recordedfuture.com/bluebravo-adapts-to-target-diplomatic-entities-with-graphicalproton-malware","https://go.recordedfuture.com/hubfs/reports/cta-2023-0727-1.pdf"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\Recycle.bin\\\\*\" and winlog.event_data.CommandLine : \"* Recycle.bin *\"","filters":[],"actions":[]}
{"id":"045a4f81-1003-4a1a-99c6-c526267a87a3","updated_at":"2025-04-09T08:32:26.035Z","updated_by":"purple1","created_at":"2025-04-09T08:32:26.035Z","created_by":"purple1","name":"UC086 :  Command Line Utility Detected","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects attacker attemp to use command line utility.","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"300ccbd9-1d1c-4c28-bb3b-e0f6b45811bc","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"},{"id":"T1059.003","name":"Windows Command Shell","reference":"https://attack.mitre.org/techniques/T1059/003"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and (winlog.event_data.NewProcessName : \"*\\\\cmd.exe\" or winlog.event_data.NewProcessName : \"*\\\\powerhshell.exe\" or winlog.event_data.NewProcessName : \"*\\\\pwsh.exe\")","filters":[],"actions":[]}
{"id":"edfa92c9-5f04-47a2-8d5a-bc6d877162ed","updated_at":"2025-04-10T07:20:25.592Z","updated_by":"purple1","created_at":"2025-04-10T07:20:25.592Z","created_by":"purple1","name":"UC231 : Possible Tampering Windows Prefetch to Evade Forensic Analysis on Windows 10 by Modifying Associated Registry Key (via  registry_event )","tags":["product: windows","category: registry_set"],"interval":"5m","enabled":true,"revision":0,"description":"This rule detects the attempt to disable windows prefetch to evade forensic analysis. This technique is widely used as an anti-forensics technique.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"d4d793e4-764d-4679-b1ae-3ea034fc41a5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://archerhall.com/knowledge-base/windows-prefetch/","https://winbuzzer.com/2020/03/14/windows-10-how-to-disable-enable-prefetch-and-superfetch-xcxwbt/ date: 2023/09/26"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and winlog.event_data.TargetObject : \"*\\\\Session Manager\\\\Memory Management\\\\PrefetchParameters\\\\EnablePrefetcher\" and winlog.event_data.Details: \"DWORD (0x00000000)\" ","filters":[],"actions":[]}
{"id":"32189df5-7184-4025-b166-30823ac19d98","updated_at":"2025-04-09T07:29:13.985Z","updated_by":"purple1","created_at":"2025-04-09T07:29:13.985Z","created_by":"purple1","name":"UC080 : Create A New AD Security-Enabled Universal Group","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Create a new AD security-enabled universal group","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"59166bb3-f493-4af3-a4fe-a83bc4f9d849","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1098","name":"Account Manipulation","reference":"https://attack.mitre.org/techniques/T1098","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and event.code : \"4754\"","filters":[],"actions":[]}
{"id":"72a0116f-6f7d-409e-adb8-24519cf84b45","updated_at":"2025-04-09T09:04:26.519Z","updated_by":"purple1","created_at":"2025-04-09T09:04:26.519Z","created_by":"purple1","name":"UC088 : Change Default #[Windows File Association] Change default","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Attacker tries to execute malicious code by changing the default programs that are run when a file type is opened.","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"83074174-8922-4d73-a2a8-0bc4dcfc9b62","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1546","name":"Event Triggered Execution","reference":"https://attack.mitre.org/techniques/T1546","subtechnique":[{"id":"T1546.001","name":"Change Default File Association","reference":"https://attack.mitre.org/techniques/T1546/001"}]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.001/T1546.001.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and (winlog.event_data.CommandLine : \"* cmd *\" and winlog.event_data.CommandLine : \"* /c *\" and winlog.event_data.CommandLine : \"* assoc *\")","filters":[],"actions":[]}
{"id":"4b1174b4-383c-4d9c-9422-8f45289191ae","updated_at":"2025-03-25T02:37:04.163Z","updated_by":"elastic","created_at":"2025-03-25T02:37:04.163Z","created_by":"elastic","name":"UC178 : Data destruction","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"7286204b-0688-4a46-95da-245288d22387","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"linux\" and event.action : \"execve\" and process.executable : \"* dd if=%count=%*\"","filters":[],"actions":[]}
{"id":"0a49e6fa-8424-4d91-9b0e-cfa35caff693","updated_at":"2025-03-25T04:19:05.747Z","updated_by":"purple1","created_at":"2025-03-25T02:36:39.055Z","created_by":"elastic","name":"UC162 : Disable or modify system firewall","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"411175b1-d315-460f-aa06-a1544de02b64","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[{"id":"T1562.004","name":"Disable or Modify System Firewall","reference":"https://attack.mitre.org/techniques/T1562/004"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"linux\"\n    and \n    (\n      (\n        event.action : \"service_stop\" and \n        (\n          process.args : \"firewall\"\n          or process.args : \"ufw\"\n          or process.args : \"iptables\"\n        )\n      )\n    )","filters":[],"actions":[]}
{"id":"83510a07-57a8-4ae6-ac50-1533e734b822","updated_at":"2025-04-14T02:41:32.717Z","updated_by":"purple1","created_at":"2025-04-14T02:41:32.717Z","created_by":"purple1","name":"UC264 : Potential Access Token Abuse","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detects potential token impersonation and theft. Example, when using  \"DuplicateToken(Ex)\" and \"ImpersonateLoggedOnUser\" with the \"LOGON32_LOGON_NEW_CREDENTIALS  flag\".","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"ff4c52fa-c3e1-4aad-bd36-e75e628f2ba4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1134","name":"Access Token Manipulation","reference":"https://attack.mitre.org/techniques/T1134","subtechnique":[]}]}],"to":"now","references":["https://www.elastic.co/fr/blog/how-attackers-abuse-access-token-manipulation","https://www.manageengine.com/log-management/cyber-security/access-token-manipulation.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and event.code : \"4624\" and winlog.event_data.LogonType : \"9\" and winlog.event_data.LogonProcessName : \"Advapi\" and winlog.event_data.AuthenticationPackageName : \"Negotiate\" and winlog.event_data.ImpersonationLevel : \"'%%1833\"","filters":[],"actions":[]}
{"id":"5ad683e4-9a95-49e6-9c55-f0a1f428ed5d","updated_at":"2025-03-26T02:15:36.235Z","updated_by":"purple1","created_at":"2025-03-25T02:37:10.212Z","created_by":"elastic","name":"UC181 : Mirai Botnet using Log4j with New ELF Binary (via process_creation)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Mirai botnet exploits log4j  to spread. It does this with the new elf binary. With this rule, you can detect the process of new elf binary file.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"d9c23467-b37b-4ad4-b5fb-9066b4b82f23","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://twitter.com/SI_FalconTeam/status/1489530113293266945?s=20&t=Af3NoGZhbFn7pkA6WSiKow","https://www.virustotal.com/gui/file/5ff22b524db21ebfa3c80a5a35db76bf36b6a25c2cb8cad01e039b7afaf91cf8/detection"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : linux and process.args : \"curl\" and process.args : \"spoofhosting\" and process.args : \"chmod 777\" and process.args :\"npms\"","filters":[],"actions":[]}
{"id":"6c023faa-416a-40cb-850d-4336f2ca7e8e","updated_at":"2025-04-10T02:20:24.645Z","updated_by":"purple1","created_at":"2025-04-10T02:20:24.645Z","created_by":"purple1","name":"UC196 : Process Injection (via sysmon log)","tags":["product: windows","service: sysmon"],"interval":"5m","enabled":true,"revision":0,"description":"Detects process injection via sysmon","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"02e139d4-60d7-442c-9914-0a23bdaa1bf7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1055","name":"Process Injection","reference":"https://attack.mitre.org/techniques/T1055","subtechnique":[]}]}],"to":"now","references":["https://letsdefend.io/blog/process-injection-detection-with-sysmon/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and event.code : \"8\"","filters":[],"actions":[]}
{"id":"800ad0f2-4ed1-430e-b56e-ee70cb5aaa04","updated_at":"2025-03-25T04:16:50.705Z","updated_by":"purple1","created_at":"2025-03-25T02:36:36.044Z","created_by":"elastic","name":"UC161 : Disable or modify security tool","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"04ee4ecb-af27-451b-b545-20f96520cb9f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[{"id":"T1562.004","name":"Disable or Modify System Firewall","reference":"https://attack.mitre.org/techniques/T1562/004"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"linux\"\n    and \n    (\n      (\n        event.action : \"service_stop\" and \n        (\n          process.args : \"cbdaemon\"\n          or process.args : \"falcon-sensor\"\n        )\n      )\n      or\n      (\n        event.action : \"execve\" and process.args : \"setenforce\" and process.args : \"0\"\n      )\n    )","filters":[],"actions":[]}
{"id":"455e0141-713e-4bf3-b95e-806963dee5ea","updated_at":"2025-04-09T08:47:34.255Z","updated_by":"purple1","created_at":"2025-04-09T08:47:34.255Z","created_by":"purple1","name":"UC087 : COR_PROFILER Modification","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"An attacker tries to change the COR_PROFILER environment variable to hijack the execution flow of programs that load the .NET CLR.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"111debe1-a643-4cc9-bc02-cd4a69046c90","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1574.012/T1574.012.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and (winlog.event_data.CommandLine : \"* cor_enable_profiling *\" or winlog.event_data.CommandLine : \"* cor_profiler *\" or winlog.event_data.CommandLine : \"* cor_profiler_path *\")","filters":[],"actions":[]}
{"id":"4c958670-8735-4a6e-b78a-380f456dc25e","updated_at":"2025-04-09T02:57:32.425Z","updated_by":"purple1","created_at":"2025-04-09T02:57:32.425Z","created_by":"purple1","name":"UC055 : DLL Side Loading","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attacker trying to execute DLL files","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"c5066b56-580d-4320-9caa-046970b28293","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.007/T1546.007.md#atomic-test-1---netsh-helper-dll-registration"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\netsh.exe\" and winlog.event_data.CommandLine : \"* add helper *\"","filters":[],"actions":[]}
{"id":"e88895cd-8ef4-4851-813e-2257073b85b7","updated_at":"2025-04-17T02:51:56.651Z","updated_by":"purple1","created_at":"2025-04-17T02:51:56.651Z","created_by":"purple1","name":"UC025 : Silver Ticket Impersonate Attack","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Attack technique in AD, the attacker tries to obtain a silver ticket (service ticket) to bypass the login and authentication process on the system without the need for an account password.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"6076fd97-d4aa-4a2b-a22a-fd9af5951c92","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1550","name":"Use Alternate Authentication Material","reference":"https://attack.mitre.org/techniques/T1550","subtechnique":[{"id":"T1550.003","name":"Pass the Ticket","reference":"https://attack.mitre.org/techniques/T1550/003"}]}]}],"to":"now","references":["https://book.hacktricks.xyz/windows/active-directory-methodology/silver-ticket#silver-ticket"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\mimikatz.exe\" and winlog.event_data.CommandLine : \"* kerberos::golden *\"","filters":[],"actions":[]}
{"id":"2b5e037d-98e3-4048-9f7d-8ff688b457f2","updated_at":"2025-04-15T07:57:18.695Z","updated_by":"purple1","created_at":"2025-04-15T07:57:18.695Z","created_by":"purple1","name":"UC328 : LOLBAS HH - HTML Help Executable Program (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects use of hh.exe as a living off the land technique.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"94e41537-ec19-4679-b0f4-385162d0fd00","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1218","name":"System Binary Proxy Execution","reference":"https://attack.mitre.org/techniques/T1218","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":["https://www.rapid7.com/blog/post/2024/03/20/the-updated-apt-playbook-tales-from-the-kimsuky-threat-actor-group/","https://go.recordedfuture.com/hubfs/reports/cta-2023-0919.pdf","https://lolbas-project.github.io/lolbas/Binaries/Hh/","https://cert.gov.ua/article/1563322"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and winlog.event_data.ParentProcessName : \"*\\\\hh.exe\" and winlog.event_data.NewProcessName : \"*\\\\hh.exe\"","filters":[],"actions":[]}
{"id":"37045269-fd5e-445d-b758-2386fbd7a559","updated_at":"2025-03-25T02:37:38.322Z","updated_by":"elastic","created_at":"2025-03-25T02:37:38.322Z","created_by":"elastic","name":"UC273 : Possible Internal Lateral Movement by Spring4Shell Exploitation Attempt (Linux) (via process_creation)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may use Spring4Shell exploit to gain unauthorized access to internal systems once inside of a network. Spring4Shell unconfirmed, but possible, remote code execution (RCE) vulnerability is believed to exist in Spring, an popular Java framework. This issue is likely easily exploited in common configurations.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"df78e1b4-5c3c-44b1-bf30-f7259edaab00","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1210","name":"Exploitation of Remote Services","reference":"https://attack.mitre.org/techniques/T1210","subtechnique":[]}]}],"to":"now","references":["https://www.cyberkendra.com/2022/03/springshell-rce-0-day-vulnerability.html","https://www.cyberkendra.com/2022/03/spring4shell-details-and-exploit-code.html","https://twitter.com/vxunderground/status/1509170582469943303","https://www.dshield.org/forums/diary/Possible+new+Java+Spring+Framework+Vulnerability+Updated+not+a+Spring+problem/28498/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and\n        (\n            process.args : \"parent.pipeline.first\" \n            or process.args : \"class.module.classLoader.resources.context\"\n            or process.args : \"suffix\" \n            or process.args : \"prefix\"\n            or process.args : \"fileDateFormat\"\n            or process.args : \"directory\"\n        )","filters":[],"actions":[]}
{"id":"60e5d395-c66f-4e8f-a23c-6982c7183882","updated_at":"2025-04-09T04:44:14.166Z","updated_by":"purple1","created_at":"2025-04-09T04:44:14.166Z","created_by":"purple1","name":"UC070 : Suspicious Code Execution","tags":["product: windows","service: security","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Suspicious malicious code execution (python, ruby, java,...).","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"395e199f-3e79-4afc-a4a0-62686f8219d6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and (winlog.event_data.NewProcessName : \"*\\\\python.exe\" or winlog.event_data.NewProcessName : \"*\\\\perl.exe\" or winlog.event_data.NewProcessName : \"*\\\\ruby.exe\" or winlog.event_data.NewProcessName : \"*\\\\java.exe\" or winlog.event_data.NewProcessName : \"*\\\\php.exe\")","filters":[],"actions":[]}
{"id":"44d4b77f-baae-4dba-af7c-b9c9c76ea08f","updated_at":"2025-04-15T03:38:59.486Z","updated_by":"purple1","created_at":"2025-04-15T03:38:59.486Z","created_by":"purple1","name":"UC311 : Possible Impact by Disabling of Computer Restore (via powershell)","tags":["product: windows","service: powershell"],"interval":"5m","enabled":true,"revision":0,"description":"Disable-computerrestore passed to powershell is used by attackers to remove backup copies from files.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"04c3a2c1-a273-4a6d-84cd-c53f57d13945","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0040","name":"Impact","reference":"https://attack.mitre.org/tactics/TA0040"},"technique":[{"id":"T1490","name":"Inhibit System Recovery","reference":"https://attack.mitre.org/techniques/T1490","subtechnique":[]}]}],"to":"now","references":["https://docs.rapid7.com/insightidr/windows-suspicious-process/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and winlog.event_data.ScriptBlockText : \"* disable-computerrestore *\" and winlog.event_data.ScriptBlockText : \"* disable-computerrestore *\"","filters":[],"actions":[]}
{"id":"f31e7153-9d54-4292-94e5-6d7b70ba9a1a","updated_at":"2025-03-25T04:15:09.671Z","updated_by":"purple1","created_at":"2025-03-25T02:36:32.029Z","created_by":"elastic","name":"UC159 : Creation Of Privileged Containers Using LXC","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Detects when the root user creates containers with lxc. Privileged containers in lxc are created by whenever the root user creates the container.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"0dfb58cc-0dab-4013-8e4e-35659bbbdda6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1610","name":"Deploy Container","reference":"https://attack.mitre.org/techniques/T1610","subtechnique":[]}]}],"to":"now","references":["https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/app-audit_reference#sec-Audit_Events_Fields","https://linuxcontainers.org/lxc/getting-started/#creating-privileged-containers","https://man7.org/linux/man-pages/man1/lxc-create.1.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"linux\" and event.action : \"syscall\"  and (process.executable : \"*lxc-create\" or process.executable : \"*/lxc-create\") and user.id : \"0\" and user.group.id : \"0\" and auditd.log.EUID : \"root\" and auditd.log.EGID : \"root\"","filters":[],"actions":[]}
{"id":"a624091f-343b-4f7f-8732-959a286b68e7","updated_at":"2025-03-25T02:36:22.993Z","updated_by":"elastic","created_at":"2025-03-25T02:36:22.993Z","created_by":"elastic","name":"UC144 : File And Directory Permission Modification","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may modify file or directory permissions/attributes to evade access control lists (ACLs) and access protected files.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"b8fbf018-72f9-40fd-aa27-7bcbec574709","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1222","name":"File and Directory Permissions Modification","reference":"https://attack.mitre.org/techniques/T1222","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"linux\" and event.action : \"execve\" and (process.executable : \"chmod\" and process.executable : \"chown\")","filters":[],"actions":[]}
{"id":"83ca825f-ed2b-4ea2-a3e9-90c3d9485bc3","updated_at":"2025-04-10T07:12:19.426Z","updated_by":"purple1","created_at":"2025-04-10T07:12:19.426Z","created_by":"purple1","name":"UC229 : Possible MOVEit Transfer Exploitation Attempt [MOVEit Transfer 0Day] (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects a potential compromise indicator through suspicious process chains.","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"348fd8f3-f673-4580-ae7d-4cbb5540c8da","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1190","name":"Exploit Public-Facing Application","reference":"https://attack.mitre.org/techniques/T1190","subtechnique":[]}]}],"to":"now","references":["https://nvd.nist.gov/vuln/detail/CVE-2023-34362","https://www.cisa.gov/news-events/alerts/2023/06/01/progress-software-releases-security-advisory-moveit-transfer","https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and winlog.event_data.ParentProcessName : \"*\\\\w3wp.exe\" and winlog.event_data.ParentCommandLine : \"* moveitdmz *\" and winlog.event_data.ParentCommandLine : \"* pool *\"","filters":[],"actions":[]}
{"id":"dcaf4d8e-f6ab-4d71-aab2-e3f6a1267d72","updated_at":"2025-04-10T09:43:46.571Z","updated_by":"purple1","created_at":"2025-04-10T09:43:46.571Z","created_by":"purple1","name":"UC251 : Add SID History (via audit)","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"SID History was originally designed to facilitate migration scenarios, allowing users to be transferred from one domain to another while maintaining access to resources in the \"old\" domain. To achieve this, the user's previous Security Identifier (SID) would be appended to the SID History of their new account. Consequently, when generating a ticket, it becomes possible to add the SID of a privileged group (such as EAs or DAs) from the parent domain, thereby granting access to all resources within that domain.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"fe100331-27b5-448d-a420-3c31fe98490b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1134","name":"Access Token Manipulation","reference":"https://attack.mitre.org/techniques/T1134","subtechnique":[{"id":"T1134.005","name":"SID-History Injection","reference":"https://attack.mitre.org/techniques/T1134/005"}]}]}],"to":"now","references":["https://www.thehacker.recipes/ad/persistence/sid-history","https://improsec.com/tech-blog/o83i79jgzk65bbwn1fwib1ela0rl2d","https://www.sentinelone.com/blog/windows-sid-history-injection-exposure-blog/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and (event.code : \"4765\" or event.code : \"4766\") ","filters":[],"actions":[]}
{"id":"d9e28516-35cd-43ed-a840-44adbe4acc51","updated_at":"2025-03-25T02:37:30.287Z","updated_by":"elastic","created_at":"2025-03-25T02:37:30.287Z","created_by":"elastic","name":"UC268 : Possible SimpleHTTPServer Usage Attempt (via cmdline)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaties may try run SimpleHTTPServer in order to perfom their malicious activity.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2897dd64-d2ab-4532-9996-ab76b31ad057","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0042","name":"Resource Development","reference":"https://attack.mitre.org/tactics/TA0042"},"technique":[{"id":"T1588","name":"Obtain Capabilities","reference":"https://attack.mitre.org/techniques/T1588","subtechnique":[{"id":"T1588.002","name":"Tool","reference":"https://attack.mitre.org/techniques/T1588/002"}]}]}],"to":"now","references":["https://www.tecmint.com/python-simplehttpserver-to-create-webserver-or-serve-files-instantly/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.args: \"python\"\n        and process.executable : \"SimpleHTTPServer\"","filters":[],"actions":[]}
{"id":"e9f4bec2-9de3-473e-97f1-d93c5d7c1514","updated_at":"2025-04-02T02:53:07.377Z","updated_by":"purple1","created_at":"2025-03-25T02:36:34.036Z","created_by":"elastic","name":"UC160 : Deobfuscate Decode Files or Information","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":2,"description":"Adversaries may use Obfuscated Files or Information to hide artifacts of an intrusion from analysis. They may require separate mechanisms to decode or deobfuscate that information depending on how they intend to use it. \n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"1ada6b37-9804-46ea-b3a5-a44afeebb5a2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1140","name":"Deobfuscate/Decode Files or Information","reference":"https://attack.mitre.org/techniques/T1140","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.kind : \"event\"\n    and event.action : \"execve\"\n    and \n    (\n      process.executable : \"decode\"\n      or \n      (\n        process.executable : \"base64\" and process.args : \"-d\"\n      )\n    )\nand not (host.name : \"app-17\" and host.ip == \"10.79.31.40\")","filters":[],"actions":[]}
{"id":"ceffd92b-6e88-4913-ae50-daff7846e226","updated_at":"2025-02-27T10:30:30.270Z","updated_by":"elastic","created_at":"2025-02-27T10:30:30.270Z","created_by":"elastic","name":"UC238 : Malicious PowerShell Commandlets - ScriptBlock","tags":["product: windows","    category: ps_script"],"interval":"5m","enabled":true,"revision":0,"description":"Detects Commandlet names from well-known PowerShell exploitation frameworks","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"15244451-9777-4356-9faa-c5279292fbd6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1482","name":"Domain Trust Discovery","reference":"https://attack.mitre.org/techniques/T1482","subtechnique":[]},{"id":"T1087","name":"Account Discovery","reference":"https://attack.mitre.org/techniques/T1087","subtechnique":[{"id":"T1087.001","name":"Local Account","reference":"https://attack.mitre.org/techniques/T1087/001"},{"id":"T1087.002","name":"Domain Account","reference":"https://attack.mitre.org/techniques/T1087/002"}]},{"id":"T1069","name":"Permission Groups Discovery","reference":"https://attack.mitre.org/techniques/T1069","subtechnique":[{"id":"T1069.001","name":"Local Groups","reference":"https://attack.mitre.org/techniques/T1069/001"},{"id":"T1069.002","name":"Domain Groups","reference":"https://attack.mitre.org/techniques/T1069/002"}]}]}],"to":"now","references":["https://adsecurity.org/?p=2921","https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries","https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1","https://github.com/HarmJ0y/DAMP","https://github.com/Kevin-Robertson/Powermad","https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"    any where host.os.type : \"windows\"\n    and\n    (\n        winlog.event_data.ScriptBlockText : \"*Add-Exfiltration*\"\n        or winlog.event_data.ScriptBlockText : \"*Add-Persistence*\"\n        or winlog.event_data.ScriptBlockText : \"*Add-RegBackdoor*\"\n        or winlog.event_data.ScriptBlockText : \"*Add-RemoteRegBackdoor*\"\n        or winlog.event_data.ScriptBlockText : \"*Add-ScrnSaveBackdoor*\"\n        or winlog.event_data.ScriptBlockText : \"*Check-VM*\"\n        or winlog.event_data.ScriptBlockText : \"*ConvertTo-Rc4ByteStream*\"\n        or winlog.event_data.ScriptBlockText : \"*Decrypt-Hash*\"\n        or winlog.event_data.ScriptBlockText : \"*Disable-ADIDNSNode*\"\n        or winlog.event_data.ScriptBlockText : \"*Disable-MachineAccount*\"\n        or winlog.event_data.ScriptBlockText : \"*Do-Exfiltration*\"\n        or winlog.event_data.ScriptBlockText : \"*Enable-ADIDNSNode*\"\n        or winlog.event_data.ScriptBlockText : \"*Enable-MachineAccount*\"\n        or winlog.event_data.ScriptBlockText : \"*Enabled-DuplicateToken*\"\n        or winlog.event_data.ScriptBlockText : \"*Exploit-Jboss*\"\n        or winlog.event_data.ScriptBlockText : \"*Export-ADR*\"\n        or winlog.event_data.ScriptBlockText : \"*Export-ADRCSV*\"\n        or winlog.event_data.ScriptBlockText : \"*Export-ADRExcel*\"\n        or winlog.event_data.ScriptBlockText : \"*Export-ADRHTML*\"\n        or winlog.event_data.ScriptBlockText : \"*Export-ADRJSON*\"\n        or winlog.event_data.ScriptBlockText : \"*Export-ADRXML*\"\n        or winlog.event_data.ScriptBlockText : \"*Find-Fruit*\"\n        or winlog.event_data.ScriptBlockText : \"*Find-GPOLocation*\"\n        or winlog.event_data.ScriptBlockText : \"*Find-TrustedDocuments*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-ADIDNS*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-ApplicationHost*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-ChromeDump*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-ClipboardContents*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-FoxDump*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-GPPPassword*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-IndexedItem*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-KerberosAESKey*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-Keystrokes*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-LSASecret*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-MachineAccountAttribute*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-MachineAccountCreator*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-PassHashes*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-RegAlwaysInstallElevated*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-RegAutoLogon*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-RemoteBootKey*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-RemoteCachedCredential*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-RemoteLocalAccountHash*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-RemoteLSAKey*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-RemoteMachineAccountHash*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-RemoteNLKMKey*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-RickAstley*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-Screenshot*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-SecurityPackages*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-ServiceFilePermission*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-ServicePermission*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-ServiceUnquoted*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-SiteListPassword*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-System*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-TimedScreenshot*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-UnattendedInstallFile*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-Unconstrained*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-USBKeystrokes*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-VaultCredential*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-VulnAutoRun*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-VulnSchTask*\"\n        or winlog.event_data.ScriptBlockText : \"*Grant-ADIDNSPermission*\"\n        or winlog.event_data.ScriptBlockText : \"*Gupt-Backdoor*\"\n        or winlog.event_data.ScriptBlockText : \"*HTTP-Login*\"\n        or winlog.event_data.ScriptBlockText : \"*Install-ServiceBinary*\"\n        or winlog.event_data.ScriptBlockText : \"*Install-SSP*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ACLScanner*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ADRecon*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ADSBackdoor*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-AgentSmith*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-AllChecks*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ARPScan*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-AzureHound*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-BackdoorLNK*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-BadPotato*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-BetterSafetyKatz*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-BypassUAC*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Carbuncle*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Certify*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ConPtyShell*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-CredentialInjection*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-DAFT*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-DCSync*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-DinvokeKatz*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-DllInjection*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-DNSUpdate*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-DomainPasswordSpray*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-DowngradeAccount*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-EgressCheck*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Eyewitness*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-FakeLogonScreen*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Farmer*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Get-RBCD-Threaded*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Gopher*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Grouper*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-HandleKatz*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ImpersonatedProcess*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ImpersonateSystem*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-InteractiveSystemPowerShell*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Internalmonologue*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Inveigh*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-InveighRelay*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-KrbRelay*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-LdapSignCheck*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Lockless*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-MalSCCM*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Mimikatz*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Mimikittenz*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-MITM6*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-NanoDump*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-NetRipper*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Nightmare*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-NinjaCopy*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-OfficeScrape*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-OxidResolver*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-P0wnedshell*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Paranoia*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-PortScan*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-PoshRatHttp*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-PostExfil*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-PowerDump*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-PowerShellTCP*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-PowerShellWMI*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-PPLDump*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-PsExec*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-PSInject*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-PsUaCme*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ReflectivePEInjection*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ReverseDNSLookup*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Rubeus*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-RunAs*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-SafetyKatz*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-SauronEye*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-SCShell*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Seatbelt*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ServiceAbuse*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ShadowSpray*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Sharp*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Shellcode*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-SMBScanner*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Snaffler*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Spoolsample*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-SpraySinglePassword*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-SSHCommand*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-StandIn*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-StickyNotesExtract*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-SystemCommand*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Tasksbackdoor*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Tater*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Thunderfox*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-ThunderStruck*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-TokenManipulation*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Tokenvator*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-TotalExec*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-UrbanBishop*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-UserHunter*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-VoiceTroll*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Whisker*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-WinEnum*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-winPEAS*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-WireTap*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-WmiCommand*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-WMIExec*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-WScriptBypassUAC*\"\n        or winlog.event_data.ScriptBlockText : \"*Invoke-Zerologon*\"\n        or winlog.event_data.ScriptBlockText : \"*MailRaider*\"\n        or winlog.event_data.ScriptBlockText : \"*New-ADIDNSNode*\"\n        or winlog.event_data.ScriptBlockText : \"*New-DNSRecordArray*\"\n        or winlog.event_data.ScriptBlockText : \"*New-HoneyHash*\"\n        or winlog.event_data.ScriptBlockText : \"*New-InMemoryModule*\"\n        or winlog.event_data.ScriptBlockText : \"*New-MachineAccount*\"\n        or winlog.event_data.ScriptBlockText : \"*New-SOASerialNumberArray*\"\n        or winlog.event_data.ScriptBlockText : \"*Out-Minidump*\"\n        or winlog.event_data.ScriptBlockText : \"*Port-Scan*\"\n        or winlog.event_data.ScriptBlockText : \"*PowerBreach*\"\n        or winlog.event_data.ScriptBlockText : \"*powercat *\"\n        or winlog.event_data.ScriptBlockText : \"*PowerUp*\"\n        or winlog.event_data.ScriptBlockText : \"*PowerView*\"\n        or winlog.event_data.ScriptBlockText : \"*Remove-ADIDNSNode*\"\n        or winlog.event_data.ScriptBlockText : \"*Remove-MachineAccount*\"\n        or winlog.event_data.ScriptBlockText : \"*Remove-Update*\"\n        or winlog.event_data.ScriptBlockText : \"*Rename-ADIDNSNode*\"\n        or winlog.event_data.ScriptBlockText : \"*Revoke-ADIDNSPermission*\"\n        or winlog.event_data.ScriptBlockText : \"*Set-ADIDNSNode*\"\n        or winlog.event_data.ScriptBlockText : \"*Set-MacAttribute*\"\n        or winlog.event_data.ScriptBlockText : \"*Set-MachineAccountAttribute*\"\n        or winlog.event_data.ScriptBlockText : \"*Set-Wallpaper*\"\n        or winlog.event_data.ScriptBlockText : \"*Show-TargetScreen*\"\n        or winlog.event_data.ScriptBlockText : \"*Start-CaptureServer*\"\n        or winlog.event_data.ScriptBlockText : \"*Start-WebcamRecorder*\"\n        or winlog.event_data.ScriptBlockText : \"*VolumeShadowCopyTools*\"\n    )\n    and not\n    (\n        winlog.event_data.ScriptBlockText : \"*Get-SystemDriveInfo*\"\n        or winlog.event_data.ScriptBlockText : \"*C:\\\\ProgramData\\\\Amazon\\\\EC2-Windows\\\\Launch\\\\Module\\\\*\"\n    )","filters":[],"actions":[]}
{"id":"043098c6-39d1-4d57-94c1-ef32de9f7c8d","updated_at":"2025-04-14T02:29:47.458Z","updated_by":"purple1","created_at":"2025-04-14T02:29:47.458Z","created_by":"purple1","name":"UC262 : Possible Stealing Access Token From Office Memory Dump (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to steal microsoft office access tokens from relevant memory dump.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e22415a6-2d1b-4125-b237-d6a1a54e559a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1528","name":"Steal Application Access Token","reference":"https://attack.mitre.org/techniques/T1528","subtechnique":[]}]}],"to":"now","references":["https://mrd0x.com/stealing-tokens-from-office-applications"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and winlog.event_data.CommandLine : \"* strings *\" and winlog.event_data.CommandLine : \"* .dmp *\"\n    and winlog.event_data.CommandLine in (\"* WINWORD *\", \"* EXCEL *\", \"* POWERPNT *\", \"* MSPUB *\", \"* VISIO *\", \"* OUTLOOK *\")","filters":[],"actions":[]}
{"id":"5928cf62-2213-4aa1-b1ae-33c88e8de55c","updated_at":"2025-03-25T02:37:02.156Z","updated_by":"elastic","created_at":"2025-03-25T02:37:02.156Z","created_by":"elastic","name":"UC177 : Adversary-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"By responding to LLMNR/NBT-NS network traffic, adversaries may spoof an authoritative source for name resolution to force communication with an adversary controlled system. This activity may be used to collect or relay authentication materials.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"9d61a62e-0bc5-4235-b0d5-48b0ef587241","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"linux\" and event.action : \"execve\" and process.executable : \"responder\"","filters":[],"actions":[]}
{"id":"ee21fc41-502b-4477-b07f-8cd3253a84c7","updated_at":"2025-04-16T09:37:13.193Z","updated_by":"purple1","created_at":"2025-04-16T09:37:13.193Z","created_by":"purple1","name":"UC378 : Powershell Exchange Snapin (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":" The powershell exhange snapin can be used to collect exchange mailbox data for users.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"5cceb174-ac3c-4ebd-8872-75445734a2d7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0009","name":"Collection","reference":"https://attack.mitre.org/tactics/TA0009"},"technique":[{"id":"T1114","name":"Email Collection","reference":"https://attack.mitre.org/techniques/T1114","subtechnique":[]}]}],"to":"now","references":["https://blog.sekoia.io/lucky-mouse-incident-response-to-detection-engineering/","https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and winlog.event_data.CommandLine : \"* Microsoft.Exchange.Powershell.Snapin *\"","filters":[],"actions":[]}
{"id":"f46ec76d-9fe3-4053-acf6-b2627d78f9f9","updated_at":"2025-04-10T03:13:08.527Z","updated_by":"purple1","created_at":"2025-04-10T03:13:08.527Z","created_by":"purple1","name":"UC215 : CVE-2023-26077, CVE-2023-26078 in Atera Windows Installers","tags":["product: windows"],"interval":"5m","enabled":true,"revision":0,"description":"Detects CVE-2023-26077, CVE-2023-26078 in Atera Windows Installers","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"5a550d47-f3b3-4f73-978a-1fd8795579d0","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://thesecmaster.com/how-to-fix-cve-2023-260778-two-critical-0-day-vulnerabilities-in-atera-windows-installers/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and event.code : \"11707\" and not winlog.user.name : \"Administrator\"","filters":[],"actions":[]}
{"id":"7b24d134-5878-42ba-9de6-8d1854c804e9","updated_at":"2025-03-25T03:44:15.422Z","updated_by":"purple1","created_at":"2025-03-25T02:36:58.138Z","created_by":"elastic","name":"UC175 : Privileged User Has Been Created","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Detects the addition of a new user to a privileged group such as \"root\" or \"sudo\"","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"86b9291a-ef80-47bb-9ed4-b10cc8c1f137","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1136","name":"Create Account","reference":"https://attack.mitre.org/techniques/T1136","subtechnique":[]},{"id":"T1098","name":"Account Manipulation","reference":"https://attack.mitre.org/techniques/T1098","subtechnique":[]}]}],"to":"now","references":["https://digital.nhs.uk/cyber-alerts/2018/cc-2825","https://linux.die.net/man/8/useradd","https://github.com/redcanaryco/atomic-red-team/blob/25acadc0b43a07125a8a5b599b28bbc1a91ffb06/atomics/T1136.001/T1136.001.md#atomic-test-5---create-a-new-user-in-linux-with-root-uid-and-gid"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"linux\" and event.action: \"syscall\" and process.name : \"useradd\" and (user.group.id : \"0\" or user.group.id : \"10\" or user.group.id : \"27\" or user.id : \"0\")","filters":[],"actions":[]}
{"id":"243964b3-32ac-4782-8a15-9289fe90ca5a","updated_at":"2025-04-09T07:24:52.894Z","updated_by":"purple1","created_at":"2025-04-09T07:24:52.894Z","created_by":"purple1","name":"UC078 : Create A New AD Security-Enabled Global Group","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detect create a new AD security-enabled global group.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"158e5bb5-27c4-4849-bf1e-da65bd0df19c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and event.code : \"4727\"","filters":[],"actions":[]}
{"id":"5083e4a0-3882-4079-872a-a51af8d46ce3","updated_at":"2025-04-10T08:25:43.591Z","updated_by":"purple1","created_at":"2025-02-27T10:30:32.313Z","created_by":"elastic","name":"UC243 : Suspicious SharpWeb Credential Access by Detection of Associated Commands (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"SharpWeb is a .NET 2.0 CLR compliant project that can retrieve saved logins from Google Chrome, Firefox, Internet Explorer and Microsoft Edge. In the future, this project will be expanded upon to retrieve Cookies and History items from these browsers. it has been seen that this tool is used by conti to widen the attack surface.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a124c3dd-67d1-42d2-b557-89e8abebbf48","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1555","name":"Credentials from Password Stores","reference":"https://attack.mitre.org/techniques/T1555","subtechnique":[{"id":"T1555.003","name":"Credentials from Web Browsers","reference":"https://attack.mitre.org/techniques/T1555/003"}]}]}],"to":"now","references":["https://github.com/TheParmak/conti-leaks-englished/blob/b32785c1bde2a285058883346604a1497e926909/rocket-chat/beautified/Mediaeveryone.com-tl2/2020-10-04-0-dead-northerntrust-local.json#L414","https://github.com/djhohnstein/SharpWeb"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.Image : \"*SharpWeb.exe\" and winlog.event_data.CommandLine in (\"*all*\", \"*full*\",\"*chrome*\",\"*firefox*\",\"*edge*\")","filters":[],"actions":[]}
{"id":"8705449b-31cf-42a9-88bd-cc8910a61dfe","updated_at":"2025-04-15T02:07:38.883Z","updated_by":"purple1","created_at":"2025-04-15T02:07:38.883Z","created_by":"purple1","name":"UC301 : Possible CVE-2024-20656 (Local Privilege Escalation in VSStandardCollectorService150 Service) Exploitation Attempt (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to exploit CVE-2024-20656 (LPE in VSStandardCollectorService150 Service) in order to escalate privileges on the compromised system and further perform malicious activity. Based on publicly available POC. ","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"4dfc6525-a385-4f9f-b31c-aad781c221f7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.mdsec.co.uk/2024/01/cve-2024-20656-local-privilege-escalation-in-vsstandardcollectorservice150-service/","https://github.com/Wh04m1001/CVE-2024-20656/tree/main"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"  any where host.os.type : \"windows\" \n  and winlog.event_data.NewProcessName : \"*//VSDiagnostics.exe\"\n  and winlog.event_data.CommandLine : \"* start *\" and winlog.event_data.CommandLine : \"* 1 *\" and winlog.event_data.CommandLine : \"* scratchLocation *\"","filters":[],"actions":[]}
{"id":"045147a5-3b04-4baf-97ff-90dc706db848","updated_at":"2025-02-25T04:09:40.428Z","updated_by":"elastic","created_at":"2025-02-25T04:09:40.428Z","created_by":"elastic","name":"UC187 : Abuse of the Windows Server Update Services (WSUS) for lateral movement.","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Windows Server Update Services (WSUS) is a critical component of Windows systems and is frequently configured in a way that allows an attacker to circumvent internal networking limitations. Some tools, such as SharpWSUS and WSUSpendu, support lateral movement through WSUS.This rule covers those two main tools used for that purpose.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"0c02b685-fb44-4430-9ca3-987a125e1636","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1210","name":"Exploitation of Remote Services","reference":"https://attack.mitre.org/techniques/T1210","subtechnique":[]}]}],"to":"now","references":["https://labs.nettitude.com/blog/introducing-sharpwsus/","https://github.com/nettitude/SharpWSUS","https://github.com/AlsidOfficial/WSUSpendu/blob/master/WSUSpendu.ps1"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and \n    (\n        winlog.event_data.CommandLine : \"*//payload:*\"\n        or winlog.event_data.CommandLine : \"*-PayloadArgs*\"\n        or winlog.event_data.CommandLine : \"//updateid:*\"\n        or winlog.event_data.CommandLine : \"*-PayloadFile*\"\n    )\n    and\n    (\n        winlog.event_data.CommandLine : \"*create*\"\n        or winlog.event_data.CommandLine : \"*check*\"\n        or winlog.event_data.CommandLine : \"delete*\"\n        or winlog.event_data.CommandLine : \"*-Inject*\"\n    )","filters":[],"actions":[]}
{"id":"cf906a10-8c7e-4600-903f-8d3f2874dba0","updated_at":"2025-04-16T09:45:04.334Z","updated_by":"purple1","created_at":"2025-04-16T09:45:04.334Z","created_by":"purple1","name":"UC379 : Possible Command and Control by Outlook.exe Spawning Remote Desktop Connection (mstsc.exe) (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects spawning of Remote Desktop Connection (mstsc.exe) from Outlook, likely from received .rdp attachment.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"31d5957a-a2a5-4f15-811c-08033bd21541","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1219","name":"Remote Access Software","reference":"https://attack.mitre.org/techniques/T1219","subtechnique":[]}]}],"to":"now","references":["https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and winlog.event_data.ParentProcessName : \"*\\\\OUTLOOK.EXE\" and winlog.event_data.NewProcessName : \"*\\\\mstsc.exe\" and winlog.event_data.CommandLine : \"* .rdp *\"","filters":[],"actions":[]}
{"id":"04b9a7d0-2f49-462e-a907-a1f822de0e1a","updated_at":"2025-04-09T09:12:09.639Z","updated_by":"purple1","created_at":"2025-04-09T09:12:09.639Z","created_by":"purple1","name":"UC090 : Download","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Attacker may download tool,file or drop malware.\nreferences:","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"f293ff99-a55c-4b95-b6e5-fb059809a72b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1105","name":"Ingress Tool Transfer","reference":"https://attack.mitre.org/techniques/T1105","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1105/T1105.md#atomic-test-7---certutil-download-urlcache"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and (winlog.event_data.CommandLine : \"* -urlcache *\" or winlog.event_data.CommandLine : \"* -verifyctl *\")","filters":[],"actions":[]}
{"id":"712bf8a4-777e-4f0d-b236-01f66f789637","updated_at":"2025-04-16T01:59:36.603Z","updated_by":"purple1","created_at":"2025-04-16T01:59:36.603Z","created_by":"purple1","name":"UC341 : Unusual Command and Control by Remote Desktop Connection (mstsc.exe) Spawned","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects spawning of Remote Desktop Connection (mstsc.exe) with a non-standard port as an commandline argument.","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"98b708e2-c075-446b-9cbd-3e1670fc93e6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1219","name":"Remote Access Software","reference":"https://attack.mitre.org/techniques/T1219","subtechnique":[]}]}],"to":"now","references":["https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and winlog.event_data.NewProcessName : \"*reg.exe\" and winlog.event_data.CommandLine : \"* //v: *\"\n  and not winlog.event_data.CommandLine in (\"* :3389 *\", \"* hvsocketserviceid *\")","filters":[],"actions":[]}
{"id":"a7e0c6a3-8dcc-4cdf-8b48-3c500d0f0b1d","updated_at":"2025-02-25T04:10:32.492Z","updated_by":"elastic","created_at":"2025-02-25T04:10:32.492Z","created_by":"elastic","name":"UC375 : Kerberoasting Powershell Method","tags":["product: windows","category: ps_script"],"interval":"5m","enabled":true,"revision":0,"description":"This rule detects the utilization of specific powershell commands that attempts to execute the \"kerberoasting\" attack\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"702fccfc-0d9b-468a-9902-4da488178672","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1558","name":"Steal or Forge Kerberos Tickets","reference":"https://attack.mitre.org/techniques/T1558","subtechnique":[{"id":"T1558.003","name":"Kerberoasting","reference":"https://attack.mitre.org/techniques/T1558/003"}]}]}],"to":"now","references":["https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/t1208-kerberoasting","https://attack.mitre.org/techniques/T1208/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code : \"4104\" and\n    (\n        (\n            winlog.event_data.ScriptBlockText : \"*Get-NetUser*\" \n            and winlog.event_data.ScriptBlockText : \"*Where-Object*\" \n            and winlog.event_data.ScriptBlockText : \"*servicePrincipalName*\" \n            and winlog.event_data.ScriptBlockText : \"*fl*\"\n        )\n        or\n        (\n            winlog.event_data.ScriptBlockText : \"*get-adobject*\" \n            and winlog.event_data.ScriptBlockText : \"*Where-Object*\" \n            and winlog.event_data.ScriptBlockText : \"*servicePrincipalName*\" \n            and winlog.event_data.ScriptBlockText : \"*-ne*\" \n            and winlog.event_data.ScriptBlockText : \"*$null*\" \n            and winlog.event_data.ScriptBlockText : \"*-and*\" \n            and winlog.event_data.ScriptBlockText : \"*distinguishedname*\" \n            and winlog.event_data.ScriptBlockText : \"*-like*\" \n            and winlog.event_data.ScriptBlockText : \"*CN=Users*\" \n            and winlog.event_data.ScriptBlockText : \"*krbtgt*\"\n        )\n    )","filters":[],"actions":[]}
{"id":"0b4a4e43-05b8-459d-bac7-8e5aeaf45133","updated_at":"2025-02-25T04:09:00.204Z","updated_by":"elastic","created_at":"2025-02-25T04:09:00.204Z","created_by":"elastic","name":"UC064 : Credential Dumping Suspicious Lsass Access","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detected that an attacker tries to obtain the licenses stored in the process memory LSASS.exe.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"73de411c-2262-4fe4-8102-74b300fee1ca","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.001","name":"LSASS Memory","reference":"https://attack.mitre.org/techniques/T1003/001"}]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.001/T1059.001.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"process where host.os.type : \"windows\" and event.code : \"4104\" and\n(\nwinlog.event_data.ScriptBlockText : \"-w hidden\"\nor winlog.event_data.ScriptBlockText : \"-window hidden\"\nor winlog.event_data.ScriptBlockText : \"-noni$\"\nor winlog.event_data.ScriptBlockText : \"-noninteractive\"\nor winlog.event_data.ScriptBlockText : \"-NoProfile\"\nor winlog.event_data.ScriptBlockText : \"-ExecutionPolicy\"\nor winlog.event_data.ScriptBlockText : \"-ep\"\nor winlog.event_data.ScriptBlockText : \"bypass\"\nor winlog.event_data.ScriptBlockText : \"-nop\"\nor winlog.event_data.ScriptBlockText : \"-c\"\nor winlog.event_data.ScriptBlockText : \"-exec\"\nor winlog.event_data.ScriptBlockText : \"-File\"\nor winlog.event_data.ScriptBlockText : \"-Command\"\nor winlog.event_data.ScriptBlockText : \"-version 2\"\nor winlog.event_data.ScriptBlockText : \"-versio 2\"\nor winlog.event_data.ScriptBlockText : \"-versi 2\"\nor winlog.event_data.ScriptBlockText : \"-vers 2\"\nor winlog.event_data.ScriptBlockText : \"-ver 2\"\nor winlog.event_data.ScriptBlockText : \"-ve 2\"\nor winlog.event_data.ScriptBlockText : \"iex\"\nor winlog.event_data.ScriptBlockText : \"Invoke-expression\"\n)","filters":[],"actions":[]}
{"id":"2690478c-7966-495f-a8a1-b7b27e38c06d","updated_at":"2025-04-14T02:33:12.581Z","updated_by":"purple1","created_at":"2025-02-27T10:30:48.430Z","created_by":"elastic","name":"UC263 : Possible XScan Vulnerability Scanner Execution Attempt (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may try to use XScan vulnerability scanner in order to find and further exploit vulnerabilities in the compromised system.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":["- Unknown"],"from":"now-360s","rule_id":"a87cbc32-1e0c-4644-b1ef-443591e39caa","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0043","name":"Reconnaissance","reference":"https://attack.mitre.org/tactics/TA0043"},"technique":[{"id":"T1595","name":"Active Scanning","reference":"https://attack.mitre.org/techniques/T1595","subtechnique":[{"id":"T1595.002","name":"Vulnerability Scanning","reference":"https://attack.mitre.org/techniques/T1595/002"}]}]}],"to":"now","references":["https://unit42.paloaltonetworks.com/threat-brief-cve-2023-4966-netscaler-citrix-bleed/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.NewProcessName: \"*\\\\.exe\" \n    and winlog.event_data.CommandLine in (\"* -h *\", \"* -host *\")\n    and winlog.event_data.CommandLine in  (\"* finger *\", \"* vulnscan *\",\"* skipportscan *\",\"* pocscanproxy *\",\"* sshcmd *\",\"* xscan *\",\"* noping *\")","filters":[],"actions":[]}
{"id":"d739577a-b135-493d-b7d9-76633ef09b07","updated_at":"2025-04-15T07:59:50.721Z","updated_by":"purple1","created_at":"2025-02-27T10:31:45.756Z","created_by":"elastic","name":"UC329 : DNS Exfiltration and Tunneling Tools Execution","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Well-known DNS Exfiltration tools execution","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2f55738b-d65a-4dbc-918a-04955fbdb232","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010"},"technique":[{"id":"T1048","name":"Exfiltration Over Alternative Protocol","reference":"https://attack.mitre.org/techniques/T1048","subtechnique":[{"id":"T1048.001","name":"Exfiltration Over Symmetric Encrypted Non-C2 Protocol","reference":"https://attack.mitre.org/techniques/T1048/001"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1071","name":"Application Layer Protocol","reference":"https://attack.mitre.org/techniques/T1071","subtechnique":[{"id":"T1071.004","name":"DNS","reference":"https://attack.mitre.org/techniques/T1071/004"}]},{"id":"T1132","name":"Data Encoding","reference":"https://attack.mitre.org/techniques/T1132","subtechnique":[{"id":"T1132.001","name":"Standard Encoding","reference":"https://attack.mitre.org/techniques/T1132/001"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"  any where host.os.type : \"windows\" and winlog.event_data.NewProcessName in (\"*\\\\iodine.exe\", \"*\\\\dnscat2\", \"*\\\\dnsteal\", \"*\\\\dnsExfiltrator\", \"*\\\\dns2tcp\", \"*\\\\Arecibo\")","filters":[],"actions":[]}
{"id":"d77772cb-6e0b-411b-bbf7-7bee3024ba92","updated_at":"2025-04-14T03:16:51.296Z","updated_by":"purple1","created_at":"2025-02-27T10:30:52.459Z","created_by":"elastic","name":"UC277 : Suspicious VSSADMIN Activity (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Volume Shadow Copy allows adversaries to obtain copies of sensitive files such as Ntds.dit or SYSTEM files.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"71d26a32-fad6-49c4-80d8-9ee552e2b6db","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.003","name":"NTDS","reference":"https://attack.mitre.org/techniques/T1003/003"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0040","name":"Impact","reference":"https://attack.mitre.org/tactics/TA0040"},"technique":[{"id":"T1490","name":"Inhibit System Recovery","reference":"https://attack.mitre.org/techniques/T1490","subtechnique":[]}]}],"to":"now","references":["https://posts.specterops.io/domain-of-thrones-part-i-c183ee4bf379","https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-263a","https://asec.ahnlab.com/en/58753/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.NewProcessName : \"*OUTLOOK.EXE\" and winlog.event_data.CommandLine : \"* /f *\"\n    and winlog.event_data.CommandLine : \"* .msg *\"\n    and not winlog.event_data.CommandLine in (\"* Downloads *\", \"* TMP *\", \"* Temp *\", \"* Public *\")","filters":[],"actions":[]}
{"id":"5697f6d0-3449-463a-ad3e-77ecaf62b745","updated_at":"2025-04-17T02:55:16.729Z","updated_by":"purple1","created_at":"2025-04-04T03:57:32.544Z","created_by":"purple1","name":"UC028 : Suspicious PowerShell Download ","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects suspicious PowerShell download command","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e6fbad3c-2405-436a-9310-812fb2ac291e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]}],"to":"now","references":["https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_suspicious_download.yml","https://book.hacktricks.xyz/windows/basic-powershell-for-pentesters#bitstransfer"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code : \"4688\" and winlog.event_data.CommandLine : \"* Net.Webclient *\" and (winlog.event_data.CommandLine : \"* DownloadString( *\" or winlog.event_data.CommandLine : \"* DownloadFile( *\")","filters":[],"actions":[]}
{"id":"ca52b583-70ee-4486-830b-a6e72ea45ec8","updated_at":"2025-04-09T09:30:44.940Z","updated_by":"purple1","created_at":"2025-04-09T09:30:44.940Z","created_by":"purple1","name":"UC103 : C#.NET Code Execution","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Attackers attempt to execute C# code","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"d3fd993f-d1c5-4ad0-bebf-8b4ffbb1c89e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1010/T1010.md","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1027.004/T1027.004.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and  winlog.event_data.NewProcessName : \"*\\\\csc.exe\" and winlog.event_data.CommandLine in (\"* -out: *\", \"* /out: *\")","filters":[],"actions":[]}
{"id":"c7e14437-8a6b-4396-a1f5-fa4bb6bf1bb6","updated_at":"2025-04-16T02:21:43.975Z","updated_by":"purple1","created_at":"2025-02-25T04:12:32.707Z","created_by":"elastic","name":"UC345 : Possible Impacket Command Line Patterns (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Possible Impacket Command Line Patterns (via cmdline)\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2a4f4cd0-e016-40a0-a942-bf7ce3f02f72","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1021","name":"Remote Services","reference":"https://attack.mitre.org/techniques/T1021","subtechnique":[{"id":"T1021.003","name":"Distributed Component Object Model","reference":"https://attack.mitre.org/techniques/T1021/003"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1559","name":"Inter-Process Communication","reference":"https://attack.mitre.org/techniques/T1559","subtechnique":[{"id":"T1559.001","name":"Component Object Model","reference":"https://attack.mitre.org/techniques/T1559/001"}]}]}],"to":"now","references":["https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/iran-apt-seedworm-africa-telecoms","https://www.infosecurity-magazine.com/news/signature-techniques-of-asian-apt/","https://www.reliaquest.com/blog/double-extortion-attack-analysis/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.CommandLine in (\"* \\\\ *\", \"* $ *\", \"* __ *\", \"* > *\")","filters":[],"actions":[]}
{"id":"31a7783b-974b-486b-8ccd-d434237e0b5a","updated_at":"2025-04-09T11:18:09.744Z","updated_by":"purple1","created_at":"2025-04-09T11:18:09.744Z","created_by":"purple1","name":"UC184 : Data Exfiltration","tags":["product: windows"],"interval":"5m","enabled":true,"revision":0,"description":"Data Exfiltration","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"74251129-ea9b-431b-86f4-3c3b309c24b0","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010"},"technique":[{"id":"T1020","name":"Automated Exfiltration","reference":"https://attack.mitre.org/techniques/T1020","subtechnique":[]}]}],"to":"now","references":["https://blog.apnic.net/2022/03/31/how-to-detect-and-prevent-common-data-exfiltration-attacks/ author: "],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code : \"4104\" and winlog.event_data.ScriptBlockText in (\"* Invoke-WebRequest*-Method POST *\", \"* Invoke-WebRequest*-Method PUT *\", \"* Send-MailMessage*attachments *\") ","filters":[],"actions":[]}
{"id":"aa6c6059-b964-4db4-a9bf-e6d03eb7cdf9","updated_at":"2025-02-25T04:12:01.680Z","updated_by":"elastic","created_at":"2025-02-25T04:12:01.680Z","created_by":"elastic","name":"UC355 : Possible Credentials Dump Activity - Accessing WinAPI with PowerShell","tags":["product: windows","service: sysmon"],"interval":"5m","enabled":true,"revision":0,"description":"The rule detects possible accessing to lsass.exe by Powershell.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e737d728-157d-4897-bd0c-08645ee45d70","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[]}],"to":"now","references":["https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n        (\n            event.code : \"8\" or event.code : \"10\"\n        )\n        and\n        (\n            winlog.event_data.SourceImage : \"*powershell.exe\" or winlog.event_data.SourceImage : \"*pwsg.exe\"\n        )\nand winlog.event_data.TargetImage : \"*lsass.exe\"\n    )","filters":[],"actions":[]}
{"id":"26a17c3a-6d7c-43b9-8aaa-4c13c0a23cb3","updated_at":"2025-04-17T03:00:53.833Z","updated_by":"purple1","created_at":"2025-04-04T04:45:14.070Z","created_by":"purple1","name":"UC029 : Suspicious PowerShell Invocations - Generic","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects suspicious PowerShell invocation command parameters","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"c1325fb2-ecfe-4950-8bd3-da4233bceede","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1059.001/T1059.001.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \nand event.code : \"4688\"\nand winlog.event_data.NewProcessName : \"*\\\\powershell.exe\" \nand winlog.event_data.CommandLine in (\"* w hidden *\", \"* window hidden *\", \"* windowstyle hidden *\", \"* noni *\", \"* noninteractive *\", \"* NoProfile *\", \"* ExecutionPolicy *\", \"* ep*\", \"* bypass *\", \"* nop *\", \"* c *\", \"* exec *\", \"* File *\", \"* Command *\", \"* version 2 *\", \"* versio 2 *\", \"* versi 2 *\", \"* vers 2 *\", \"* ver 2 *\", \"* ve 2 *\", \"* iex *\", \"* Invoke-expression *\")","filters":[],"actions":[]}
{"id":"d3cf0a4b-d7fa-497d-8e2c-755ac529f323","updated_at":"2025-04-14T03:55:01.930Z","updated_by":"purple1","created_at":"2025-04-14T03:55:01.930Z","created_by":"purple1","name":"UC283 : w3wp spawning suspicious processs","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detect w3wp.exe spawning suspicious processs, this might be related to webshell activites","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"889acfe6-6661-4c12-afe4-79a81900be45","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1505","name":"Server Software Component","reference":"https://attack.mitre.org/techniques/T1505","subtechnique":[{"id":"T1505.003","name":"Web Shell","reference":"https://attack.mitre.org/techniques/T1505/003"},{"id":"T1505.004","name":"IIS Components","reference":"https://attack.mitre.org/techniques/T1505/004"}]}]}],"to":"now","references":["https://m365internals.com/2022/10/09/hunting-exchange-webshell-activity/","https://redcanary.com/blog/microsoft-exchange-attacks/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and winlog.event_data.ParentProcessName : \"*\\\\w3wp.exe\" \n    and (winlog.event_data.NewProcessName in (\"*//cmd.exe\", \"*//powershell.exe\", \"*//ping.exe\", \"*//ipconfig.exe\")\n    or winlog.event_data.CommandLine in (\"* whoami *\", \"* nslookup *\", \"* systeminfo *\", \"* cd *\"))","filters":[],"actions":[]}
{"id":"cbd421bf-15a1-42e7-89d7-1c275acd133c","updated_at":"2025-04-09T01:57:17.429Z","updated_by":"purple1","created_at":"2025-04-09T01:57:17.429Z","created_by":"purple1","name":"UC048 : Windows Discovery System Information","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attacker performs the spying on information about the windows system.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"eaa1ae4c-2dd6-42a8-b364-d684e3b0f958","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1082","name":"System Information Discovery","reference":"https://attack.mitre.org/techniques/T1082","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md","https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n    winlog.event_data.NewProcessName : \"*\\\\reg.exe\" and winlog.event_data.CommandLine in (\"* SYSTEM\\\\CurrentControlSet\\\\Services\\\\Disk\\\\Enum *\", \"* SOFTWARE\\\\Microsoft\\\\Cryptography /v MachineGuid *\")\n    or winlog.event_data.NewProcessName in (\"*\\\\systeminfo.exe\", \"*\\\\hostname.exe\", \"*\\\\winver.exe\")\n    or winlog.event_data.NewProcessName : \"*\\\\wmic.exe\" and winlog.event_data.CommandLine : \"* computersystem *\"\n    )","filters":[],"actions":[]}
{"id":"93cd64ac-086b-4aaa-9a70-33f9a0bde42c","updated_at":"2025-04-14T03:19:24.323Z","updated_by":"purple1","created_at":"2025-04-14T03:19:24.323Z","created_by":"purple1","name":"UC280 : Outlook Used to Open Stand-Alone Message File with Suspicious Location (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Malicious actors may attempt to phish users by sending customized .msg files that contain malware or a part of exploit the CVE-2023-23397 vulnerability (crafted msg file with PidLidReminderFileParameter and PidLidReminderOverride properties). The reliance on the surrounding environment may necessitate the implementation of additional filtering measures to prevent false positives.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e51ade81-f84d-484b-9464-f78c6425beea","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1566","name":"Phishing","reference":"https://attack.mitre.org/techniques/T1566","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1556","name":"Modify Authentication Process","reference":"https://attack.mitre.org/techniques/T1556","subtechnique":[{"id":"T1556.001","name":"Domain Controller Authentication","reference":"https://attack.mitre.org/techniques/T1556/001"}]}]}],"to":"now","references":["https://twitter.com/domchell/status/1635999068282408962","https://msrc.microsoft.com/blog/2023/03/microsoft-mitigates-outlook-elevation-of-privilege-vulnerability/","https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-23397"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.NewProcessName : \"*OUTLOOK.EXE\" and winlog.event_data.CommandLine : \"* /f *\"\n    and winlog.event_data.CommandLine : \"* .msg *\"\n    and not winlog.event_data.CommandLine in (\"* Downloads *\", \"* TMP *\", \"* Temp *\", \"* Public *\")","filters":[],"actions":[]}
{"id":"e089f83d-625b-4031-8106-953eac63c859","updated_at":"2025-04-15T02:15:07.049Z","updated_by":"purple1","created_at":"2025-04-15T02:15:07.049Z","created_by":"purple1","name":"UC303 : Powershell Script was Executed from Uncommon Directory with Suspicious Arguments   (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to execute previously created malicious powershell script in order to perform malicious activity.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"ab44a2f9-938b-431e-b88e-44f782b6721e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":" any where host.os.type : \"windows\" \nand winlog.event_data.NewProcessName : \"*// powershell.exe\"\nand winlog.event_data.CommandLine : \"* .ps1 *\" and winlog.event_data.CommandLine : \"* NonInteractive *\" and winlog.event_data.CommandLine : \"* NoLogo *\" and winlog.event_data.CommandLine in (\"* AppData *\", \"* ProgramData *\", \"* Temp *\", \"* Local *\", \"* Public *\")","filters":[],"actions":[]}
{"id":"55b223c8-1203-4676-a8ef-b824d87889fa","updated_at":"2025-04-15T02:09:33.915Z","updated_by":"purple1","created_at":"2025-02-27T10:31:09.616Z","created_by":"elastic","name":"UC302 : Suspicious Archive in Archive Execution (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries could make multiple achieving layers to avoid some detections and static analyzers to obtain user execution on target machine.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"555b170c-07e3-4027-8690-8328744515ca","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1566","name":"Phishing","reference":"https://attack.mitre.org/techniques/T1566","subtechnique":[{"id":"T1566.001","name":"Spearphishing Attachment","reference":"https://attack.mitre.org/techniques/T1566/001"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.ParentImage : \"*\\\\WinRAR.exe\" and winlog.event_data.NewProcessName : \"*\\\\WinRAR.exe\" and winlog.event_data.CommandLine : \"* Rar$ *\" and winlog.event_data.CommandLine : \"* .rar *\"","filters":[],"actions":[]}
{"id":"5610eba1-f0b6-4320-b8a9-6c1454b60c85","updated_at":"2025-04-14T10:11:00.077Z","updated_by":"purple1","created_at":"2025-02-27T10:31:04.596Z","created_by":"elastic","name":"UC296 : CSRSS.exe spawned from unusual location (possible mimicking) (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"This rule looks for csrss spawning from outside of the normal system32 path. No csrss does not exist within Syswow64.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"bc6c8e07-1ba4-4b92-8d71-e05438e032cc","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1036","name":"Masquerading","reference":"https://attack.mitre.org/techniques/T1036","subtechnique":[{"id":"T1036.005","name":"Match Legitimate Name or Location","reference":"https://attack.mitre.org/techniques/T1036/005"}]}]}],"to":"now","references":["https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.Image : \"*csrss.exe\" and not winlog.event_data.Image : \"*\\\\Windows\\\\*\"","filters":[],"actions":[]}
{"id":"21327e2b-a596-41e6-a20e-124d9a2c368d","updated_at":"2025-03-26T02:08:43.107Z","updated_by":"purple1","created_at":"2025-03-25T02:37:00.145Z","created_by":"elastic","name":"UC176 : Logging configuration change","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may modify and/or disable syslog to avoid detection of monitoring system.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"ba09266f-cb95-44a4-88e6-01757de70242","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[{"id":"T1562.004","name":"Disable or Modify System Firewall","reference":"https://attack.mitre.org/techniques/T1562/004"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and\n        (\n            process.args : \"*/etc/syslog.conf\"\n            or process.args : \"*/etc/syslog.conf\"\n            or process.args : \"*/etc/syslog-ng/syslog-ng.conf\"\n            or process.args : \"*/etc/rsyslog.d/*.conf*\"\n        )","filters":[],"actions":[]}
{"id":"8008df19-bb45-414a-8267-8fe5f971b554","updated_at":"2025-03-25T03:05:55.024Z","updated_by":"purple1","created_at":"2025-03-25T02:36:48.085Z","created_by":"elastic","name":"UC168 : Indicator Removal Clear Linux or Mac System Logs","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may clear system logs to hide evidence of an intrusion. macOS and Linux both keep track of system or user-initiated actions via system logs. \n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"006b6c5f-4511-4e71-820e-07a539af7ead","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1070","name":"Indicator Removal","reference":"https://attack.mitre.org/techniques/T1070","subtechnique":[{"id":"T1070.002","name":"Clear Linux or Mac System Logs","reference":"https://attack.mitre.org/techniques/T1070/002"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action : \"execve\"\n    and\n    (\n      (\n        process.args : \"rm\"\n        or process.args : \"shred\"\n        or process.args : \"rmdir\" \n        or process.args : \"unlink\" \n        or (process.args : \"truncate\" and process.args : \"-s\" and process.args : \"0\")\n      )\n      and\n      (\n        process.args : \"*/var/log\" \n        or process.args : \"*/var/spool/mail\" \n        or process.args : \"*.log\" \n      )\n    )","filters":[],"actions":[]}
{"id":"1c0d8e7c-cc83-4400-b804-528e643f9960","updated_at":"2025-03-25T04:27:36.910Z","updated_by":"purple1","created_at":"2025-03-25T02:36:42.066Z","created_by":"elastic","name":"UC163 : Event Triggered Execution Unix Shell Configuration Modification","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":2,"description":"Adversaries may establish persistence through executing malicious commands triggered by a user’s shell. User Unix Shells execute several configuration scripts at different points throughout the session based on events.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"463b38b3-8060-42f0-964e-d30412910e60","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068","subtechnique":[]}]}],"to":"now","references":["https://attackdefense.com/challengedetailsnoauth?cid=1551","https://www.elastic.co/guide/en/security/7.17/prebuilt-rule-0-14-1-bash-shell-profile-modification.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action : \"execve\"\n    and\n    (\n        process.executable in (\"vi\", \"vim\", \"nano\")\n      and\n      (\n        process.args : \"bashrc\" \n        or process.args : \"bash_profile\" \n        or process.args : \".profile\" \n        or process.args : \"/etc/profile/*\" \n        or process.args : \"/etc/shells/*\" \n        or process.args : \"/etc/bashrc/*\"\n        or process.args : \"*/csh.cshrc\" \n        or process.args : \"*/csh.login\" \n        or process.args : \"*/bash_logout\"\n      )\n    )","filters":[],"actions":[]}
{"id":"512fd474-925c-4993-86db-e1895a5025a1","updated_at":"2025-03-27T01:59:42.690Z","updated_by":"purple1","created_at":"2025-03-25T02:36:19.697Z","created_by":"elastic","name":"UC108 : Credentials Discovery","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"Detecting attempts to extract credentials in system.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"66035e65-0e17-463c-805c-68350146b7dc","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://attack.mitre.org/techniques/T1552/001/","https://github.com/SigmaHQ/sigma/blob/master/rules/linux/lnx_find_cred_in_files.yml","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.001/T1552.001.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.kind : \"event\"\n    and event.action : \"execve\"\n    and \n    (\n        process.args like \"*grep*\" \n        and\n        (\n            process.args like \"*password*\" \n            or process.args like \"*pwd*\"\n            or process.args like \"*pass*\"\n        )\n    )","filters":[],"actions":[]}
{"id":"071c0094-d9f2-4db4-a1b1-613947340351","updated_at":"2025-03-25T02:36:50.098Z","updated_by":"elastic","created_at":"2025-03-25T02:36:50.098Z","created_by":"elastic","name":"UC170 : System Service Discovery 2","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as sc query, tasklist /svc, systemctl --type=service, and net start.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2cc6b172-fd42-4c58-9659-49aeffb2d3fb","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.004","name":"Unix Shell","reference":"https://attack.mitre.org/techniques/T1059/004"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action : \"execve\"\n    and\n    (\n      (\n        process.args : \"*systemctl*\"\n        and\n        (\n          (\n            process.args : \"*--type=service*\"\n            or (\n              process.args : \"*--type=service*\" and process.args : \"*list-units*\"\n            )\n          )\n        )\n      )\n      or\n      (\n        process.args : \"*service*\" and process.args : \"*--status-all*\"\n      )\n      or\n      (\n        process.args : \"*ls*\" and process.args : \"*/etc/init.d/*\"\n      )\n    )","filters":[],"actions":[]}
{"id":"f21318dc-2f8b-4d8f-91b2-7e39bd4f2bdb","updated_at":"2025-04-17T02:00:01.727Z","updated_by":"purple1","created_at":"2025-04-17T02:00:01.727Z","created_by":"purple1","name":"UC382 : Possible Telegram Abuse As Command And Control Channel (via dns_query)","tags":["product: windows","category: dns_query"],"interval":"5m","enabled":true,"revision":0,"description":"This rule identifies t.me and Telegram API endpoint dns queries made by suspicious processes. This may be an indicator of C2 communications.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e89df916-5047-4d86-baf8-347ea99caf1b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://asec.ahnlab.com/en/62177/","https://unit42.paloaltonetworks.com/nodestealer-2-targets-facebook-business/","https://socradar.io/dark-web-profile-big-head-ransomware/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" \nand (t.me or api.telegram.org or telegra.ph) \nand not (winlog.event_data.NewProcessName : \"*\\\\telegram.exe\" \n  or winlog.event_data.NewProcessName : \"*\\\\msedge.exe\" \n  or winlog.event_data.NewProcessName : \"*\\\\firefox.exe\" \n  or winlog.event_data.NewProcessName : \"*\\\\opera.exe\" \n  or winlog.event_data.NewProcessName : \"*\\\\brave.exe\" \n  or (winlog.event_data.NewProcessName : \"*\\\\Program *\" and winlog.event_data.NewProcessName : \"* Files *\"))","filters":[],"actions":[]}
{"id":"500983e2-0c4a-4ae6-9c7d-da17832af813","updated_at":"2025-04-09T09:40:59.112Z","updated_by":"purple1","created_at":"2025-04-09T09:40:59.112Z","created_by":"purple1","name":"UC123 : Change AD Account Password Several Time In A Short Period Of Time","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detects change AD account password several time in a short period of time. Time range can be changed","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"12f74ccf-a72a-4d4f-8b8a-9df19095716a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"sequence by host.name with maxspan=30m\n    [any where host.os.type : \"windows\" and event.code : \"4723\" ] with runs=5","filters":[],"actions":[]}
{"id":"a5940abd-9957-459b-9fa3-123fa4f8e13d","updated_at":"2025-04-08T04:52:52.016Z","updated_by":"purple1","created_at":"2025-04-03T09:19:46.799Z","created_by":"purple1","name":"UC002 : Multiple Login Failure From One IP Address With Many AD Accounts","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":2,"description":"Multiple login failure from one ip address with many AD accounts. Time range and number of accounts can be modified.\n\n","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"886f8cc8-442a-4b88-ac92-4097a5beb177","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078","subtechnique":[{"id":"T1078.001","name":"Default Accounts","reference":"https://attack.mitre.org/techniques/T1078/001"},{"id":"T1078.002","name":"Domain Accounts","reference":"https://attack.mitre.org/techniques/T1078/002"},{"id":"T1078.003","name":"Local Accounts","reference":"https://attack.mitre.org/techniques/T1078/003"}]}]}],"to":"now","references":["https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_susp_failed_logons_single_source.yml"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"  sequence by host.ip, host.name with maxspan = 30m\n    [any where host.os.type : \"windows\" and event.code in (\"4625\", \"4776\") and\n    not host.name : (\"ANONYMOUS LOGON\", \"-\", \"*$\")] with runs = 5 ","filters":[],"actions":[]}
{"id":"11c633bb-7a0d-4197-830e-169ab6d5a27b","updated_at":"2025-04-08T10:38:41.328Z","updated_by":"purple1","created_at":"2025-04-08T10:38:41.328Z","created_by":"purple1","name":"UC045 : Windows Discovery Network Sniffing","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attackers spy on information about shared folders and files on windows.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"7a0294c7-a23f-4943-8f17-e8952b8e7ad9","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1040/T1040.md#atomic-test-3---packet-capture-windows-command-prompt","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1040/T1040.md#atomic-test-4---windows-internal-packet-capture","https://lolbas-project.github.io/lolbas/Binaries/Pktmon/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and event.code : \"4688\"\n    and \n    (\n      winlog.event_data.NewProcessName : \"*\\\\tshark.exe\" and winlog.event_data.CommandLine : \"* -i *\"\n      or winlog.event_data.NewProcessName : \"*\\\\netsh.exe\" and winlog.event_data.CommandLine : \"* start capture *\"\n      or winlog.event_data.NewProcessName in (\"*\\\\windump.exe\", \"*\\\\PktMon.exe\")\n    )","filters":[],"actions":[]}
{"id":"1a5fa044-2d25-4f7c-ac30-b0f5bbcbb3bc","updated_at":"2025-04-10T02:42:34.017Z","updated_by":"purple1","created_at":"2025-04-10T02:42:34.017Z","created_by":"purple1","name":"UC202 : USB Device Plugged","tags":["product: windows","service: driver-framework"],"interval":"5m","enabled":true,"revision":0,"description":"Detects plugged/unplugged USB devices","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"ad7c0efe-d99a-41e9-8ff2-1f898c1b3541","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1200","name":"Hardware Additions","reference":"https://attack.mitre.org/techniques/T1200","subtechnique":[]}]}],"to":"now","references":["https://df-stream.com/2014/01/the-windows-7-event-log-and-usb-device/","https://www.techrepublic.com/article/how-to-track-down-usb-flash-drive-usage-in-windows-10s-event-viewer/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and (event.code : \"2003\" or event.code : \"2100\" or event.code : \"2102\")","filters":[],"actions":[]}
{"id":"9d21d697-afa8-44bf-86b0-36a59323afd9","updated_at":"2025-04-10T02:17:43.590Z","updated_by":"purple1","created_at":"2025-04-10T02:17:43.590Z","created_by":"purple1","name":"UC195 : Access Token Manipulation (Parent PID Spoofing)","tags":["product: windows","service: sysmon"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may spoof the parent process identifier (PPID) of a new process to evade process-monitoring defenses or to elevate privileges. New processes are typically spawned directly from their parent, or calling, process unless explicitly specified","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"14ce044b-f86e-4f46-a874-b3f1e334febc","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"query","language":"kuery","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"host.os.type : \"windows\" and event.code : \"10\" and winlog.event_data.GrantedAccess : \"0x1FFFFF\"","filters":[],"actions":[]}
{"id":"6f1ceff8-ca5d-412c-beb7-76150020583c","updated_at":"2025-04-15T04:26:09.267Z","updated_by":"purple1","created_at":"2025-02-26T03:04:30.531Z","created_by":"purple1","name":"UC317 : Possible Get-PassHashes / PowerDump Usage (via powershell)","tags":["product: windows","service: powershell"],"interval":"5m","enabled":true,"revision":1,"description":"Get-passhashes is a powershell tool part of nishang. It dumps password hashes.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"1806e91d-ec49-4a4a-87c4-a2be16a5e673","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[]}]}],"to":"now","references":["https://github.com/samratashok/nishang/blob/master/Gather/Get-PassHashes.ps1"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and \n  (winlog.event_data.ScriptBlockText in (\"* NTPASSWORD *\", \"* LMPASSWORD *\", \"* odd_parity *\", \"* 4278190080 *\", \"* 16777216 *\")\n    or winlog.event_data.ScriptBlockText in (\"* 0xaa *\", \"* 0xd3 *\", \"* 0xb4 *\", \"* 0x35 *\", \"* 0xb5 *\")\n    or winlog.event_data.ScriptBlockText in (\"* 0x31 *\", \"* 0xd6 *\", \"* 0xcf *\", \"* 0xe0 *\", \"* 0xd1 *\"))","filters":[],"actions":[]}
{"id":"3fba60b4-ecda-4279-a8ed-37dcb5b7f45d","updated_at":"2025-04-09T09:46:03.208Z","updated_by":"purple1","created_at":"2025-04-09T09:46:03.208Z","created_by":"purple1","name":"UC124 : Change AD Account Password Several Time In A Short Period Of Time By Domain Admin","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Change AD account password several time in a short period of time by domain admin. Time range can be changed.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"392f3c89-d9ef-4239-80e3-185d117f8b45","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1098","name":"Account Manipulation","reference":"https://attack.mitre.org/techniques/T1098","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"sequence by host.name with maxspan=30m\n    [any where host.os.type : \"windows\" and event.code : \"4724\" ] with runs=5","filters":[],"actions":[]}
{"id":"76c6fcac-f2ee-4158-9173-f18491033281","updated_at":"2025-04-14T02:26:05.396Z","updated_by":"purple1","created_at":"2025-02-27T10:30:46.406Z","created_by":"elastic","name":"UC261 : Possible payload delivery via WMI (Cobalt Strike)","tags":["product: windows","service: sysmon"],"interval":"5m","enabled":true,"revision":1,"description":"Technique uses PowerShell to bootstrap your payload on target.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"4eb3f6d7-641e-40b5-8ef0-729a3263412a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]},{"id":"T1047","name":"Windows Management Instrumentation","reference":"https://attack.mitre.org/techniques/T1047","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.ParentProcessName : \"*\\\\WmiPrvSE.exe\"\n    and winlog.event_data.NewProcessName : \"*\\\\powershell.exe\"\n    and winlog.event_data.CommandLine : \"* Value *\" and winlog.event_data.CommandLine : \"* env *\" and winlog.event_data.CommandLine : \"* IE *\"and winlog.event_data.CommandLine : \"* -w hidden -encodedcommand *\"","filters":[],"actions":[]}
{"id":"57a6d0d0-4e56-4b11-9b83-9f5c00bf72aa","updated_at":"2025-04-15T07:53:40.643Z","updated_by":"purple1","created_at":"2025-02-27T10:31:43.750Z","created_by":"elastic","name":"UC327 : HTML Help HH.EXE Suspicious Child Process","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects a suspicious child process of a Microsoft HTML Help (HH.exe)\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"d8e7a536-97fc-4d53-8d90-3b3fa1db6de3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[]}],"to":"now","references":["https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/chm-badness-delivers-a-banking-trojan/","https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-27939090904026cc396b0b629c8e4314acd6f5dac40a676edbc87f4567b47eb7","https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/","https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.ParentProcessName : \"*\\\\hh.exe\" \n    and winlog.event_data.NewProcessName in (\"*\\\\CertReq.exe\", \"*\\\\CertUtil.exe\", \"*\\\\cmd.exe\", \"*\\\\cscript.exe\", \"*\\\\installutil.exe\", \"*\\\\MSbuild.exe\", \"*\\\\MSHTA.exe\", \"*\\\\msiexec.exe\", \"*\\\\powershell.exe\", \"*\\\\pwsh.exe\", \"*\\\\regsvr32.exe\", \"*\\\\rundll32.exe\", \"*\\\\schtasks.exe\", \"*\\\\wmic.exe\", \"*\\\\wscript.exe\")","filters":[],"actions":[]}
{"id":"e0b8d50e-4ec5-4b1b-a52f-7e436a2e1e47","updated_at":"2025-02-25T04:11:49.670Z","updated_by":"elastic","created_at":"2025-02-25T04:11:49.670Z","created_by":"elastic","name":"UC360 : Suspicious Processes with Recycle.Bin Path (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to create malicious process via $Recycle.bin in order to avoid detection\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"5346113c-2577-4000-97a6-b7794aca18f1","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1036","name":"Masquerading","reference":"https://attack.mitre.org/techniques/T1036","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"},{"id":"T1059.003","name":"Windows Command Shell","reference":"https://attack.mitre.org/techniques/T1059/003"}]}]}],"to":"now","references":["https://www.infosecurity-magazine.com/news/signature-techniques-of-asian-apt/","https://www.recordedfuture.com/bluebravo-adapts-to-target-diplomatic-entities-with-graphicalproton-malware","https://go.recordedfuture.com/hubfs/reports/cta-2023-0727-1.pdf","https://www.cybereason.com/blog/research/deadringer-exposing-chinese-threat-actors-targeting-major-telcos"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n        winlog.event_data.Image : \"*Recycle.bin*\" and winlog.event_data.CommandLine : \"*Recycle.bin*\"\n    )","filters":[],"actions":[]}
{"id":"174102a1-2e47-436e-bdaf-66db45e4545b","updated_at":"2025-04-14T04:45:14.754Z","updated_by":"purple1","created_at":"2025-04-14T04:45:14.754Z","created_by":"purple1","name":"UC285 : Suspicious CURL Usage (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":" As CURL is available by default in Windows 10 build 17063 adversaries abuse it to download payloads, exfiltrate data, or to support their command and control.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"376e9db4-7378-45b9-8887-66b1ef455b42","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1071","name":"Application Layer Protocol","reference":"https://attack.mitre.org/techniques/T1071","subtechnique":[{"id":"T1071.001","name":"Web Protocols","reference":"https://attack.mitre.org/techniques/T1071/001"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010"},"technique":[{"id":"T1041","name":"Exfiltration Over C2 Channel","reference":"https://attack.mitre.org/techniques/T1041","subtechnique":[]}]}],"to":"now","references":["https://cert.gov.ua/article/5702579","https://blog.sekoia.io/bluenoroffs-rustbucket-campaign","https://www.mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.NewProcessName : \"*\\\\curl.exe\"\n    and winlog.event_data.CommandLine in (\"* -F *\", \"* -uri  *\", \"* -O *\", \"* -o *\", \"* -T  *\", \"* --upload-file *\", \"* --xattr *\", \"* -t  *\", \"* -k  *\", \"* --insecure  *\", \"* >>  *\", \"* >  *\", \"* -resolve  *\", \"* -output  *\" , \"* -silent  *\", \"* % *\" , \"* --data-binary *\")\n    and not winlog.event_data.NewProcessName in (\"*\\\\git.exe\", \"*\\\\/bin/\", \"*\\\\PhpStorm\", \"*\\\\Cellar\")","filters":[],"actions":[]}
{"id":"e3aa957e-06fe-4f28-ad0f-8e98ba751498","updated_at":"2025-04-14T09:41:09.556Z","updated_by":"purple1","created_at":"2025-04-14T09:41:09.556Z","created_by":"purple1","name":"UC289 : Suspicious Direct File System Request (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may use direct file system requests to bypass security controls and perform malicious activity.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"09e95481-d33f-444c-a8a9-4fafff4bd5be","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1006","name":"Direct Volume Access","reference":"https://attack.mitre.org/techniques/T1006","subtechnique":[]}]}],"to":"now","references":["https://www.sentinelone.com/blog/dbatloader-and-remcos-rat-sweep-eastern-europe/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.NewProcessName in (\"*\\\\.exe\", \"*\\\\.com\", \"*\\\\.scr\", \"*\\\\.tmp\")\n    and winlog.event_data.CommandLine : \"* \\\\?\\\\ *\"\n    and not\n    (winlog.event_data.NewProcessName in (\"*\\\\bin\\\\pycharm64.exe\", \"*\\\\bin\\\\bash.exe\", \"*\\\\gpu_encoder_helper.exe\", \"*\\\\SecurityHealthHost.exe\", \"*\\\\SecurityHealthSetup.exe\", \"*\\\\wuaucltcore.exe\", \"*\\\\dfrgui.exe\", \"*\\\\fvenotify.exe\", \"*\\\\firefox.exe\", \"*\\\\Evernote.exe\", \"*\\\\thunderbird.exe\", \"*\\\\GoogleDriveFS.exe\")\n      or winlog.event_data.NewProcessName : \"Program\" and winlog.event_data.NewProcessName : \"Files\")","filters":[],"actions":[]}
{"id":"58de63f7-c52e-4209-bb32-b9e6a91bcfb8","updated_at":"2025-04-09T02:52:37.372Z","updated_by":"purple1","created_at":"2025-04-09T02:14:22.710Z","created_by":"purple1","name":"UC050 : Add/Modify System Service","tags":["product: windows","service: security","service: system"],"interval":"5m","enabled":true,"revision":1,"description":"Detected when an attacker tries to create or change services on windows.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"61d75695-bbcc-4236-bff3-a0b1f29f3c57","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n      event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\sc.exe\" and winlog.event_data.CommandLine in (\"* config *\", \"* create *\", \"* start *\", \"* stop *\", \"* delete *\")\n      or event.code : \"4688\" and winlog.event_data.NewProcessName in (\"*\\\\net.exe\", \"*\\\\net1.exe\") and winlog.event_data.CommandLine : \"* stop *\"\n      or event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\taskkill.exe\"\n      or event.code : \"4697\"\n      or event.code : \"7045\"\n)","filters":[],"actions":[]}
{"id":"b131a613-af77-47a1-bc90-c05154b76780","updated_at":"2025-04-09T10:43:28.174Z","updated_by":"purple1","created_at":"2025-04-09T10:43:28.174Z","created_by":"purple1","name":"UC145 : Brute Force","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"3ba438ea-51ac-4452-b123-49868206faac","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1110","name":"Brute Force","reference":"https://attack.mitre.org/techniques/T1110","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1087","name":"Account Discovery","reference":"https://attack.mitre.org/techniques/T1087","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1110.002/T1110.002.md","https://www.ncsc.gov.uk/alerts/hostile-state-actors-compromising-uk-organisations-focus-engineering-and-industrial-control","https://attack.mitre.org/software/S0488/","https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1110.001/T1110.001.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n      winlog.event_data.NewProcessName in (\"*\\\\hashcat.exe\", \"*\\\\crackmapexec.exe\", \"*\\\\kerbrute.exe\")\n      or winlog.event_data.NewProcessName : \"*\\\\kerbrute.exe\" and winlog.event_data.CommandLine : \"* passwordspray  *\" \n      or winlog.event_data.CommandLine : \"* -l *\" and winlog.event_data.CommandLine : \"* -p*\" and winlog.event_data.CommandLine in (\"* ^USER^ *\", \"* ^PASS^ *\")\n      or winlog.event_data.CommandLine : \"* bruteforce *\" and winlog.event_data.CommandLine : \"* --dc*\"\n    )","filters":[],"actions":[]}
{"id":"ec70b899-2f7d-4cdf-9614-29a9e0fe93a6","updated_at":"2025-04-09T03:04:44.542Z","updated_by":"purple1","created_at":"2025-04-09T03:04:44.542Z","created_by":"purple1","name":"UC056 : Data Staging","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attackers trying to centralize all data before stealing","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"62129015-016f-46e7-a627-18376b04b92b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0009","name":"Collection","reference":"https://attack.mitre.org/tactics/TA0009"},"technique":[{"id":"T1074","name":"Data Staged","reference":"https://attack.mitre.org/techniques/T1074","subtechnique":[{"id":"T1074.001","name":"Local Data Staging","reference":"https://attack.mitre.org/techniques/T1074/001"}]},{"id":"T1560","name":"Archive Collected Data","reference":"https://attack.mitre.org/techniques/T1560","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1566","name":"Phishing","reference":"https://attack.mitre.org/techniques/T1566","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0040","name":"Impact","reference":"https://attack.mitre.org/tactics/TA0040"},"technique":[{"id":"T1485","name":"Data Destruction","reference":"https://attack.mitre.org/techniques/T1485","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1074.001/T1074.001.md","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1560.001/T1560.001.md","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1560/T1560.md","https://twitter.com/1ZRR4H/status/1534259727059787783","https://app.any.run/tasks/e1fe6a62-bce8-4323-a49a-63795d9afd5d/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (\n      event.code : \"4688\" and winlog.event_data.NewProcessName in (\"*\\\\xcopy.exe\", \"*\\\\robocopy.exe\", \"*\\\\winrar.exe\", \"*\\\\rar.exe\", \"*\\\\winzip64.exe\", \"*\\\\7zip.exe\", \"*\\\\7z.exe\", \"*\\\\7zFM.exe\",  \"*\\\\peazip.exe\") \n      or winlog.event_data.CommandLine in (\"* .zip\\\\ *\")\n    )","filters":[],"actions":[]}
{"id":"2f5ce4e7-f1b2-4b04-9fe3-5fa54193fc04","updated_at":"2025-04-10T07:06:36.337Z","updated_by":"purple1","created_at":"2025-02-27T10:30:24.245Z","created_by":"elastic","name":"UC229 : Possible MOVEit Transfer Exploitation Indicator [MOVEit Transfer 0Day] (via file_event)","tags":["product: windows","category: file_event"],"interval":"5m","enabled":true,"revision":1,"description":"It detects the generation of a fresh Active Server Page Extended file within the MOVEit Transfer directory. This could potentially serve as an indication of exploiting a previously unknown vulnerability in MOVEit Transfer.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":["- Legitimate Active Server Page Extended file creation. Requires further investigation."],"from":"now-360s","rule_id":"c1198229-7d6d-47f4-a133-c0b6b3164a39","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1190","name":"Exploit Public-Facing Application","reference":"https://attack.mitre.org/techniques/T1190","subtechnique":[]}]}],"to":"now","references":["https://www.sentinelone.com/blog/moveit-transfer-exploited-to-drop-file-stealing-sql-shell/","https://nvd.nist.gov/vuln/detail/CVE-2023-34362","https://www.huntress.com/blog/moveit-transfer-critical-vulnerability-rapid-response","https://www.greynoise.io/blog/progress-moveit-transfer-critical-vulnerability","https://www.cisa.gov/news-events/alerts/2023/06/01/progress-software-releases-security-advisory-moveit-transfer","https://www.trustedsec.com/blog/critical-vulnerability-in-progress-moveit-transfer-technical-analysis-and-recommendations/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and (\n      winlog.event_data.TargetFilename : \"*Windows*\" and winlog.event_data.TargetFilename : \"*Temp*\" and winlog.event_data.TargetFilename : \"*royq2cir*\" \n      or\n      winlog.event_data.TargetFilename : \"*MOVEitTransfer*\" and winlog.event_data.TargetFilename : \"*Transfer*\" and winlog.event_data.TargetFilename : \"*wwwroot*\" \n    and winlog.event_data.TargetFilename in (\"*.asp\", \"*.ashx\", \"*.aspx\", \"*.ps1\", \"*.exe\", \"*.dll\", \"*.0.cs\", \"*.tmp\", \"*.dll\", \"*.cmdline\", \"*.out\", \"*.err\"))","filters":[],"actions":[]}
{"id":"c66890e2-47f0-4be9-a8a5-ad268a1d609e","updated_at":"2025-04-10T07:57:47.195Z","updated_by":"purple1","created_at":"2025-02-27T10:30:28.259Z","created_by":"elastic","name":"UC235 : Detects scheduled task creation events that include suspicious actions","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"No description","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":["- Software installation"],"from":"now-360s","rule_id":"c29d8ebd-4fd2-4beb-b4d4-c3f89781684f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1053","name":"Scheduled Task/Job","reference":"https://attack.mitre.org/techniques/T1053","subtechnique":[{"id":"T1053.005","name":"Scheduled Task","reference":"https://attack.mitre.org/techniques/T1053/005"}]}]}],"to":"now","references":["https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbyte"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\schtasks.exe*\" and winlog.event_data.OriginalFileName : \"*\\\\schtasks.exe*\" and winlog.event_data.CommandLine in (\"*  *\", \"* vbscript *\", \"* cscript *\", \"* wmic *\", \"* wmic.exe *\", \"* regsvr32.exe*\", \"* powershell *\", \"* \\\\AppData\\\\ *\")","filters":[],"actions":[]}
{"id":"294e8575-90d0-4827-bb8f-20d0160d8a45","updated_at":"2025-02-27T10:31:53.821Z","updated_by":"elastic","created_at":"2025-02-27T10:31:53.821Z","created_by":"elastic","name":"UC336 : LokiBot Trojan behavior","tags":["product: windows","service: sysmon"],"interval":"5m","enabled":true,"revision":0,"description":"LokiBot Trojan behavior","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2e09d4eb-c396-429b-933b-ce16baf9ef6a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.threatfabric.com/blogs/lokibot_the_first_hybrid_android_malware.html","https://exchange.xforce.ibmcloud.com/botnet/lokibot","https://malwarebreakdown.com/2018/04/01/malspam-delivers-loki-bot/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n        (\n            event.code : \"1\" \n            and \n            (\n                winlog.event_data.CommandLine : \"*GET /bobby/*\" \n                or winlog.event_data.CommandLine : \"*POST /bobby/Panel/*\"\n            )\n        )\n        or\n        (\n            event.code : \"1\"\n            and\n            (\n                winlog.event_data.Hashes : \"3C4BE617FDA78DA05B38F4EE52121E99\"\n                or winlog.event_data.Hashes : \"7FB5A88768D7ECE242DBD4B30EDEFF0C\"\n                or winlog.event_data.Hashes : \"14A4DFFE0105A7DEF2A1EFF32899A9AC\"\n                or winlog.event_data.Hashes : \"E69245E9685CB204105E69C424F304CC\"\n                or winlog.event_data.Hashes : \"75CCD03BB4934490A9F599A15381F43D\"\n                or winlog.event_data.Hashes : \"68BEFE15006189CE8215371935F8E720\"\n                or winlog.event_data.Hashes : \"05869152534B238D25051F7718FDB382\"\n                or winlog.event_data.Hashes : \"3DFA31D85482009479FEAFD5AF7E818A\"\n                or winlog.event_data.Hashes : \"f9b5535bffd5c0525cb1e59bf79f06d925448b12f106fe1e972473fab4f082fa\"\n                or winlog.event_data.Hashes : \"4bf2658e0f69865c977cabd24b8dccca38ffc09a17b3367e5f702d2993cf00f7\"\n                or winlog.event_data.Hashes : \"ed5550d3047903d3e09363f90b6d49f519d1484af4e528fd95f1e5f3e5a008b2\"\n                or winlog.event_data.Hashes : \"5b1b12f580dcc0219e88887cbe5af7f2\"\n                or winlog.event_data.Hashes : \"51c86d4fe87f490e4da5e8035645e548\"\n                or winlog.event_data.Hashes : \"c94d4d0a893a786d51e4acbb66c3cd29\"\n                or winlog.event_data.Hashes : \"007b3818d95f328376d73f3714c49154\"\n                or winlog.event_data.Hashes : \"D3E758016C147B5035E20D22E6888E6F\"\n                or winlog.event_data.Hashes : \"09ef7c56d36365fd24d45660c3246a0a\"\n                or winlog.event_data.Hashes : \"42844D8957C46DD47EFFEC1C54273EFC\"\n                or winlog.event_data.Hashes : \"D4BBE7685E53F6B788F65268BEA485C3\"\n                or winlog.event_data.Hashes : \"B18F0AD651B48B3DEC184B4F95BFCAE3\"\n            )\n        )\n        or\n        (\n            event.code : \"1\"\n            and\n            winlog.event_data.TargetObject : \"*F63AAA*\"\n        )\n    )","filters":[],"actions":[]}
{"id":"26e7d227-48cd-4fc6-9eef-0cc00e7ca74c","updated_at":"2025-04-15T03:36:41.397Z","updated_by":"purple1","created_at":"2025-04-15T03:36:41.397Z","created_by":"purple1","name":"UC310 : Possible LockBit Ransomware Persistence by Adding Registry Key to Implement UAC Bypass (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"This rule detects suspicious LockBit ransomware activity by adding a registry key through .hwy value to implement a UAC bypass.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"72bdb30b-89fe-4e13-9d87-34151a0bd0ca","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[]}],"to":"now","references":["https://www.fortinet.com/blog/threat-research/emerging-lockbit-campaign"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and winlog.event_data.NewProcessName : \"*\\\\reg.exe\" and winlog.event_data.CommandLine : \"* add *\"  and winlog.event_data.CommandLine : \"* \\\\SOFTWARE\\\\Microsoft\\\\Classes\\\\ms-setting\\\\CurVer *\" and winlog.event_data.CommandLine : \"* .hwy *\"","filters":[],"actions":[]}
{"id":"fbe25394-7f65-4893-9f52-99a1f322ba65","updated_at":"2025-04-10T07:54:15.138Z","updated_by":"purple1","created_at":"2025-04-10T07:54:15.138Z","created_by":"purple1","name":"UC234 : Windows Discovery Software","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attackers spy on security applications/software on windows.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"03e730fc-ddab-44ee-bf08-c8fd33c3d370","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1010","name":"Application Window Discovery","reference":"https://attack.mitre.org/techniques/T1010","subtechnique":[]},{"id":"T1580","name":"Cloud Infrastructure Discovery","reference":"https://attack.mitre.org/techniques/T1580","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518.001/T1518.001.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and \n    (winlog.event_data.NewProcessName : \"*\\\\wmic.exe\" and winlog.event_data.CommandLine in (\"* path AntiVirusProduct *\", \"* path FirewallProduct *\", \"* qfe *\")\n    or winlog.event_data.NewProcessName : \"*\\\\netsh.exe\" and winlog.event_data.CommandLine : \"* advfirewall show *\"\n    or winlog.event_data.NewProcessName : \"*\\\\findstr.exe\" and winlog.event_data.CommandLine in (\"* /i virus *\", \"* /i cb *\", \"* /i defender *\", \"* /i cylance *\")\n    or winlog.event_data.ScriptBlockText : \"* get-process *\" and winlog.event_data.ScriptBlockText : \"* .Description *\" and winlog.event_data.ScriptBlockText : \"* -like *\" and winlog.event_data.ScriptBlockText in (\"* virus *\", \"* carbonblack *\", \"* defender *\", \"* cylance *\")\n    )","filters":[],"actions":[]}
{"id":"32d488e2-cf82-4934-890a-c55c14c2406b","updated_at":"2025-04-10T08:02:25.271Z","updated_by":"purple1","created_at":"2025-04-10T08:02:25.271Z","created_by":"purple1","name":"UC236 : Suspicious Java Child Process (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"This rule identifies potentially malicious child processes spawned by Java-based malware. This may indicate an attempt by the malware to perform malicious actions such as downloading additional payloads, stealing sensitive information, or establishing persistence. The reliance on the surrounding environment may necessitate the implementation of additional filtering measures to prevent false positives.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"30ac7865-9657-4b16-9ea0-b92d5750a475","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1190","name":"Exploit Public-Facing Application","reference":"https://attack.mitre.org/techniques/T1190","subtechnique":[]}]}],"to":"now","references":["https://badoption.eu/blog/2023/06/01/zipjar.html#poc","https://www.mandiant.com/resources/blog/unc961-multiverse-financially-motivated","https://app.any.run/tasks/5f279c68-8ec2-4f27-9f79-1cfa2d99c631/","https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html","https://securitylabs.datadoghq.com/articles/openssl-november-1-vulnerabilities/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.ParentProcessName : \"*\\\\java.exe*\" \n    and winlog.event_data.NewProcessName in (\"*\\\\appvlp.exe\", \"*\\\\atbroker.exe\", \"*\\\\bash.exe\", \"*\\\\bginfo.exe\", \"*\\\\bitsadmin.exe\", \"*\\\\cmd.exe\", \"*\\\\certutil.exe\", \"*\\\\devtoolslauncher.exe\", \"*\\\\ftp.exe\", \"*\\\\hh.exe\", \"*\\\\ieexec.exe\", \"*\\\\installutil.exe\", \"*\\\\jjs.exe\", \"*\\\\mavinject.exe\", \"*\\\\microsoft.workflow.compiler.exe\", \"*\\\\msbuild.exe\", \"*\\\\msdt.exe\", \"*\\\\mshta.exe\", \"*\\\\msxsl.exe\", \"*\\\\odbcconf.exe\", \"*\\\\powershell.exe\", \"*\\\\presentationhost.exe\", \"*\\\\regasm.exe\", \"*\\\\regsvcs.exe\", \"*\\\\regsvr32.exe\", \"*\\\\rundll32.exe\", \"*\\\\runscripthelper.exe\", \"*\\\\schtasks.exe\", \"*\\\\sqlps.exe\", \"*\\\\sqltoolsps.exe\", \"*\\\\syncappvpublishingserver.exe\", \"*\\\\tracker.exe\", \"*\\\\verclsid.exe\", \"*\\\\vsjitdebugger.exe\", \"*\\\\wmic.exe\", \"*\\\\wsl.exe\") ","filters":[],"actions":[]}
{"id":"a020e22e-de6a-4fba-aa06-90baae00633b","updated_at":"2025-04-09T02:23:21.851Z","updated_by":"purple1","created_at":"2025-04-09T02:23:21.851Z","created_by":"purple1","name":"UC051 : Disable Windows Event Log","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detected when attacker disables default windows event log service on windows.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"bc67ae4e-9bd3-450e-9530-20a1c95252b6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.002/T1562.002.md","https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4719"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n      event.code : \"4719\" and winlog.event_data.CommandLine : \"* System audit policy was changed *\"\n      or event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\auditpol.exe\" and winlog.event_data.CommandLine in (\"* clear *\", \"* /remove /allusers *\")\n      or event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\auditpol.exe\" and winlog.event_data.CommandLine in (\"* /set /category: *\", \"* /success: *\", \"* /failure: *\")\n      or event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\appcmd.exe\" and winlog.event_data.CommandLine in (\"* set config *\", \"* /dontLog:true *\")\n      or event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\wevtutil.exe\" and winlog.event_data.CommandLine in (\"* sl *\", \"* /e:false *\")\n      or event.code : \"1104\"\n    )","filters":[],"actions":[]}
{"id":"958cacb7-447e-4aa7-9b7b-bba3b7d38728","updated_at":"2025-04-09T09:18:24.762Z","updated_by":"purple1","created_at":"2025-04-09T09:18:24.762Z","created_by":"purple1","name":"UC091 : Shutdown/Reboot","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems.\nreferences:","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"42fdd575-bdc4-4273-bc46-1631f1be668a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0040","name":"Impact","reference":"https://attack.mitre.org/tactics/TA0040"},"technique":[{"id":"T1529","name":"System Shutdown/Reboot","reference":"https://attack.mitre.org/techniques/T1529","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1529/T1529.md#atomic-test-1---shutdown-system---windows"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \nand (winlog.event_data.CommandLine : \"* shutdown *\" and winlog.event_data.CommandLine : \"* /s *\"\n      or winlog.event_data.CommandLine : \"* shutdown *\" and winlog.event_data.CommandLine : \"* /r *\"\n      or event.code : \"1074\")","filters":[],"actions":[]}
{"id":"2a1312bc-0ca5-4d5a-8d7c-1071517908d0","updated_at":"2025-04-16T03:22:25.998Z","updated_by":"purple1","created_at":"2025-02-25T04:12:12.690Z","created_by":"elastic","name":"UC354 : PUA - Rclone Execution","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects execution of RClone utility for exfiltration as used by various ransomwares strains like REvil, Conti, FiveHands, etc\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"244164c5-c87f-40a1-98b5-3d0a60f682b4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010"},"technique":[{"id":"T1567","name":"Exfiltration Over Web Service","reference":"https://attack.mitre.org/techniques/T1567","subtechnique":[{"id":"T1567.002","name":"Exfiltration to Cloud Storage","reference":"https://attack.mitre.org/techniques/T1567/002"}]}]}],"to":"now","references":["https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/","https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware","https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a","https://labs.sentinelone.com/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone","https://www.splunk.com/en_us/blog/security/darkside-ransomware-splunk-threat-update-and-detections.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"  any where host.os.type : \"windows\" and(\n    winlog.event_data.CommandLine : \"* --config *\" and  winlog.event_data.CommandLine : \"* --no-check-certificate *\" and  winlog.event_data.CommandLine : \"* copy *\"\n    or winlog.event_data.NewProcessName: \"*\\\\rclone.exe\" and winlog.event_data.Description : \"Rsync for cloud storage\" and winlog.event_data.CommandLine in (\"* pass *\", \"* user *\", \"* copy *\", \"* sync *\", \"* config *\", \"* lsd *\", \"* remote *\", \"* ls *\", \"* mega *\", \"* pcloud *\", \"* ftp *\", \"* ignore-existing *\", \"* auto-confirm *\", \"* transfers *\", \"* multi-thread-streams *\", \"* no-check-certificate *\"))","filters":[],"actions":[]}
{"id":"671e9887-248b-481a-ac87-3d6695b81f2a","updated_at":"2025-04-10T02:48:55.128Z","updated_by":"purple1","created_at":"2025-04-10T02:48:55.128Z","created_by":"purple1","name":"UC207 : Possible LocalPotato Execution (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects the execution patterns of the LocalPotato (aka CVE-2023-21746) attack tool. The LocalPotato attack is a type of NTLM reflection attack that targets local authentication. This attack allows for arbitrary file read/write and elevation of privilege.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"cf352d2a-fb27-4834-908f-dc0fb4f36796","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068","subtechnique":[]}]}],"to":"now","references":["https://github.com/decoder-it/LocalPotato","https://www.localpotato.com/localpotato_html/LocalPotato.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (winlog.event_data.CommandLine : \"* -i *\" and winlog.event_data.CommandLine : \"* -o *\" and winlog.event_data.CommandLine : \"* Windows *\" and winlog.event_data.CommandLine : \"* System32 *\" and winlog.event_data.CommandLine : \"* .dll *\"\n    or winlog.event_data.CommandLine in (\"* 90F18417-F0F1-484E-9D3C-59DCEEE5DBD8 *\", \"* 854A20FB-2D44-457D-992F-EF13785D2B51 *\", \"* A9819296-E5B3-4E67-8226-5E72CE9E1FB7 *\"))","filters":[],"actions":[]}
{"id":"35384d6b-b449-4371-9bbe-d26f285047c3","updated_at":"2025-04-08T09:29:15.158Z","updated_by":"purple1","created_at":"2025-04-08T09:29:15.158Z","created_by":"purple1","name":"UC042 : Windows Discovery Accounts","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attackers spy on information about accounts and groups on windows, including password policies.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"c0443257-1ed8-47f4-8c5b-fd0798ef9218","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1087.002/T1087.002.md","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1087.001/T1087.001.md","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1201/T1201.md#atomic-test-5---examine-local-password-policy---windows"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n      winlog.event_data.NewProcessName in (\"*\\\\klist.exe\", \"*\\\\quser.exe\", \"*\\\\query.exe\", \"*\\\\cmdkey.exe\", \"*\\\\qwinsta.exe\") \n      or winlog.event_data.NewProcessName in (\"*\\\\net.exe\", \"*\\\\net1.exe\") and winlog.event_data.CommandLine in (\"* group *\", \"* user *\", \"* accounts *\", \"* localgroup *\")\n      or winlog.event_data.NewProcessName : \"*\\\\wmic.exe\" and winlog.event_data.CommandLine : \"* useraccount *\"\n      or winlog.event_data.NewProcessName : \"*\\\\whoami.exe\" \n    )","filters":[],"actions":[]}
{"id":"535495e4-5786-45d3-a773-46a39a3adf22","updated_at":"2025-03-25T02:37:50.378Z","updated_by":"elastic","created_at":"2025-03-25T02:37:50.378Z","created_by":"elastic","name":"UC417 : Possible CVE-2024-12084 Rsync Heap Overflow Exploitation","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects the execution of a shell as sub process of \"rsync\" without the expected command line flag \"-e\" being used, which could be an indication of exploitation as described in CVE-2024-12084. This behavior is commonly associated with attempts to execute arbitrary commands or escalate privileges, potentially leading to unauthorized access or further exploitation.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"1be8fd9e-1c6b-4617-9d7f-38da8a309dd6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://sysdig.com/blog/detecting-and-mitigating-cve-2024-12084-rsync-remote-code-execution/","https://gist.github.com/Neo23x0/a20436375a1e26524931dd8ea1a3af10"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":" sequence\n    [any where host.os.type : \"linux\" and event.action : \"syscall\" and process.name : \"rsync\"]\n    [any where host.os.type : \"linux\" and event.action : \"execve\" and process.executable : (\"*ash\", \"*bash\", \"*csh\", \"*dash\", \"*ksh\", \"*sh\", \"*tcsh\", \"*zsh\")]","filters":[],"actions":[]}
{"id":"c4658a3c-579c-49d8-9ab0-8637711ff970","updated_at":"2025-02-27T10:30:50.448Z","updated_by":"elastic","created_at":"2025-02-27T10:30:50.448Z","created_by":"elastic","name":"UC270 : Detect Hack Tool Used To Steal Credentials Of Remote Desktop Manager Application (via powershell)","tags":["category: ps_script","product: windows"],"interval":"5m","enabled":true,"revision":0,"description":"DecryptRDPManager.exe is a hacktool used to decrypt the remote desktop manager's credentials. You can detect it with this rule.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"3f3760f2-abb6-4602-9e04-b3a64ce53703","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1204","name":"User Execution","reference":"https://attack.mitre.org/techniques/T1204","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1528","name":"Steal Application Access Token","reference":"https://attack.mitre.org/techniques/T1528","subtechnique":[]}]}],"to":"now","references":["https://github.com/mez-0/DecryptRDCManager"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (\n        winlog.event_data.ScriptBlockText : \"*DecryptRDCManager.exe*\"\n    )","filters":[],"actions":[]}
{"id":"71eddbe8-4902-4812-891c-8c13a92c9dbe","updated_at":"2025-04-16T10:02:36.603Z","updated_by":"purple1","created_at":"2025-02-25T04:09:51.435Z","created_by":"elastic","name":"UC380 : Possible Admin Account or Group Enumeration (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may attempt to get a listing/permissions and other info of local system or domain accounts. The reliance on the surrounding environment may necessitate the implementation of additional filtering measures to prevent false positives.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"1b9e6fbf-af01-4459-bc9f-9aebb246707d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1087","name":"Account Discovery","reference":"https://attack.mitre.org/techniques/T1087","subtechnique":[{"id":"T1087.001","name":"Local Account","reference":"https://attack.mitre.org/techniques/T1087/001"},{"id":"T1087.002","name":"Domain Account","reference":"https://attack.mitre.org/techniques/T1087/002"}]},{"id":"T1033","name":"System Owner/User Discovery","reference":"https://attack.mitre.org/techniques/T1033","subtechnique":[]}]}],"to":"now","references":["https://blog.talosintelligence.com/lazarus_new_rats_dlang_and_telegram/","https://www.infosecurity-magazine.com/news/signature-techniques-of-asian-apt/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and (winlog.event_data.NewProcessName in (\"*\\\\chcp.com\", \"*\\\\whoami.exe\", \"*\\\\wmic.exe\", \"*\\\\net.exe\", \"*\\\\net1.exe\", \"*\\\\dsquery.exe\") and winlog.event_data.CommandLine in (\"* 2>&1 *\" , \"* //all *\", \"* -all *\", \"* //upn *\", \"* //fqdn *\", \"* useraccount *\", \"* user *\", \"* group *\", \"* accounts *\", \"* localgroup *\", \"* domain *\", \"* //priv *\", \"* ds_user *\", \"* ds_group *\", \"* ds_computer *\", \"* //dom *\", \"* //add *\", \"* //active *\", \"* //expires *\", \"* //passwordreq *\", \"* //scriptpath *\", \"* //times *\", \"* //workstations *\")\n  or winlog.event_data.CommandLine in (\"* Get-LocalGroup *\", \"* Get-LocalGroupMember *\", \"* Get-LocalUser *\", \"* Microsoft.ActiveDirectory.Management.dll *\") \n  or winlog.event_data.NewProcessName in (\"*\\\\quser.exe\", \"*\\\\qwinsta.exe\", \"*\\\\ldifde.exe\", \"*\\\\'csvde.exe\", \"*\\\\whoami.exe\", \"*\\\\klist.exe\"))\n  and not winlog.event_data.ParentProcessName in (\"*\\\\thor\\\\thor64.exe  *\" , \"*\\\\amazon-ssm-agent.exe\" , \"*\\\\PrinterLogicIdpAuthentication.exe\" , \"*\\\\AwWindowsIpc.exe\" , \"*\\\\EikonBoxNet.exe\" , \"*\\\\TaxBack.exe\" , \"*\\\\MonitoringHost.exe\" , \"*\\\\ssm-agent-worker.exe\" , \"*\\\\32\\\\svchost.exe\" )","filters":[],"actions":[]}
{"id":"96e3b778-7f83-4386-8c35-517777898ef8","updated_at":"2025-04-09T02:51:44.349Z","updated_by":"purple1","created_at":"2025-04-09T02:51:44.349Z","created_by":"purple1","name":"UC054 : Disable/Modify System Firewall Config","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected that an attacker has performed disabling, or changing, the system firewall configuration.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"51ac1d30-2f08-4181-9cda-ce36923aa413","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[{"id":"T1562.001","name":"Disable or Modify Tools","reference":"https://attack.mitre.org/techniques/T1562/001"},{"id":"T1562.004","name":"Disable or Modify System Firewall","reference":"https://attack.mitre.org/techniques/T1562/004"}]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.004/T1562.004.md","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.001/T1562.001.md#atomic-test-19---remove-windows-defender-definition-files"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and (winlog.event_data.NewProcessName : \"*\\netsh.exe\" and winlog.event_data.CommandLine in (\"* advfirewall set currentprofile state off *\",  \"* advfirewall firewall add rule *\")\n    or winlog.event_data.NewProcessName : \"*\\netsh.exe\" and winlog.event_data.CommandLine : \"* -RemoveDefinitions*\")","filters":[],"actions":[]}
{"id":"cc7819b0-91de-4e6a-8c57-35b8e2ea82b4","updated_at":"2025-04-10T08:10:02.391Z","updated_by":"purple1","created_at":"2025-04-10T08:10:02.391Z","created_by":"purple1","name":"UC240 : Potential Ransomware or Unauthorized MBR Tampering Via Bcdedit.EXE","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects potential malicious and unauthorized usage of bcdedit.exe","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"dabb4f24-813d-4d9a-80d3-78a2ec5b3586","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1070","name":"Indicator Removal","reference":"https://attack.mitre.org/techniques/T1070","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1542","name":"Pre-OS Boot","reference":"https://attack.mitre.org/techniques/T1542","subtechnique":[{"id":"T1542.003","name":"Bootkit","reference":"https://attack.mitre.org/techniques/T1542/003"}]}]}],"to":"now","references":["https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/bcdedit--set","https://twitter.com/malwrhunterteam/status/1372536434125512712/photo/2"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and ((winlog.event_data.NewProcessName : \"*\\\\bcdedit.exe\" and winlog.event_data.OriginalFileName : \"bcdedit.exe\")\n    or  winlog.event_data.CommandLine in (\"* delete *\", \"* deletevalue *\", \"* import *\", \"* safeboot *\", \"* network *\"))","filters":[],"actions":[]}
{"id":"26e7a353-e9af-4ace-85a6-037499f09e41","updated_at":"2025-04-09T02:02:21.532Z","updated_by":"purple1","created_at":"2025-04-09T02:02:21.532Z","created_by":"purple1","name":"UC049 : Windows Discovery System Time","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attackers who spy on timzone information on windows systems.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"092f1cd5-76db-44e0-9334-1b4da4c2a451","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1124","name":"System Time Discovery","reference":"https://attack.mitre.org/techniques/T1124","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1124/T1124.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and winlog.event_data.NewProcessName in (\"*\\\\net.exe\", \"*\\\\net1.exe\") and winlog.event_data.CommandLine : \"* time *\" and  winlog.event_data.NewProcessName : \"*\\\\w32tm.exe\"","filters":[],"actions":[]}
{"id":"bde702b3-fa9c-4851-8cbf-a69dd898b56d","updated_at":"2025-04-16T02:20:03.939Z","updated_by":"purple1","created_at":"2025-02-27T10:32:01.882Z","created_by":"elastic","name":"UC344 : Suspicious LOLBAS MSHTA Defense Evasion Behavior by Detection of Associated Commands (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects use of mshta as a living off the land technique.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"abab7707-7e3d-4d9f-be13-2c790c613293","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":["https://asec.ahnlab.com/ko/62771/","https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-060a","https://cert.gov.ua/article/6276988"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and winlog.event_data.NewProcessName : \"*\\\\mshta.exe\" and winlog.event_data.CommandLine : \"* .hta\" and winlog.event_data.CommandLine in (\"* \\\\ *\", \"* vbscript *\", \"* javascript *\", \"* http *\", \"* close *\", \"* DavWWWRoot *\")","filters":[],"actions":[]}
{"id":"47561d21-3987-4fd1-9405-ac7e6d7051c0","updated_at":"2025-04-09T07:27:27.941Z","updated_by":"purple1","created_at":"2025-04-09T07:27:27.941Z","created_by":"purple1","name":"UC079 : Modify An AD Security-Enabled Global Group","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Modify an AD security-enabled global group.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"bb11ae51-d633-443d-86ff-5c59311df261","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code in (\"4728\", \"4729\", \"4730\", \"4737\")","filters":[],"actions":[]}
{"id":"a4bdc147-0c05-49cd-9f2d-1f634441f230","updated_at":"2025-04-09T11:05:57.543Z","updated_by":"purple1","created_at":"2025-04-09T11:05:57.543Z","created_by":"purple1","name":"UC177 : LLMNR/NBT-NS Poisoning and SMB Relay","tags":["product: windows","category: ps_script"],"interval":"5m","enabled":true,"revision":0,"description":"By responding to LLMNR/NBT-NS network traffic, adversaries may spoof an authoritative source for name resolution to force communication with an adversary controlled system. This activity may be used to collect or relay authentication materials.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"7d44765b-5671-47dd-b2b1-eb760aab59bb","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0009","name":"Collection","reference":"https://attack.mitre.org/tactics/TA0009"},"technique":[]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and (\n      event.code : \"4688\" and winlog.event_data.ScriptBlockText : \"* inveigh *\"\n      or event.code : \"4104\" and winlog.event_data.ScriptBlockText : \"* inveigh *\")","filters":[],"actions":[]}
{"id":"9c491a46-21c9-4c7d-a635-188473a8ae86","updated_at":"2025-02-21T03:25:36.562Z","updated_by":"purple1","created_at":"2025-02-21T03:25:36.562Z","created_by":"purple1","name":"UC180 : Suspicious Ddexec Privilege Escalation By Usage For Execution In Memory","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Attackers can utilize shell scripting with ddexec to hijack process memory in order to execute other programs without touching disk","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"c837314f-2eea-4eb0-aba9-7262a3caa3c6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1055","name":"Process Injection","reference":"https://attack.mitre.org/techniques/T1055","subtechnique":[{"id":"T1055.009","name":"Proc Memory","reference":"https://attack.mitre.org/techniques/T1055/009"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.004","name":"Unix Shell","reference":"https://attack.mitre.org/techniques/T1059/004"}]}]}],"to":"now","references":["https://github.com/arget13/DDexec"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and \n  (\n    winlog.event_data.CommandLine : \"*base64*\"\n    or winlog.event_data.TargetFilename : \"*.b64*\"\n  )\n  and \n  (\n    winlog.event_data.CommandLine : \"*bash*\"\n    or winlog.event_data.TargetFilename : \"*zsh*\"\n    or winlog.event_data.TargetFilename : \"*ash*\"\n  )\n  and \n  (\n    winlog.event_data.CommandLine : \"*//bin//*\"\n    and winlog.event_data.TargetFilename : \"*ddexec*\"\n  )","filters":[],"actions":[]}
{"id":"c8ff7550-d0de-491e-80e0-1b3422799857","updated_at":"2025-02-27T10:30:38.354Z","updated_by":"elastic","created_at":"2025-02-27T10:30:38.354Z","created_by":"elastic","name":"UC247 : Potential SAM Database Dump","tags":["product: windows","category: file_event"],"interval":"5m","enabled":true,"revision":0,"description":"Detects the creation of files that look like exports of the local SAM (Security Account Manager)","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"da56b021-dbb5-40a6-aa6f-9c23fe718fff","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.002","name":"Security Account Manager","reference":"https://attack.mitre.org/techniques/T1003/002"}]}]}],"to":"now","references":["https://github.com/search?q=CVE-2021-36934","https://www.google.com/search?q=%22reg.exe+save%22+sam","https://github.com/cube0x0/CVE-2021-36934","https://github.com/HuskyHacks/ShadowSteal","https://github.com/FireFart/hivenightmare"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (\n        winlog.event_data.TargetFilename : \"*\\\\Temp\\\\sam\"\n        or winlog.event_data.TargetFilename : \"*\\\\sam.sav\"\n        or winlog.event_data.TargetFilename : \"*\\\\Intel\\\\sam\"\n        or winlog.event_data.TargetFilename : \"*\\\\sam.hive\"\n        or winlog.event_data.TargetFilename : \"*\\\\Perflogs\\\\sam\"\n        or winlog.event_data.TargetFilename : \"*\\\\ProgramData\\\\sam\"\n        or winlog.event_data.TargetFilename : \"*\\\\Users\\\\Public\\\\sam\"\n        or winlog.event_data.TargetFilename : \"*\\\\AppData\\\\Local\\\\sam\"\n        or winlog.event_data.TargetFilename : \"*\\\\AppData\\\\Roaming\\\\sam\"\n        or winlog.event_data.TargetFilename : \"*_ShadowSteal.zip\"       \n        or winlog.event_data.TargetFilename : \"*\\\\Documents\\\\SAM.export\"  \n        or winlog.event_data.TargetFilename : \"*:\\\\sam\"\n        or winlog.event_data.TargetFilename : \"*\\\\hive_sam_*\"            \n        or winlog.event_data.TargetFilename : \"*\\\\sam.save*\"\n        or winlog.event_data.TargetFilename : \"*\\\\sam.export*\"\n        or winlog.event_data.TargetFilename : \"*\\\\~reg_sam.save*\"\n        or winlog.event_data.TargetFilename : \"*\\\\sam_backup*\"\n        or winlog.event_data.TargetFilename : \"*\\\\sam.bck*\"\n        or winlog.event_data.TargetFilename : \"*\\\\sam.backup*\"\n    )","filters":[],"actions":[]}
{"id":"7ed48b5a-f5b1-417a-a078-e977ea88ea95","updated_at":"2025-04-08T08:57:24.506Z","updated_by":"purple1","created_at":"2025-04-08T08:57:24.506Z","created_by":"purple1","name":"UC039 : Windows Discovery System Network Configuration","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attackers spy on network configuration on windows.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"d6bc6822-8aa6-4602-aed6-7fecfe264a88","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1016","name":"System Network Configuration Discovery","reference":"https://attack.mitre.org/techniques/T1016","subtechnique":[]},{"id":"T1482","name":"Domain Trust Discovery","reference":"https://attack.mitre.org/techniques/T1482","subtechnique":[]}]}],"to":"now","references":["https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731935(v=ws.11)","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1016/T1016.md","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1482/T1482.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n      winlog.event_data.NewProcessName in (\"*\\\\ipconfig.exe\", \"*\\\\arp.exe\", \"*\\\\nbtstat.exe\", \"*\\\\nslookup.exe\", \"*\\\\AdFind.exe\", \"*\\\\dsquery.exe\", \"*\\\\route.exe\")\n      or winlog.event_data.NewProcessName : \"*\\\\ipconfig.exe\" and winlog.event_data.CommandLine in (\"* interface show *\",\"* advfirewall firewall show rule *\")\n      or winlog.event_data.NewProcessName in (\"*\\\\net.exe\", \"*\\\\net1.exe\") and winlog.event_data.CommandLine in (\"* config *\", \"* view *\")\n      or  winlog.event_data.NewProcessName : \"*\\\\ipconfig.exe\" and winlog.event_data.CommandLine in (\"* server *\", \"* dclist: *\", \"* parentdomain *\", \"* domain_trusts *\", \"* trusted_domains *\", \"* user *\")\n    )","filters":[],"actions":[]}
{"id":"c6c8d762-a666-44ea-8137-4bd57af79aa5","updated_at":"2025-04-14T10:27:00.313Z","updated_by":"purple1","created_at":"2025-04-14T10:27:00.313Z","created_by":"purple1","name":"UC297 : Possible Web Server or WebApp Exploitation (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Abnormal child processes associated with the Internet Information Services (IIS) or Apache HTTP Server may indicate the presence of a web shell or a vulnerability being exploited. Examples of this include the ProxyNotShell vulnerabilities CVE-2022-41040 and CVE-2022-41082. The number and behavior of child processes associated with the w3wp or httpd process depend on the logic or architecture of your web application and it may be necessary to implement additional filtering.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"97d3910c-c0b0-4188-b64d-51bb606f7637","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1525","name":"Implant Internal Image","reference":"https://attack.mitre.org/techniques/T1525","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1190","name":"Exploit Public-Facing Application","reference":"https://attack.mitre.org/techniques/T1190","subtechnique":[]}]}],"to":"now","references":["https://unit42.paloaltonetworks.com/threat-brief-moveit-cve-2023-34362/","https://starlabs.sg/blog/2023/04-microsoft-exchange-powershell-remoting-deserialization-leading-to-rce-cve-2023-21707/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.ParentProcessName in (\"*\\\\'w3wp.exe\", \"*\\\\httpd.exe\", \"*\\\\tomcat?.exe\")\n    and not winlog.event_data.NewProcessName in (\"*\\\\csc.exe\", \"*\\\\vbc.exe\", \"*\\\\TranscodingService.exe\", \"*\\\\w3wp.exe\", \"*\\\\httpd.exe\", \"*\\\\inetinfo.exe\", \"*\\\\aspnet_wp.exe\", \"*\\\\:\\\\Windows\\\\System32\\\\conhost.exe\")","filters":[],"actions":[]}
{"id":"20a357f5-9423-4b3f-a041-01ca5d74ba3c","updated_at":"2025-04-10T02:56:32.260Z","updated_by":"purple1","created_at":"2025-04-10T02:54:20.212Z","created_by":"purple1","name":"UC211 : Domain Policy Modification (Group Policy Modification)","tags":["product: windows"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may modify Group Policy Objects (GPOs) to subvert the intended discretionary access controls for a domain, usually with the intention of escalating privileges on the domain.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"503f85b8-85a0-4336-a86e-e7a3d4c9fa1c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\\\\\reg.exe\" and winlog.event_data.CommandLine in (\"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*GroupPolicyRefreshTimeDC *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*GroupPolicyRefreshTimeOffsetDC *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*GroupPolicyRefreshTime *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*GroupPolicyRefreshTimeOffset *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*EnableSmartScreen *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*ShellSmartScreenLevel *\")\n    or event.code : \"4104\" and winlog.event_data.ScriptBlockText in (\"* New-GPOImmediateTask *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*GroupPolicyRefreshTimeDC *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*GroupPolicyRefreshTimeOffsetDC *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*GroupPolicyRefreshTime *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*GroupPolicyRefreshTimeOffset *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*EnableSmartScreen *\", \"* \\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows\\\\System*ShellSmartScreenLevel *\")\nor event.code in (\"5137\",\"5141\")\n    )","filters":[],"actions":[]}
{"id":"744a4556-1f06-4ae4-a306-682d7680f727","updated_at":"2025-04-14T02:54:57.931Z","updated_by":"purple1","created_at":"2025-04-14T02:54:57.931Z","created_by":"purple1","name":"UC277 : Suspicious VSSADMIN Activity (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Volume Shadow Copy allows adversaries to obtain copies of sensitive files such as Ntds.dit or SYSTEM files.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e8eaae7a-c20f-47cc-a00f-953188db98e2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0040","name":"Impact","reference":"https://attack.mitre.org/tactics/TA0040"},"technique":[{"id":"T1490","name":"Inhibit System Recovery","reference":"https://attack.mitre.org/techniques/T1490","subtechnique":[]}]}],"to":"now","references":["https://asec.ahnlab.com/en/58753/","https://posts.specterops.io/domain-of-thrones-part-i-c183ee4bf379","https://www.cisa.gov/news-events/alerts/2023/09/20/fbi-and-cisa-release-advisory-snatch-ransomware"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.NewProcessName : \"*\\\\.exe\" and winlog.event_data.CommandLine : \"* shadow *\"\n    and winlog.event_data.CommandLine in (\"* list *\",\"* create *\",\"* delete *\")\n    and not winlog.event_data.CommandLine : \"* AutoRetry *\"","filters":[],"actions":[]}
{"id":"14c91f03-9155-459d-9b99-eea1083eb3a6","updated_at":"2025-04-17T02:47:20.593Z","updated_by":"purple1","created_at":"2025-02-25T04:06:06.101Z","created_by":"elastic","name":"UC023 : Pass The Ticket Attack","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"The attack technique used in AD targets the kerberos protocol. Use the stolen kerberos ticket to authenticate with the system without the need for an account password.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"b3546a5e-8809-4455-a544-33d1e31aa202","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1550","name":"Use Alternate Authentication Material","reference":"https://attack.mitre.org/techniques/T1550","subtechnique":[{"id":"T1550.003","name":"Pass the Ticket","reference":"https://attack.mitre.org/techniques/T1550/003"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1558","name":"Steal or Forge Kerberos Tickets","reference":"https://attack.mitre.org/techniques/T1558","subtechnique":[{"id":"T1558.003","name":"Kerberoasting","reference":"https://attack.mitre.org/techniques/T1558/003"}]}]}],"to":"now","references":["https://book.hacktricks.xyz/windows/active-directory-methodology/pass-the-ticket","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1550.003/T1550.003.md#atomic-test-1---mimikatz-kerberos-ticket-attack","https://www.harmj0y.net/blog/redteaming/from-kekeo-to-rubeus/","https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and (\n  winlog.event_data.NewProcessName : \"*\\\\mimikatz.exe\" and winlog.event_data.CommandLine in (\"* kerberos::ptt *\", \"* .kirbi *\")\n  or (winlog.event_data.NewProcessName : \"*\\\\Rubeus.exe\"  \n      and winlog.event_data.CommandLine in (\"* asreproast *\", \"* dump //service:krbtgt *\", \"* dump //luid:0x *\", \"* kerberoast *\", \"* createnetonly //program: *\", \"* ptt //ticket: *\", \"* //impersonateuser: *\", \"* renew //ticket: *\", \"* asktgt //user: *\", \"* harvest //interval: *\", \"* s4u //user: *\", \"* s4u //ticket: *\", \"* hash //password: *\", \"* golden //aes256: *\", \"* silver //user: *\")))","filters":[],"actions":[]}
{"id":"4122a3a8-d577-4782-ad1d-76e1107b965b","updated_at":"2025-04-10T07:08:53.386Z","updated_by":"purple1","created_at":"2025-02-27T10:30:20.229Z","created_by":"elastic","name":"UC224 : Suspicious Program Location Process Starts","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":2,"description":"Detects programs running in suspicious files system locations","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"bb4618b7-7b40-47a2-b799-0ec9c28575b0","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1036","name":"Masquerading","reference":"https://attack.mitre.org/techniques/T1036","subtechnique":[]}]}],"to":"now","references":["https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"    any where host.os.type : \"windows\" \n    and\n    (winlog.event_data.Image : \"*\\\\$Recycle.bin\"\n      or winlog.event_data.Image : \"*\\\\Users\\\\Public\\\\*\"\n      or winlog.event_data.Image : \"*\\\\C:\\\\Perflogs\\\\*\"\n      or winlog.event_data.Image : \"*\\\\Windows\\\\Fonts\\\\*\"\n      or winlog.event_data.Image : \"*\\\\Windows\\\\IME\\\\*\"\n      or winlog.event_data.Image : \"*\\\\Windows\\\\addins\\\\*\"\n      or winlog.event_data.Image : \"*\\\\Windows\\\\debug\\\\*\")","filters":[],"actions":[]}
{"id":"244b3031-fb4b-452d-9c5d-ad07519ab6e2","updated_at":"2025-04-14T09:47:12.651Z","updated_by":"purple1","created_at":"2025-02-27T10:31:00.569Z","created_by":"elastic","name":"UC291 : Probable Use of Windows Hacktools [Part1] (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"For example, WinPwn/SharpCollection is a large collection of offensive\n  PowerShell scripts and utilities that are utilized to automate reconnaissance and\n  exploitation of victim machines in penetration testing environments. Attackers may\n  use these scripts for malicious purposes in their operations. Causes of false positives\n  could be due to the use of similar or related tools that have the same command names,\n  or a software that uses the same codebase. This rule has a continuation in the form\n  of Part2,3, etc. like \"Probable Use of Windows Hacktools [PartN]\"\nstatus: stable","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"6c8d5e7d-0c6a-4e0d-b1d9-65382a60bcec","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548","subtechnique":[{"id":"T1548.002","name":"Bypass User Account Control","reference":"https://attack.mitre.org/techniques/T1548/002"}]},{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068","subtechnique":[]},{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1555","name":"Credentials from Password Stores","reference":"https://attack.mitre.org/techniques/T1555","subtechnique":[]},{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[]},{"id":"T1558","name":"Steal or Forge Kerberos Tickets","reference":"https://attack.mitre.org/techniques/T1558","subtechnique":[{"id":"T1558.003","name":"Kerberoasting","reference":"https://attack.mitre.org/techniques/T1558/003"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1087","name":"Account Discovery","reference":"https://attack.mitre.org/techniques/T1087","subtechnique":[]},{"id":"T1135","name":"Network Share Discovery","reference":"https://attack.mitre.org/techniques/T1135","subtechnique":[]},{"id":"T1082","name":"System Information Discovery","reference":"https://attack.mitre.org/techniques/T1082","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0009","name":"Collection","reference":"https://attack.mitre.org/tactics/TA0009"},"technique":[{"id":"T1005","name":"Data from Local System","reference":"https://attack.mitre.org/techniques/T1005","subtechnique":[]}]}],"to":"now","references":["https://posts.specterops.io/domain-of-thrones-part-i-c183ee4bf379","https://asec.ahnlab.com/en/56010/","https://github.com/Flangvik/SharpCollection/tree/master","https://github.com/S3cur3Th1sSh1t/WinPwn/blob/master/WinPwn.ps1"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and winlog.event_data.NewProcessName : \"* \\\\.exe\"\n    and\n    (\n      winlog.event_data.CommandLine in (\"* ProcessHacker *\", \"* netpass64 *\", \"* Dialupass *\", \"* passview *\", \"* KrbRelayUp *\", \"* Kerbrute *\", \"* ADCSPwn *\", \"* ADCollector *\", \"* ADFSDump *\", \"* ADSearch *\", \"* BetterSafetyKatz *\", \"* Certify *\", \"* DeployPrinterNightmare *\", \"* DumpProcess *\", \"* ForgeCert *\", \"* FindLocalAdmin *\", \"* GMSAPasswordReader *\", \"* Group3r *\", \"* Grouper2 *\", \"* Inveigh *\", \"* KrbRelay *\", \"* LockLess *\", \"* PassTheCert *\", \"* PurpleSharp *\", \"* Rubeus *\", \"* SafetyKatz *\", \"* SauronEye *\", \"* SearchOutlook *\", \"* Seatbelt *\", \"* SharPersist *\", \"* Sharp-SMc *\", \"* SharpAllowedToAct *\", \"* SharpAppLocker *\", \"* SharpBypassUAC *\", \"* SharpCOM *\", \"* SharpChisel *\", \"* SharpChrome *\", \"* SharpChromium *\", \"* SharpCloud *\", \"* SharpCookieMonster *\", \"* SharpCrashEventLog *\", \"* SharpDPAPI *\", \"* SharpDir *\", \"* SharpDump *\", \"* SharpEDRChecker *\", \"* SharpGPOAbuse *\", \"* SharpHandler *\", \"* SharpHose *\", \"* SharpHound *\")\n      or winlog.event_data.CommandLine : \"* loldrivers.io *\" and winlog.event_data.CommandLine : \"* api *\" and winlog.event_data.CommandLine : \"* drivers.json *\"\n    )\n    and not (winlog.event_data.ParentImage in (\"* git.exe\", \"* slack.exe\", \"* mssense.exe\") and winlog.event_data.ParentImage : \"* chrome.exe\")","filters":[],"actions":[]}
{"id":"428a5bdd-25d1-4c72-9cb1-417ab5ce1435","updated_at":"2025-04-14T02:20:24.248Z","updated_by":"purple1","created_at":"2025-04-14T02:20:24.248Z","created_by":"purple1","name":"UC258 : Possible DCSync Attack (via audit)","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"DCSync is a late stage kill chain attack that allows an attacker to simulate the behavior of Domain Controller (DC) in order to retrieve password data via domain replication.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"263d1d59-f756-4915-93d4-e392b23c5b91","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[]}]}],"to":"now","references":["https://posts.specterops.io/domain-of-thrones-part-i-c183ee4bf379","https://www.alteredsecurity.com/post/a-primer-on-dcsync-attack-and-detection","https://adsecurity.org/?p=1729","https://medium.com/@jsecurity101/syncing-into-the-shadows-bbd656dd14c8"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and event.code : \"4662\"\n    and winlog.event_data.AccessMask: \"0x100\"\n    and winlog.event_data.ObjectServer: \"DS\"\n    and (winlog.event_data.Properties: \"19195a5b-6da0-11d0-afd3-00c04fd930c9\" and winlog.event_data.Properties: \"1131f6ad-9c07-11d1-f79f-00c04fc2dcd2\" \n    or winlog.event_data.Properties: \"19195a5b-6da0-11d0-afd3-00c04fd930c9\" and winlog.event_data.Properties: \"1131f6aa-9c07-11d1-f79f-00c04fc2dcd2\")\n    and not winlog.event_data.SubjectUserName in (\"*$\", \"MSOL_*\", \"Administrator\")","filters":[],"actions":[]}
{"id":"2243c9f1-c475-4809-939c-af552d18e88f","updated_at":"2025-02-21T03:57:49.259Z","updated_by":"purple1","created_at":"2025-02-21T03:14:54.329Z","created_by":"purple1","name":"UC244 : Win Sysmon Remote Thread Creation In Suspicious Targets","tags":["category: create_remote_thread","product: windows"],"interval":"5m","enabled":true,"revision":1,"description":"Detects a remote thread creation in suspicious target images","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e0106f51-6de0-4bbd-843e-1ebe3541add4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1055","name":"Process Injection","reference":"https://attack.mitre.org/techniques/T1055","subtechnique":[{"id":"T1055.003","name":"Thread Execution Hijacking","reference":"https://attack.mitre.org/techniques/T1055/003"}]}]}],"to":"now","references":["https://blog.redbluepurple.io/offensive-research/bypassing-injection-detection"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and \n  (\n    winlog.event_data.TargetFilename : \"*//mspaint.exe\"\n    or winlog.event_data.TargetFilename : \"*//calc.exe\"\n    or winlog.event_data.TargetFilename : \"*//notepad.exe\"\n    or winlog.event_data.TargetFilename : \"*//sethc.exe\"\n    or winlog.event_data.TargetFilename : \"*//write.exe\"\n    or winlog.event_data.TargetFilename : \"*//wordpad.exe\"\n    or winlog.event_data.TargetFilename : \"*//explorer.exe\"\n  )\n  and not\n  (\n    winlog.event_data.StartFunction : \"EtwpNotificationThread\"\n    or winlog.event_data.SourceImage: \"C://Program Files//*\"\n    or winlog.event_data.SourceImage: \"C://Program Files (x86)//*\"\n  )","filters":[],"actions":[]}
{"id":"78f7069d-bf0e-4908-bce0-bbc58ea10ef2","updated_at":"2025-04-16T07:22:29.928Z","updated_by":"purple1","created_at":"2025-04-16T07:22:29.928Z","created_by":"purple1","name":"UC358 : Suspicious Execution from Mounted Drive [WinRAR/7zip] (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may abuse container files such as disk image (.iso, .img) file formats to deliver malicious payloads.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"9f1a0658-b2eb-45cf-a109-f99618354977","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1566","name":"Phishing","reference":"https://attack.mitre.org/techniques/T1566","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1553","name":"Subvert Trust Controls","reference":"https://attack.mitre.org/techniques/T1553","subtechnique":[]}]}],"to":"now","references":["https://www.trendmicro.com/en_us/research/23/f/malvertising-used-as-entry-vector-for-blackcat-actors-also-lever.html","https://www.bleepingcomputer.com/news/security/uptick-seen-in-iso-email-attachments-delivering-malware/","https://cert.gov.ua/article/6032734"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and winlog.event_data.NewProcessName in (\"*\\\\.exe\", \"*\\\\.com\", \"*\\\\.scr\", \"*\\\\.tmp\")\n  and winlog.event_data.NewProcessName : \"*\\\\Temp\" and winlog.event_data.NewProcessName : \"*\\\\AppData\" and winlog.event_data.NewProcessName : \"*\\\\Local\" and winlog.event_data.NewProcessName : \"*\\\\Rar$\"\n  and winlog.event_data.NewProcessName : \"*\\\\Temp\" and winlog.event_data.NewProcessName : \"*\\\\AppData\" and winlog.event_data.NewProcessName : \"*\\\\Local\" and winlog.event_data.NewProcessName : \"*\\\\7z\"\n  and not (winlog.event_data.ParentProcessName : \"*\\\\zoom\\\\*\" and winlog.event_data.NewProcessName : \"*\\\\Installer.exe\")","filters":[],"actions":[]}
{"id":"07d20421-a48c-475e-8ff2-c751ce8001d8","updated_at":"2025-02-21T07:28:01.924Z","updated_by":"purple1","created_at":"2025-02-21T07:28:01.924Z","created_by":"purple1","name":"UC337 : Possible Outlook Reminder Persistence Attempt (via registry event)","tags":["product: windows","category: registry_event"],"interval":"5m","enabled":true,"revision":0,"description":"Attackers may try to achieve persistence and evade defense in targeted system by abusing Outlook reminder feature. This technique is inspired by CVE-2023-23397.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a625db48-c27b-4f73-a69e-c2edcb6519ff","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1222","name":"File and Directory Permissions Modification","reference":"https://attack.mitre.org/techniques/T1222","subtechnique":[]}]}],"to":"now","references":["https://www.microsoft.com/en-us/security/blog/2023/03/24/guidance-for-investigating-attacks-using-cve-2023-23397/","https://www.pwndefend.com/2023/03/15/the-long-game-persistent-hash-theft/","https://www.mdsec.co.uk/2023/03/exploiting-cve-2023-23397-microsoft-outlook-elevation-of-privilege-vulnerability/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and \n  (\n    (\n      winlog.event_data.TargetObject : \"*AppEvents*\"\n      and winlog.event_data.TargetObject : \"*Office97*\"\n      and winlog.event_data.TargetObject : \"*Reminders*\"\n      and winlog.event_data.TargetObject : \"*Currents*\"\n    )\n    or\n    (\n      (\n        winlog.event_data.TargetObject : \"*Microsoft*\"\n        and winlog.event_data.TargetObject : \"*Office*\"\n        and winlog.event_data.TargetObject : \"*Outlook*\"\n        and winlog.event_data.TargetObject : \"*Options*\"\n        and winlog.event_data.TargetObject : \"*Reminderss*\"\n      )\n      and\n      (\n        winlog.event_data.TargetObject : \"*Notes*\"\n        or winlog.event_data.TargetObject : \"*Tasks*\"\n      )\n    )\n  )","filters":[],"actions":[]}
{"id":"24f99978-797d-4580-bb1d-b81626cd1d88","updated_at":"2025-04-10T03:31:40.831Z","updated_by":"purple1","created_at":"2025-04-10T03:31:40.831Z","created_by":"purple1","name":"UC219 : MMC20 Lateral Movement","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"  - Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of \"-Embedding\" as a child of svchost.exe\n  - Detects a Windows command line executable started from MMC","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"510ee6ca-c689-4341-90c4-e20410b36b20","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":["https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/","https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view?usp=sharing"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (winlog.event_data.ParentProcessName : \"*\\\\svchost.exe\" and winlog.event_data.NewProcessName : \"*\\\\mmc.exe\" and winlog.event_data.CommandLine : \"* -Embedding *\"\n      or winlog.event_data.ParentProcessName : \"*\\\\mmc.exe\"\n      or winlog.event_data.NewProcessName in (\"*\\\\cmd.exe\", \"*\\\\powershell.exe\", \"*\\\\pwsh.exe\", \"*\\\\wscript.exe\", \"*\\\\cscript.exe\", \"*\\\\sh.exe\", \"*\\\\bash.exe\", \"*\\\\reg.exe\", \"*\\\\regsvr32.exe\", \"*\\\\BITSADMIN\"))","filters":[],"actions":[]}
{"id":"69665d40-c8c8-41a6-a7f6-eb7f5558e312","updated_at":"2025-04-16T12:05:33.844Z","updated_by":"elastic","created_at":"2025-04-08T10:31:29.221Z","created_by":"purple1","name":"UC044 : Windows Discovery System Service","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attackers spy on system service information on windows.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"14859eb0-d059-44cd-8e64-00e8cea80eb8","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1007/T1007.md","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1047/T1047.md#atomic-test-4---wmi-reconnaissance-list-remote-services"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and event.code : \"4688\"\n    and \n    (\n      winlog.event_data.NewProcessName : \"*\\\\tasklist.exe\" \n      or winlog.event_data.NewProcessName : \"*\\\\tasklist.exe\" and winlog.event_data.CommandLine in (\"* query *\", \"* query state *\")\n      or winlog.event_data.NewProcessName in (\"*\\\\net.exe\", \"*\\\\net1.exe\") and winlog.event_data.CommandLine : \"* start *\"\n      or winlog.event_data.NewProcessName : \"*\\\\WMIC.exe\" and winlog.event_data.CommandLine : \"* service *\"\n    )","filters":[],"actions":[]}
{"id":"52300c86-075c-4199-80fc-07d07f26e3b1","updated_at":"2025-04-16T08:45:13.317Z","updated_by":"purple1","created_at":"2025-02-25T04:10:17.481Z","created_by":"elastic","name":"UC376 : LOLBAS CDB (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects use of CDB as a living off the land technique.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":["Legitimate usage of script files within cdb (should be quite rare)"],"from":"now-360s","rule_id":"60ff241b-f732-41ea-8efb-623741bd33ec","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1218","name":"System Binary Proxy Execution","reference":"https://attack.mitre.org/techniques/T1218","subtechnique":[]},{"id":"T1127","name":"Trusted Developer Utilities Proxy Execution","reference":"https://attack.mitre.org/techniques/T1127","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\cdb.exe\" and winlog.event_data.CommandLine : \"* cf *\" and winlog.event_data.CommandLine : \"* -c *\" and winlog.event_data.CommandLine : \"* $ *\"","filters":[],"actions":[]}
{"id":"8f5db268-fc64-432d-9e9d-8019d8267093","updated_at":"2025-04-10T02:35:23.889Z","updated_by":"purple1","created_at":"2025-04-10T02:35:23.889Z","created_by":"purple1","name":"UC201 : Group Policy Discovery","tags":["product: windows"],"interval":"5m","enabled":true,"revision":0,"description":"Group Policy Discovery","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"7a39043b-d959-40fd-9763-c598a18ce617","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1615","name":"Group Policy Discovery","reference":"https://attack.mitre.org/techniques/T1615","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\gpresult.exe\" and winlog.event_data.CommandLine in (\"* /z *\", \"* /v *\")\n    or event.code : \"4104\" and winlog.event_data.ScriptBlockText in (\"* gpresult /z *\", \"* gpresult /v *\", \"* Get-GPO *\", \"* Get-DomainGPO *\", \"* GPOAudit *\", \"* GPORemoteAccessPolicy *\"))","filters":[],"actions":[]}
{"id":"bbc6afb7-5cbd-4a9d-bbbc-3c1cf9664ed8","updated_at":"2025-04-14T09:23:23.272Z","updated_by":"purple1","created_at":"2025-04-14T09:23:23.272Z","created_by":"purple1","name":"UC288 : Windows Url Shortcut Was Created by Unusual Process (via file_event)","tags":["product: windows","category: file_event"],"interval":"5m","enabled":true,"revision":0,"description":"Identifies Windows url shortcut file creation attempt, which may be an indicator of CVE-2023-36025 (Windows SmartScreen Security Feature Bypass) exploitation attempt. The reliance on the surrounding environment may necessitate the implementation of additional filtering measures to prevent false positives.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"1852a4fd-0dd1-4e17-a341-7e4e93c6396b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1566","name":"Phishing","reference":"https://attack.mitre.org/techniques/T1566","subtechnique":[{"id":"T1566.001","name":"Spearphishing Attachment","reference":"https://attack.mitre.org/techniques/T1566/001"},{"id":"T1566.002","name":"Spearphishing Link","reference":"https://attack.mitre.org/techniques/T1566/002"}]}]}],"to":"now","references":["https://www.trendmicro.com/en_us/research/24/a/cve-2023-36025-exploited-for-defense-evasion-in-phemedrone-steal.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.TargetFilename : \"*\\\\url\"\n    and winlog.event_data.NewProcessName in (\"*\\\\chrome.exe\", \"*\\\\msedge.exe\", \"*\\\\opera.exe\", \"*\\\\firefox.exe\", \"*\\\\brave.exe\", \"*\\\\thunderbird.exe\", \"*\\\\OUTLOOK.EXE\", \"*\\\\WinMail.exe\", \"*\\\\Mailbird.exe\", \"*\\\\WinRAR.exe\", \"*\\\\7z.exe\", \"*\\\\powershell.exe\", \"*\\\\cmd.exe\", \"*\\\\AppVLP.exe\", \"*\\\\rundll32.exe\", \"*\\\\Cmstp.exe\", \"*\\\\Esentutl.exe\", \"*\\\\Eventvwr.exe\", \"*\\\\Installutil.exe\", \"*\\\\Mavinject.exe\", \"*\\\\Microsoft.Workflow.Compiler.exe\", \"*\\\\Msbuild.exe\", \"*\\\\Msdt.exe\", \"*\\\\Odbcconf.exe\", \"*\\\\Presentationhost.exe\", \"*\\\\Regsvr32.exe\", \"*\\\\SQLToolsPS.exe\", \"*\\\\Sqlps.exe\", \"*\\\\SyncAppvPublishingServer.exe\", \"*\\\\atbroker.exe\", \"*\\\\bash.exe\", \"*\\\\bitsadmin.exe\", \"*\\\\cdb.exe\", \"*\\\\cmstp.exe\", \"*\\\\csi.exe\", \"*\\\\devtoolslauncher.exe\", \"*\\\\dnscmd.exe\", \"*\\\\dnx.exe\", \"*\\\\dxcap.exe\", \"*\\\\extexport.exe\", \"*\\\\forfiles.exe\", \"*\\\\ftp.exe\", \"*\\\\hh.exe\", \"*\\\\ieexec.exe\", \"*\\\\installutil.exe\", \"*\\\\jjs.exe\", \"*\\\\mavinject.exe\", \"*\\\\mftrace.exe\", \"*\\\\msdt.exe\", \"*\\\\mshta.exe\", \"*\\\\msiexec.exe\", \"*\\\\msxsl.exe\", \"*\\\\odbcconf.exe\", \"*\\\\presentationhost.exe\", \"*\\\\regasm.exe\", \"*\\\\regsvcs.exe\", \"*\\\\runonce.exe\", \"*\\\\runscripthelper.exe\", \"*\\\\schtasks.exe\", \"*\\\\scriptrunner.exe\", \"*\\\\squirrel.exe\", \"*\\\\tracker.exe\", \"*\\\\verclsid.exe\", \"*\\\\vsjitdebugger.exe\", \"*\\\\wmic.exe\", \"*\\\\wsl.exe\", \"*\\\\xwizard.exe\")","filters":[],"actions":[]}
{"id":"51d06bd0-d1f5-4af7-b703-daeee5bf3f3d","updated_at":"2025-04-15T04:10:51.960Z","updated_by":"purple1","created_at":"2025-02-27T10:31:18.657Z","created_by":"elastic","name":"UC313 : Possible Hidden AnyDesk Install (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"AnyDesk hidden installation patterns. It is highly recommended to baseline your activity and tune out common business use cases.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a789964d-2342-41f2-9e4d-fc1b62ada1d4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1021","name":"Remote Services","reference":"https://attack.mitre.org/techniques/T1021","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1219","name":"Remote Access Software","reference":"https://attack.mitre.org/techniques/T1219","subtechnique":[]}]}],"to":"now","references":["https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/iran-apt-seedworm-africa-telecoms","https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a","https://news.sophos.com/en-us/2023/11/10/vice-society-and-rhysida-ransomware/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and winlog.event_data.NewProcessName in (\".exe\",\".tmp\", \".scr\")\n  and\n    (\n      winlog.event_data.CommandLine : \"* --install *\" and winlog.event_data.CommandLine : \"* --start-with-win *\" and winlog.event_data.CommandLine : \"* --silent *\"\n      or winlog.event_data.CommandLine : \"* AnyDesk.exe *\" and winlog.event_data.CommandLine : \"* silent *\" \n      or winlog.event_data.CommandLine : \"* --get-id *\" and winlog.event_data.CommandLine : \"* --set-password *\"\n      or  winlog.event_data.CommandLine : \"* AnyDesk *\" and winlog.event_data.CommandLine : \"* --set-password *\"\n      or  winlog.event_data.CommandLine : \"* --local-service *\" and winlog.event_data.CommandLine : \"* --local-control *\"\n    )","filters":[],"actions":[]}
{"id":"2fc1a869-15b3-45a8-bad3-199285a57173","updated_at":"2025-04-16T08:41:45.268Z","updated_by":"purple1","created_at":"2025-02-25T04:10:58.517Z","created_by":"elastic","name":"UC364 : Copying Sensitive Files with Credential Data","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Files with well-known filenames (sensitive files with credential data) copying","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2f2e8dd2-17fe-4d4d-8ccd-9f5445180277","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.002","name":"Security Account Manager","reference":"https://attack.mitre.org/techniques/T1003/002"},{"id":"T1003.003","name":"NTDS","reference":"https://attack.mitre.org/techniques/T1003/003"}]}]}],"to":"now","references":["https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/","https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Esentutl.yml"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"  any where host.os.type : \"windows\" and (winlog.event_data.NewProcessName : \"*\\\\esentutl.exe\" and winlog.event_data.OriginalFileName : \"esentutl.exe\" and winlog.event_data.CommandLine in (\"vss\" , \"\\\\/m\", \"\\\\/y\", \"\\\\/p\")\n    or winlog.event_data.CommandLine in (\"* \\\\config\\\\RegBack\\\\sam *\", \"* \\\\config\\\\RegBack\\\\security *\", \"* \\\\config\\\\RegBack\\\\system *\", \"* \\\\config\\\\security *\", \"* \\\\config\\\\sam *\", \"* \\\\config\\\\system *\", \"* \\\\repair\\\\security *\", \"* \\\\repair\\\\sam *\", \"* \\\\repair\\\\system *\", \"* \\\\windows\\\\ntds\\\\ntds.dit *\"))","filters":[],"actions":[]}
{"id":"77627db0-5b2e-4249-bb0a-04d6567aae0b","updated_at":"2025-04-10T07:17:45.532Z","updated_by":"purple1","created_at":"2025-04-10T07:17:45.532Z","created_by":"purple1","name":"UC230 : LOLBAS MSdt (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects use of msdt as a living off the land technique.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"470ba517-51f4-4b13-a03c-5b1ff892b8f3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/LOLBAS-Project/LOLBAS/blob/master/yml/OSBinaries/Msdt.yml","https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e","https://irsl.medium.com/the-trouble-with-microsofts-troubleshooters-6e32fc80b8bd","https://nao-sec.org/2023/08/groundpeony-crawling-with-malice.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.CommandLine in (\"* af *\", \"* ts_AUTO *\", \"* param *\", \"* skip *\", \"* ..\\\\ *\", \"* ../ *\", \"* /cab *\")\n    and winlog.event_data.CommandLine in (\"* ms-msdt:/id *\", \"* ms-msdt:-id *\", \"* IT_BrowseForFile *\", \"* IT_RebrowseForFile *\")\n    and winlog.event_data.NewProcessName : \"msdt.exe\"\n    and not winlog.event_data.CommandLine in (\"* DeviceCenterDiagnostic *\", \"* AudioPlaybackDiagnostic *\", \"* NetworkDiagnostics *\")","filters":[],"actions":[]}
{"id":"eafd4940-d15f-435a-b5db-2b5de7cdba76","updated_at":"2025-04-17T03:03:22.875Z","updated_by":"purple1","created_at":"2025-04-04T07:14:58.847Z","created_by":"purple1","name":"UC030 : Suspicious Process Execution Using PSTool","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detected using some suspicious tools in PsTools. PsTools is a set of 12 tools that simplify the administration of large networks.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"09a8d2b4-0152-481e-9b75-964ef95aa0ad","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1021","name":"Remote Services","reference":"https://attack.mitre.org/techniques/T1021","subtechnique":[{"id":"T1021.002","name":"SMB/Windows Admin Shares","reference":"https://attack.mitre.org/techniques/T1021/002"}]}]}],"to":"now","references":["https://attack.mitre.org/techniques/T1021/002","https://redcanary.com/threat-detection-report/techniques/windows-admin-shares/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \nand event.code : \"4688\"\nand winlog.event_data.NewProcessName in (\"*\\\\PsList.exe\", \"*\\\\PsService.exe\", \"*\\\\PsExec.exe\", \"*\\\\PsGetSID.exe\", \"*\\\\PsKill.exe\", \"*\\\\ProcDump.exe\", \"*\\\\PsLoggedOn.exe\", \"*\\\\PsFile.exe\", \"*\\\\PSLogList.exe\", \"*\\\\PsPasswd.exe\", \"*\\\\PsList64.exe\", \"*\\\\PsService64.exe\", \"*\\\\PsExec64.exe\", \"*\\\\PsGetSID64.exe\", \"*\\\\PsKill64.exe\", \"*\\\\ProcDump64.exe\", \"*\\\\PsLoggedOn64.exe\", \"*\\\\PsFile64.exe\", \"*\\\\PSLogList64.exe\", \"*\\\\PsPasswd64.exe\")","filters":[],"actions":[]}
{"id":"7711be66-6d53-49db-88ed-738691be30f1","updated_at":"2025-04-14T04:30:46.621Z","updated_by":"purple1","created_at":"2025-02-27T10:30:54.489Z","created_by":"elastic","name":"UC284 : Execution from RAR Archive [WinRAR] (via process_creation)","tags":["category: process_creation","product: windows"],"interval":"5m","enabled":true,"revision":1,"description":"Detects execution of executable files and scripts from within rar archives, encrypted rar archives are often used to deliver malicious payloads.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":["https://blog.google/threat-analysis-group/government-backed-actors-exploiting-winrar-vulnerability/","https://blog.eclecticiq.com/german-embassy-lure-likely-part-of-campaign-against-nato-aligned-ministries-of-foreign-affairs","https://www.seqrite.com/blog/sidecopys-multi-platform-onslaught-leveraging-winrar-zero-day-and-linux-variant-of-ares-rat/"],"from":"now-360s","rule_id":"014facd4-fd08-4851-819e-c2c529ef0a50","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1566","name":"Phishing","reference":"https://attack.mitre.org/techniques/T1566","subtechnique":[{"id":"T1566.001","name":"Spearphishing Attachment","reference":"https://attack.mitre.org/techniques/T1566/001"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1203","name":"Exploitation for Client Execution","reference":"https://attack.mitre.org/techniques/T1203","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and (\n    winlog.event_data.CommandLine : \"* AppData *\" and winlog.event_data.CommandLine : \"* Local *\" and winlog.event_data.CommandLine : \"* Temp *\" and winlog.event_data.CommandLine : \"* Rar$ *\" and winlog.event_data.CommandLine in (\"* .bat *\",\"* .cmd *\", \"* .lnk *\")\n    or winlog.event_data.NewProcessName : \"*\\\\AppData\" and winlog.event_data.NewProcessName : \"*\\\\Local\" and winlog.event_data.NewProcessName : \"*\\\\Temp\" and winlog.event_data.NewProcessName : \"*\\\\Rar$\" and winlog.event_data.NewProcessName in (\"*\\\\exe\",\"*\\\\com\",\"*\\\\pif\",\"*\\\\scr\") \n    or winlog.event_data.ParentProcessName : \"*\\\\WinRAR.exe\" and not winlog.event_data.NewProcessName : \"* \\\\WinRAR.exe\"\n    or winlog.event_data.CommandLine in (\"* %TMP% *\", \"* Rar$ *\", \"* .cmd *\"))","filters":[],"actions":[]}
{"id":"49b023f3-c711-4967-aacc-d3a69bb6cb62","updated_at":"2025-02-27T10:30:14.189Z","updated_by":"elastic","created_at":"2025-02-27T10:30:14.189Z","created_by":"elastic","name":"UC199 : Mavinject Inject DLL Into Running Process","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects process injection using the signed Windows tool \"Mavinject\" via the \"INJECTRUNNING\" flag","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"34ab2e55-4433-4bf0-9384-92aae64efefc","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1055","name":"Process Injection","reference":"https://attack.mitre.org/techniques/T1055","subtechnique":[{"id":"T1055.001","name":"Dynamic-link Library Injection","reference":"https://attack.mitre.org/techniques/T1055/001"}]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md","https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.004/T1056.004.md","https://posts.specterops.io/mavinject-exe-functionality-deconstructed-c29ab2cf5c0e","https://reaqta.com/2017/12/mavinject-microsoft-injector/","https://twitter.com/Hexacorn/status/776122138063409152","https://github.com/keyboardcrunch/SentinelOne-ATTACK-Queries/blob/6a228d23eefe963ca81f2d52f94b815f61ef5ee0/Tactics/DefenseEvasion.md#t1055-process-injection","https://github.com/SigmaHQ/sigma/issues/3742"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":" any where host.os.type : \"windows\" \n    and winlog.event_data.CommandLine : \"*INJECTRUNNING*\"\n    and not \n    (\n        winlog.event_data.ParentImage : \"*C:\\\\Windows\\\\System32\\\\AppVClient.exe\"\n    )","filters":[],"actions":[]}
{"id":"8b51d9d0-12b0-42bb-ac35-8f310d245f65","updated_at":"2025-04-15T01:58:49.746Z","updated_by":"purple1","created_at":"2025-04-15T01:58:49.746Z","created_by":"purple1","name":"UC299 : Suspicious Batch File Execution With Double Extension (via cmdline)","tags":["product: windows","  category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Identifies Windows batch file execution with double extension (such as .tmp.bat) in order to evade being detected.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"fbf22fbb-b513-44c3-b114-6c424eeba25c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1036","name":"Masquerading","reference":"https://attack.mitre.org/techniques/T1036","subtechnique":[]}]}],"to":"now","references":["https://twitter.com/RexorVc0/status/1753322883370168777"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":" any where host.os.type : \"windows\" and winlog.event_data.CommandLine in (\"* .tmp.bat *\"  , \"* .dat.bat *\" , \"* .pdf.bat *\" , \"* .doc.bat *\" , \"* .docx.bat *\" , \"* .txt.bat *\" , \"* .jpg.bat *\" , \"* .png.bat *\" , \"* .jpeg.bat *\")","filters":[],"actions":[]}
{"id":"02663adf-e3ba-4e35-adfd-aef6e26b5f83","updated_at":"2025-04-03T02:07:19.642Z","updated_by":"purple1","created_at":"2025-02-21T03:01:30.954Z","created_by":"purple1","name":"UC248: Potential CVE-2023-27363 Exploitation.yml","tags":["product: windows","category: file_event"],"interval":"5m","enabled":true,"revision":2,"description":"Detects suspicious \".hta\" file creation in the startup folder by Foxit Reader. This can be an indication of CVE-2023-27363 exploitation.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"3fb82d9e-056f-4681-a8a5-07453e8ee04d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1505","name":"Server Software Component","reference":"https://attack.mitre.org/techniques/T1505","subtechnique":[{"id":"T1505.001","name":"SQL Stored Procedures","reference":"https://attack.mitre.org/techniques/T1505/001"}]}]}],"to":"now","references":["https://github.com/j00sean/SecBugs/tree/ff72d553f75d93e1a0652830c0f74a71b3f19c46/CVEs/CVE-2023-27363","https://www.zerodayinitiative.com/advisories/ZDI-23-491/","https://www.tarlogic.com/blog/cve-2023-27363-foxit-reader/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and winlog.event_data.Image : \"*//FoxitPDFReader.exe\"\n  and\n  (\n    winlog.event_data.TargetFilename : \"*//Microsoft//Windows//Start Menu//Programs//Startup//*\"\n    or winlog.event_data.TargetFilename : \"*.hta\"\n  )","filters":[],"actions":[]}
{"id":"1225d856-f6e8-46bf-8323-fc5b2c7e5602","updated_at":"2025-02-21T08:13:41.685Z","updated_by":"purple1","created_at":"2025-02-21T08:13:41.685Z","created_by":"purple1","name":"UC366 : Abusable DLL Potential Sideloading From Suspicious Location","tags":["product: windows","category: image_load"],"interval":"5m","enabled":true,"revision":0,"description":"Detects potential DLL sideloading of DLLs that are known to be abused from suspicious locations\n\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e7da2b39-7dee-4f43-80f7-61f7633403ba","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.trendmicro.com/en_us/research/23/f/behind-the-scenes-unveiling-the-hidden-workings-of-earth-preta.html","https://research.checkpoint.com/2023/beyond-the-horizon-traveling-the-world-on-camaro-dragons-usb-flash-drives/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and \n  (\n    (\n      winlog.event_data.ImageLoaded : \"*//coreclr.dll\"\n      or winlog.event_data.ImageLoaded : \"*//facesdk.dll\"\n      or winlog.event_data.ImageLoaded : \"*//HPCustPartUI.dll\"\n      or winlog.event_data.ImageLoaded : \"*//libcef.dll\"\n      or winlog.event_data.ImageLoaded : \"*//ZIPDLL.dll\"\n    )\n    and not \n    (\n      (\n        winlog.event_data.ImageLoaded : \"*://Perflogs//\"\n        or winlog.event_data.ImageLoaded : \"*://Users//Public//\"\n        or winlog.event_data.ImageLoaded : \"*//Temporary Internet\"\n        or winlog.event_data.ImageLoaded : \"*//Windows//Temp//\"\n      )\n      or\n      (\n        winlog.event_data.ImageLoaded : \"*://Users//\"\n        and winlog.event_data.ImageLoaded : \"*//Favorites//\"\n      )\n      or\n      (\n        winlog.event_data.ImageLoaded : \"*://Users//\"\n        and winlog.event_data.ImageLoaded : \"*//Favourites//\"\n      )\n      or\n      (\n        winlog.event_data.ImageLoaded : \"*://Users//\"\n        and winlog.event_data.ImageLoaded : \"*//Contacts//\"\n      )\n      or\n      (\n        winlog.event_data.ImageLoaded : \"*://Users//\"\n        and winlog.event_data.ImageLoaded : \"*//Pictures//\"\n      )\n    )\n  )","filters":[],"actions":[]}
{"id":"e678e2e5-bfff-48ea-b7f9-a5bb35c81a87","updated_at":"2025-03-27T01:56:42.130Z","updated_by":"purple1","created_at":"2025-02-25T04:08:51.193Z","created_by":"elastic","name":"UC062 : Disable Windows recovery mechanism","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detected attacker disables and removes some security agents that generate and push logs.","risk_score":99,"severity":"critical","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"0aa66509-50bf-49fc-a9c8-affc0e6bde5c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and\n    (\n        (\n            winlog.event_data.ProcessName : \"*vssadmin.exe*\"\n            and winlog.event_data.CommandLine: \"*delete shadows*\"\n        )\n        or\n        (\n            winlog.event_data.ProcessName : \"*wmic.exe*\"\n            and winlog.event_data.CommandLine: \"*shadowcopy delete*\"\n        )\n        or \n        (\n            winlog.event_data.ProcessName : \"*wbadmin.exe*\"\n            and\n            (\n                winlog.event_data.CommandLine: \"*delete systemstatebackup*\"\n                or winlog.event_data.CommandLine: \"*delete catalog*\"\n            ) \n        )\n        or\n        (\n            winlog.event_data.ProcessName : \"*bcdedit.exe*\"\n            and\n            (\n                winlog.event_data.CommandLine: \"*bootstatuspolicy*\"\n                or winlog.event_data.CommandLine: \"*recoveryenabled*\"\n            ) \n        )\n    )","filters":[],"actions":[]}
{"id":"cc8b191a-010a-4ec8-84de-b1d393b97824","updated_at":"2025-04-15T02:03:33.817Z","updated_by":"purple1","created_at":"2025-02-27T10:31:06.606Z","created_by":"elastic","name":"UC300: Possible Credential Dumping by Abusing Process Explorer Driver (via file_event)","tags":["product: windows","category: file_event"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaties can abuse Process Explorer driver to open lsass handle (bypass PPL) and dump credential from lsass on a compromised host","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"07d17f0c-acc1-4a40-a5be-9161f5e707d6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.001","name":"LSASS Memory","reference":"https://attack.mitre.org/techniques/T1003/001"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.TargetFilename : \"*//PROCEXP//*\"\n    and winlog.event_data.TargetFilename : \"*//.sys\"\n    and not winlog.event_data.NewProcessName in (\"* //procexp64.exe\", \"*//procexp.exe\", \"*//Windowapps\")","filters":[],"actions":[]}
{"id":"c9cc7e8f-da59-41b2-a6c7-13c70282b82c","updated_at":"2025-04-17T03:57:09.825Z","updated_by":"purple1","created_at":"2025-02-25T04:08:42.179Z","created_by":"elastic","name":"UC038 : Change Windows Accessibility Features","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detected attacker tries to maintain or escalate privileges, replace the default file paths in the registry to the executable file path desired by the attacker.","risk_score":99,"severity":"critical","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"18a59479-6c69-4d91-9a46-0b3200ab134b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1546","name":"Event Triggered Execution","reference":"https://attack.mitre.org/techniques/T1546","subtechnique":[{"id":"T1546.008","name":"Accessibility Features","reference":"https://attack.mitre.org/techniques/T1546/008"}]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.008/T1546.008.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \nand winlog.event_data.CommandLine in (\"*\\\\CurrentVersion\\\\Image File Execution Options\\\\ *\", \"* sethc.exe *\", \"* utilman.exe *\", \"* osk.exe *\", \"* magnify.exe *\", \"* narrator.exe *\", \"* displayswitch.exe *\", \"* atbroker.exe *\", \"* HelpPane.exe *\")","filters":[],"actions":[]}
{"id":"a9b2efd9-9e6c-43e5-bc80-b347339b32dc","updated_at":"2025-04-09T02:47:35.298Z","updated_by":"purple1","created_at":"2025-04-09T02:47:35.298Z","created_by":"purple1","name":"UC053 : Clear Windows Event Log","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detected when an attacker deletes windows logs.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"76107b8e-390d-48a0-b3f3-7a4289ac649d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=1102","http://www.eventid.net/display-eventid-104-source-Microsoft-Windows-Eventlog-eventno-11441-phase-1.htm","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1070.001/T1070.001.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n      event.code in (\"1102\", \"104\")\n      or event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\wevtutil.exe\" and winlog.event_data.CommandLine in (\"* cl *\", \"* clear-log *\")\n      or event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\fsutil\" and winlog.event_data.CommandLine in (\"* usn *\", \"* deletejournal *\")\n    )","filters":[],"actions":[]}
{"id":"eb307f3f-5d8b-4ea6-a350-a0cdea7118e6","updated_at":"2025-04-10T02:27:29.758Z","updated_by":"purple1","created_at":"2025-04-10T02:27:29.758Z","created_by":"purple1","name":"UC197 : Data Exfiltration","tags":["product: windows"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection. ","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"83f24b34-3443-418d-bd72-4282f2bb87f3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010"},"technique":[{"id":"T1020","name":"Automated Exfiltration","reference":"https://attack.mitre.org/techniques/T1020","subtechnique":[]}]}],"to":"now","references":["https://blog.apnic.net/2022/03/31/how-to-detect-and-prevent-common-data-exfiltration-attacks/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code : \"4104\" and winlog.event_data.ScriptBlockText in (\"* .pdf *\", \"* docx *\", \"* xls *\", \"* xps *\", \"* ppt *\", \"* pps *\", \"* zip *\", \"* rar *\", \"* docx *\", \"* xlsx *\", \"* txt *\")","filters":[],"actions":[]}
{"id":"6a5b7269-8bf0-4b3f-b450-b8efddcc850b","updated_at":"2025-02-25T04:09:19.394Z","updated_by":"elastic","created_at":"2025-02-25T04:09:19.394Z","created_by":"elastic","name":"UC093 : Suspicious Bitsadmin Job via PowerShell","tags":["product: windows","category: ps_script"],"interval":"5m","enabled":true,"revision":0,"description":"Detect download by BITS jobs via PowerShell","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"877f40f7-fa30-4a9b-a954-c1f165705b48","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1197","name":"BITS Jobs","reference":"https://attack.mitre.org/techniques/T1197","subtechnique":[]}]}],"to":"now","references":["https://eqllib.readthedocs.io/en/latest/analytics/ec5180c9-721a-460f-bddc-27539a284273.html","https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1197/T1197.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and event.code : \"4104\"\n    and \n    (\n        winlog.event_data.ScriptBlockText : \"*Start-BitsTransfer*\"\n        or winlog.event_data.ScriptBlockText : \"*Get-BitsTransfer*\"\n        or winlog.event_data.ScriptBlockText : \"*Add-BitsFile*\"\n    )","filters":[],"actions":[]}
{"id":"bb6b02a8-d128-4c21-bb13-55171e2afb0b","updated_at":"2025-04-15T03:32:11.364Z","updated_by":"purple1","created_at":"2025-02-27T10:31:15.636Z","created_by":"elastic","name":"UC309 : Suspicious Impact by Deleting Shadow Copies with PowerShell (via ps_script)","tags":["product: windows","category: ps_script"],"interval":"5m","enabled":true,"revision":1,"description":"Threat actors use powershell to delete the shadow copy. With this technique, System data becomes unrecoverable.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"31d34b6e-1301-4397-8dca-b96dd0cb5089","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0040","name":"Impact","reference":"https://attack.mitre.org/tactics/TA0040"},"technique":[{"id":"T1490","name":"Inhibit System Recovery","reference":"https://attack.mitre.org/techniques/T1490","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code : \"4104\" and winlog.event_data.ScriptBlockText : \"* Get-WmiObject *\" and winlog.event_data.ScriptBlockText : \"* Win32_Shadowcopy *\" and winlog.event_data.ScriptBlockText : \"* ForEach-Object *\" and winlog.event_data.ScriptBlockText : \"* { $_Delete(); } *\"","filters":[],"actions":[]}
{"id":"c58e94cf-56fd-483a-8bfb-44c66354cfcb","updated_at":"2025-04-15T02:28:45.247Z","updated_by":"purple1","created_at":"2025-04-15T02:28:45.247Z","created_by":"purple1","name":"UC305 : Potential Suspicious Scheduled Task Create, Run, Delete Behavior (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"This rule identifies a scheduled task being created, run, and deleted on a host. This was documented Conti Ransomware activity in the 2022 Conti ransomware leak.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"29d08f30-fe9c-40f6-9860-0a76b2d18a61","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.infosecurity-magazine.com/news/signature-techniques-of-asian-apt/","https://github.com/Res260/conti_202202_leak_procedures/blob/main/04_jump_to_payload_sessions.txt","https://blog.talosintelligence.com/new-zardoor-backdoor/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"  any where host.os.type : \"windows\" \n  and winlog.event_data.NewProcessName : \"*\\\\schtasks.exe\"\n  and (winlog.event_data.CommandLine : \"* system *\" and winlog.event_data.CommandLine : \"* /RU *\" and winlog.event_data.CommandLine : \"* /tr *\" and winlog.event_data.CommandLine : \"* cmd.exe *\" and winlog.event_data.CommandLine : \"* /sc *\" and winlog.event_data.CommandLine : \"* once *\"\n  or winlog.event_data.CommandLine : \"* /s *\" and winlog.event_data.CommandLine : \"* /run *\" and winlog.event_data.CommandLine : \"* /TN *\"\n  or winlog.event_data.CommandLine : \"* /S *\" and winlog.event_data.CommandLine : \"* /TN *\" and winlog.event_data.CommandLine : \"* /DELETE *\" and winlog.event_data.CommandLine : \"* /F *\")","filters":[],"actions":[]}
{"id":"415d012b-af09-47be-82df-99700743056f","updated_at":"2025-04-09T04:37:28.047Z","updated_by":"purple1","created_at":"2025-04-09T04:37:28.047Z","created_by":"purple1","name":"UC069 : Suspicious Windows Process Parameter","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects suspicious param in Windows processes.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"3c1fa7b0-e001-4234-a39c-5c56725ed503","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1046/T1046.md#atomic-test-3---port-scan-nmap-for-windows","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1018/T1018.md#atomic-test-7---remote-system-discovery---sweep","https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/cobalt-4-5-user-guide.pdf","https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/","https://thedfirreport.com/2022/06/16/sans-ransomware-summit-2022-can-you-detect-this/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and (winlog.event_data.NewProcessName : \"*\\\\nmap.exe\" or winlog.event_data.CommandLine in (\"* pushd *\", \"* copy *\", \"* echo *\", \"* ping -n *\", \"* do ping *\", \"* dir *\", \"* type *\", \"* del *\", \"* move *\", \"* ipconfig *\", \"* ..  *\", \"* &  *\", \"* >  *\", \"* for  *\", \"* foreach *\") or winlog.event_data.CommandLine in (\"* Invoke-UserHunter *\", \"* Invoke-ShareFinder *\", \"* Invoke-Kerberoast *\", \"* Invoke-SMBAutoBrute *\", \"* Invoke-Nightmare *\", \"* zerologon *\", \"* av_query *\"))","filters":[],"actions":[]}
{"id":"e3f6b1ed-4e66-40de-8ed9-fd95084083d0","updated_at":"2025-02-27T10:30:22.237Z","updated_by":"elastic","created_at":"2025-02-27T10:30:22.237Z","created_by":"elastic","name":"UC227 : CVE-2023-38331 Exploitation Attempt - Suspicious Double Extension File","tags":["product: windows","category: file_event"],"interval":"5m","enabled":true,"revision":0,"description":"Detects the creation of a file with a double extension and a space by WinRAR. This could be a sign of exploitation of CVE-2023-38331","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e61bd2fd-9dfd-4f71-b5a2-22b330fa02d1","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.group-ib.com/blog/cve-2023-38831-winrar-zero-day/","https://github.com/knight0x07/WinRAR-Code-Execution-Vulnerability-CVE-2023-38831/blob/26ab6c40b6d2c09bb4fc60feaa4a3a90cfd20c23/Part-1-Overview.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n        winlog.event_data.Image : \"*WinRAR.exe\"\n        and (\n            winlog.event_data.TargetFilename : \"\\\\AppData\\\\Local\\\\Temp\\\\Rar$\"\n            or winlog.event_data.TargetFilename regex \"\\\\.[a-zA-Z0-9]{1,4} \\\\.\"\n        )\n    )","filters":[],"actions":[]}
{"id":"cd875c7b-3d0d-4428-a7e1-1a23abc9e230","updated_at":"2025-02-27T10:31:12.635Z","updated_by":"elastic","created_at":"2025-02-27T10:31:12.635Z","created_by":"elastic","name":"UC306 : BlackCat Ransomware Persistence (17 March 2022)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"This rule detects the methods the malware uses for persistence after the system is infiltrated.","risk_score":99,"severity":"critical","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"f3f8812a-5caa-4820-937d-3ce0114f8933","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://blog.talosintelligence.com/2022/03/from-blackmatter-to-blackcat-analyzing.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and\n    (\n        (\n            winlog.event_data.Image : \"*powershell.exe*\"\n            and\n            (\n                winlog.event_data.CommandLine : \"*-command*\"\n                and winlog.event_data.CommandLine : \"*get-content*\"\n                and winlog.event_data.CommandLine : \"*\\\\system*\"\n                and winlog.event_data.CommandLine : \"*-raw*\"\n                and winlog.event_data.CommandLine : \"*set-content*\"\n                and winlog.event_data.CommandLine : \"*-stream*\"\n                and winlog.event_data.CommandLine : \"*cachetask*\"\n            )\n        )\n        or\n        (\n            winlog.event_data.Image : \"*\\\\schtasks.exe*\"\n            and winlog.event_data.ParentImage : \"*\\\\cmd.exe*\"\n            and winlog.event_data.CommandLine : \"*system*\"\n            and winlog.event_data.CommandLine : \"*hourly*\"\n            and winlog.event_data.CommandLine : \"*windows*\"\n            and winlog.event_data.CommandLine : \"*wsus*\"\n            and winlog.event_data.CommandLine : \"*update*\"\n            and winlog.event_data.CommandLine : \"*defender*\"\n        )\n        or\n        (\n            winlog.event_data.Image : \"*\\\\schtasks.exe*\"\n            and winlog.event_data.CommandLine : \"*-l*\"\n            and winlog.event_data.CommandLine : \"*socks5*\"\n            and winlog.event_data.CommandLine : \"*//st*\"\n            and winlog.event_data.CommandLine : \"//f*\"\n            and winlog.event_data.CommandLine : \"*rtcp*\"\n            and winlog.event_data.CommandLine : \"*mwss*\"\n        )\n    )","filters":[],"actions":[]}
{"id":"90d6ea7e-2a63-435b-9625-99aa83f5d1b1","updated_at":"2025-04-15T02:22:42.160Z","updated_by":"purple1","created_at":"2025-04-15T02:22:42.160Z","created_by":"purple1","name":"UC304 : Executable File or Script Created In SSH Directory (via file_event)","tags":["product: windows","category: file_event"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to stage their malicious files in ssh directory, in order to further execute them to perform malicious activity.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"80f8f86c-0db0-44d1-9a65-5b19df67d2da","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1036","name":"Masquerading","reference":"https://attack.mitre.org/techniques/T1036","subtechnique":[]}]}],"to":"now","references":["https://blog.talosintelligence.com/new-zardoor-backdoor/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and winlog.event_data.TargetFilename : \"*\\\\.ssh\\\\*\"\n  and winlog.event_data.TargetFilename in (\"*\\\\.exe\",\"*\\\\.bat\",\"*\\\\.cmd\",\"*\\\\.dll\",\"*\\\\.vbs\",\"*\\\\.js\")","filters":[],"actions":[]}
{"id":"24e5645c-5983-4339-8828-289fa0e7e661","updated_at":"2025-04-15T08:43:33.388Z","updated_by":"purple1","created_at":"2025-02-27T10:31:51.814Z","created_by":"elastic","name":"UC335 : System Processes Execution from Untypical Paths (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Rule to detect system processes execution from untypical paths, which can be an indicator of malicious activity.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"863daf2d-cf67-4c5e-95f5-753430fb578f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1036","name":"Masquerading","reference":"https://attack.mitre.org/techniques/T1036","subtechnique":[]},{"id":"T1055","name":"Process Injection","reference":"https://attack.mitre.org/techniques/T1055","subtechnique":[{"id":"T1055.012","name":"Process Hollowing","reference":"https://attack.mitre.org/techniques/T1055/012"}]}]}],"to":"now","references":["https://cert.gov.ua/article/2394117","https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/main/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml","https://blogs.vmware.com/security/2023/11/netsupport-rat-the-rat-king-returns.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and winlog.event_data.NewProcessName in (\"*\\\\svchost.exe\", \"*\\\\gpupdate.exe\", \"*\\\\taskhostw.exe\", \"*\\\\rundll32.exe\", \"*\\\\sc.exe\", \"*\\\\consent.exe\", \"*\\\\VSSVC.exe\", \"*\\\\sethc.exe\", \"*\\\\lsm.exe\", \"*\\\\dwm.exe\", \"*\\\\spoolsv.exe\", \"*\\\\csrss.exe\", \"*\\\\wininit.exe\", \"*\\\\fontdrvhost.exe\", \"*\\\\conhost.exe\", \"*\\\\ctfmon.exe\", \"*\\\\RuntimeBroker.exe\")\n  and not winlog.event_data.NewProcessName in (\"*\\\\Windows\\\\System32*\", \"*\\\\Windows\\\\SysWOW64*\")","filters":[],"actions":[]}
{"id":"467f2a7e-7ed1-4500-91c0-3eef6c0046d3","updated_at":"2025-04-09T11:21:56.803Z","updated_by":"purple1","created_at":"2025-04-09T11:21:56.803Z","created_by":"purple1","name":"UC185 : Hide Artifacts- Hidden Users","tags":["product: windows","service: system"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may use hidden users to hide the presence of user accounts they create or modify.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"14248c98-b6cd-4e88-95c3-4f75b986a6ab","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code : \"4688\" and winlog.event_data.NewProcessName : \"* %add%HKLM\\\\Software\\\\Microsoft\\\\WindowsNT\\\\CurrentVersion\\\\Winlogon\\\\SpecialAccounts\\\\Userlist%0% *\" ","filters":[],"actions":[]}
{"id":"56bac2c0-5adf-4e17-8974-bcd06233f4c3","updated_at":"2025-02-27T10:31:59.861Z","updated_by":"elastic","created_at":"2025-02-27T10:31:59.861Z","created_by":"elastic","name":"UC342 : Suspicious Defender Exclusions Modification (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may trick user into running something as admin so they can add an exclusion to AV product before decrypting payload.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"28e4b161-aee2-4599-b634-5808ff245187","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[{"id":"T1562.006","name":"Indicator Blocking","reference":"https://attack.mitre.org/techniques/T1562/006"}]}]}],"to":"now","references":["https://www.securonix.com/securonix-threat-labs-security-advisory-multistorm-leverages-python-based-loader-as-onedrive-utilities-to-drop-rat-payloads/","https://blog.sekoia.io/lucky-mouse-incident-response-to-detection-engineering/","https://app.any.run/tasks/675dbf95-ff70-41c3-bdf5-d995a6c77882/","https://research.checkpoint.com/2023/dotrunpex-demystifying-new-virtualized-net-injector-used-in-the-wild/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n      winlog.event_data.CommandLine : \"*Add*\" and winlog.event_data.CommandLine : \"*MpPreference*\" and winlog.event_data.CommandLine : \"*ExclusionPath*\"\n    )","filters":[],"actions":[]}
{"id":"c82286ab-493a-450b-baa9-8886d903a640","updated_at":"2025-04-17T02:52:39.745Z","updated_by":"purple1","created_at":"2025-02-25T04:08:19.157Z","created_by":"elastic","name":"UC026 : (Golden/Silver) Ticket Impersonate Attack","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Attack technique in AD, the attacker tries to obtain a silver ticket (service ticket) to bypass the login and authentication process on the system without the need for an account password.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"87862d4e-9d00-435a-a5ea-8a642122292c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1550","name":"Use Alternate Authentication Material","reference":"https://attack.mitre.org/techniques/T1550","subtechnique":[{"id":"T1550.003","name":"Pass the Ticket","reference":"https://attack.mitre.org/techniques/T1550/003"}]}]}],"to":"now","references":["https://book.hacktricks.xyz/windows/active-directory-methodology/silver-ticket#silver-ticket"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.ProcessName: \"*\\\\mimikatz.exe\"and winlog.event_data.CommandLine : \"* kerberos::golden *\"","filters":[],"actions":[]}
{"id":"805b6128-2175-424d-82aa-4e1cfa3ef8e9","updated_at":"2025-04-14T04:47:17.786Z","updated_by":"purple1","created_at":"2025-02-27T10:30:56.505Z","created_by":"elastic","name":"UC286 : Possible privilege escalation attack using Dllhost.exe","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects two processes that uses dllhost after an UAC Bypass was done. If you detect this activity in your environment you probably was victim of attackres and potentially of the LockBit Ransomware","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"9032f37b-805f-4938-8a2c-451e83790d34","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1218","name":"System Binary Proxy Execution","reference":"https://attack.mitre.org/techniques/T1218","subtechnique":[{"id":"T1218.003","name":"CMSTP","reference":"https://attack.mitre.org/techniques/T1218/003"}]}]}],"to":"now","references":["https://attack.mitre.org/techniques/T1218/","https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/","https://app.any.run/tasks/e8e682e8-6d7f-42c8-ad3f-6afa980a77e3/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.Image : \"*dllhost.exe\" and winlog.event_data.CommandLine : \"*Windows*\" and winlog.event_data.CommandLine : \"*DllHost.exe*\" and winlog.event_data.CommandLine : \"*Processid*\" and winlog.event_data.CommandLine in (\"* {3E5FC7F9-9A51-4367-9063-A120244FBEC7} *\", \"* {D2E7041B-2927-42fb-8E9F-7CE93B6DC937} *\")","filters":[],"actions":[]}
{"id":"e654adaa-8a56-41bc-ae2e-8e4e2f56fcbe","updated_at":"2025-04-08T08:28:42.549Z","updated_by":"purple1","created_at":"2025-04-08T08:28:42.549Z","created_by":"purple1","name":"UC037 : Registry Modify Execution","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected that attackers using reg.exe utility available on windows to add/edit/delete some registry on the system.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"994f6a5b-39f3-4c95-bda7-f004ecc0794f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and event.code : \"4688\" \n    and  winlog.event_data.NewProcessName : \"*\\\\reg.exe\"\n    and winlog.event_data.CommandLine in (\"* add *\",\"* delete *\")","filters":[],"actions":[]}
{"id":"964478a4-3a4f-43bd-910b-ce5f0acba4c4","updated_at":"2025-04-15T04:22:11.215Z","updated_by":"purple1","created_at":"2025-02-27T10:31:27.684Z","created_by":"elastic","name":"UC316 : CVE-2021-31979 CVE-2021-33771 Exploits","tags":["product: windows","category: registry_event"],"interval":"5m","enabled":true,"revision":3,"description":"Detects patterns as noticed in exploitation of Windows CVE-2021-31979 CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum","risk_score":99,"severity":"critical","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"fe5a4d15-b8e4-4b0d-af3e-336a006e1908","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[]}],"to":"now","references":["https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/","https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/ # lỗ hổng 0-day sử dụng chain từ trình duyệt tới Windows Exploit, cài đặt malware phía victims."],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and (winlog.event_data.TargetObject : \"* CLSID\\\\{CF4CC405-E2C5-4DDD-B3CE-5E7582D8C9FA}\\\\InprocServer32\\\\(Default)\"or winlog.event_data.TargetObject : \"* CLSID\\\\{7C857801-7381-11CF-884D-00AA004B2E24}\\\\InProcServer32\\\\(Default)\")\n    and not\n    (winlog.event_data.Details : \"* system32\\\\wbem\\\\wmiutils.dll\" or winlog.event_data.Details : \"* system32\\\\wbem\\\\wbemsvc.dll\")","filters":[],"actions":[]}
{"id":"c4134e30-9298-4e0b-8275-7e9ebcc6a8ee","updated_at":"2025-04-17T03:05:22.895Z","updated_by":"purple1","created_at":"2025-04-04T07:27:07.045Z","created_by":"purple1","name":"UC031 : WMI Execution","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detected the use of wmi tool to execute processes on local or remote systems, etc.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"c0890458-e126-408b-b4f9-1c17c891e32f","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1047","name":"Windows Management Instrumentation","reference":"https://attack.mitre.org/techniques/T1047","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1047/T1047.md#atomic-test-5---wmi-execute-local-process","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1047/T1047.md#atomic-test-6---wmi-execute-remote-process","https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md#atomic-test-10---application-uninstall-using-wmic"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\nand(winlog.event_data.NewProcessName : \"*/wmic.exe\" and winlog.event_data.CommandLine : \"* process call create *\"\n  or winlog.event_data.NewProcessName : \"*/wmic.exe\" and winlog.event_data.CommandLine : \"* call uninstall *\"\n  or winlog.event_data.ParentProcessName : \"*/wmic.exe\" and winlog.event_data.NewProcessName in (\"*/powershell.exe\", \"*/pwsh.exe\", \"*/cmd.exe\"))","filters":[],"actions":[]}
{"id":"589beb74-8163-4306-a0aa-6860d4fa82e2","updated_at":"2025-04-10T02:06:11.419Z","updated_by":"purple1","created_at":"2025-04-10T01:59:02.277Z","created_by":"purple1","name":"UC193 : Permission Groups Discovery (Domain Groups)","tags":["product: windows","category: ps_script"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a1b42011-a7ac-4a14-afd9-70fa47a57627","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1069","name":"Permission Groups Discovery","reference":"https://attack.mitre.org/techniques/T1069","subtechnique":[{"id":"T1069.002","name":"Domain Groups","reference":"https://attack.mitre.org/techniques/T1069/002"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\net.exe\" and winlog.event_data.CommandLine in (\"* localgroup*/do *\", \"* group*/do *\")\n    or event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\dsquery.exe\" and winlog.event_data.CommandLine : \"* group *\"\n    or event.code : \"4104\" and winlog.event_data.ScriptBlockText in ( \"* localgroup*/do *\", \"* group*/do *\", \"* dsquery*group *\", \"* get-ADPrincipalGroupMembership *\", \"* Find-LocalAdminAccess *\", \"* Find-DomainLocalGroupMember *\", \"* Invoke-EnumerateLocalAdmin *\", \"* Find-GPOComputerAdmin *\", \"* Get-NetGroupMember *\", \"* Get-NetGroup *\", \"* Get-ADUser *\", \"* AdFind.exe*objectcategory*group *\", \"* Get-AdGroup*-Filter *\", \"* adsisearcher*objectcategory*group *\"))","filters":[],"actions":[]}
{"id":"ff5d23d3-32e1-4294-9068-9d7e3b5e471b","updated_at":"2025-04-10T05:00:13.248Z","updated_by":"purple1","created_at":"2025-04-10T05:00:13.248Z","created_by":"purple1","name":"UC223 : Detects WMIC remote process execution","tags":["product: windows"],"interval":"5m","enabled":true,"revision":0,"description":"Detects WMIC remote process execution","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"638d590c-0d2e-4d1a-82e2-637c2a1e7a5a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1047","name":"Windows Management Instrumentation","reference":"https://attack.mitre.org/techniques/T1047","subtechnique":[]}]}],"to":"now","references":["https://redcanary.com/threat-detection-report/techniques/windows-management-instrumentation/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\wmic.exe\" and winlog.event_data.CommandLine in (\"* create *\", \"* /node: *\", \"* process *\", \"* call *\", \"* \\\\ldap *\", \"* ntdomain *\", \"* antivirusproduct *\", \"* useraccount get *\", \"* uninstall *\", \"* service *\", \"* csproduct *\", \"* stopservice *\", \"* startservice *\", \"* computersystem *\") and not winlog.event_data.CommandLine in (\"* /node:127.0.0.1 *\", \"* /node:localhost *\")\n    or event.code : \"4104\" and (winlog.event_data.ScriptBlockText in (\"* invoke-wmimethod *\", \"* get-wmiobject *\", \"* wmiclass *\") or winlog.event_data.ScriptBlockText : \"* Win32_Service *\" and winlog.event_data.ScriptBlockText : \"* DisplayName *\" and winlog.event_data.ScriptBlockText : \"* PathName *\" and winlog.event_data.ScriptBlockText : \"* StartMode *\")\n    or event.code : \"4688\" and winlog.event_data.ParentProcessName : \"*\\\\wmiprvse.exe\" and winlog.event_data.NewProcessName in (\"*\\\\rundll32.exe\", \"*\\\\msbuild.exe\", \"*\\\\powershell.exe\", \"*\\\\cmd.exe\",\"*\\\\mshta.exe\")\n    or event.code : \"4688\" and winlog.event_data.ParentProcessName in (\"*\\\\winword.exe\", \"*\\\\excel.exe\") and winlog.event_data.NewProcessName : \"*\\\\wmic.exe\"\n    )","filters":[],"actions":[]}
{"id":"1692ff14-c62f-4724-a18d-cee5e5e8a7af","updated_at":"2025-04-17T02:43:04.595Z","updated_by":"purple1","created_at":"2025-02-25T04:05:33.090Z","created_by":"elastic","name":"UC021 : Pass The Hash Attack","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":2,"description":"Attack techniques used in windows and on AD. The attacker authenticates to the remote service or server using either the NTLM hash or the LM hash without using a password.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"8754af85-6d82-4bba-b1c8-f1c0452e2af7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1550","name":"Use Alternate Authentication Material","reference":"https://attack.mitre.org/techniques/T1550","subtechnique":[{"id":"T1550.002","name":"Pass the Hash","reference":"https://attack.mitre.org/techniques/T1550/002"}]}]}],"to":"now","references":["https://book.hacktricks.xyz/windows/ntlm#pass-the-hash","https://blog.stealthbits.com/how-to-detect-pass-the-hash-attacks/","https://cyberwardog.blogspot.de/2017/04/chronicles-of-threat-hunter-hunting-for.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n  (event.code : \"4624\" and winlog.event_data.LogonType : \"9\" and winlog.event_data.LogonProcessName : \"seclogo\" and winlog.event_data.AuthenticationPackageName : \"Negotiate\"  \n    or event.code : \"4624\" and winlog.event_data.LogonType : \"3\" and winlog.event_data.SubjectUserSid : \"S-1-0-0-*\" and winlog.event_data.LogonProcessName : \"NtLmSsp\" and winlog.event_data.KeyLength : \"0\"\n    or winlog.event_data.ProcessName : \"*\\\\mimikatz.exe\" and winlog.event_data.CommandLine : \"* sekurlsa::pth *\")\n    and not winlog.event_data.TargetUserName : \"ANONYMOUS LOGON\"","filters":[],"actions":[]}
{"id":"2c30690c-ba5b-49b4-8f86-2fda5e80da85","updated_at":"2025-02-25T04:09:31.430Z","updated_by":"elastic","created_at":"2025-02-25T04:09:31.430Z","created_by":"elastic","name":"UC186 : Potential Svchost Memory Access","tags":["product: windows","category: process_access"],"interval":"5m","enabled":true,"revision":0,"description":"Detects potential access to svchost process memory such as that used by Invoke-Phantom to kill the winRM windows event logging service.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"115cec28-862d-4728-b909-7e91d97c471c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[{"id":"T1562.002","name":"Disable Windows Event Logging","reference":"https://attack.mitre.org/techniques/T1562/002"}]}]}],"to":"now","references":["https://github.com/hlldz/Invoke-Phant0m","https://twitter.com/timbmsft/status/900724491076214784"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and \n    (\n        winlog.event_data.TargetImage : \"*\\\\WINDOWS\\\\System32\\\\svchost.exe\"\n        and winlog.event_data.GrantedAccess : \"0x1F3FFF\"\n        and winlog.event_data.CallTrace : \"*UNKNOWN*\"\n    )\n    and not\n    (\n        (\n            winlog.event_data.SourceImage : \"C:\\\\Program Files\\\\Microsoft Visual Studio\\\\*\"\n            or winlog.event_data.SourceImage : \"*\\\\MSBuild\\\\Current\\\\Bin\\\\MSBuild.exe\"  \n        )\n        and\n        (\n            winlog.event_data.CallTrace : \"*Microsoft.Build.ni.dll*\"\n            or winlog.event_data.CallTrace : \"*System.ni.dll*\"\n        )\n    )\n","filters":[],"actions":[]}
{"id":"3ad4c19c-cf88-4e02-8e98-51abdc521bbf","updated_at":"2025-04-17T02:54:14.703Z","updated_by":"purple1","created_at":"2025-02-21T03:46:28.042Z","created_by":"purple1","name":"UC027 : Powershell Shellcode B64","tags":["category: process_creation","product: windows"],"interval":"5m","enabled":true,"revision":2,"description":"Detects Base64 encoded Shellcode","risk_score":99,"severity":"critical","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"cc597f42-21d6-4467-acc2-dcac82697bc9","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]}],"to":"now","references":["https://twitter.com/cyb3rops/status/1063072865992523776","https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_shellcode_b64.yml tags:"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code : \"4688\" and winlog.event_data.NewProcessName : \"*powershell.exe\" and winlog.event_data.CommandLine in (\"* FromBase64String *\", \"* ToBase64String *\", \"* -EncodedCommand *\", \"* -e *\", \"* -enc *\")","filters":[],"actions":[]}
{"id":"372c3221-c09d-45b4-b9b2-32df12af98d1","updated_at":"2025-04-16T07:57:05.519Z","updated_by":"purple1","created_at":"2025-04-16T07:57:05.519Z","created_by":"purple1","name":"UC359 : Possible Initial Access by detection of file with double extension in command (via Process creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"This rule detects when a process is created from the execution of a possible malicious email attachment sent as malspam or spear phishing attempts based on the most prevalent naming techniques and extensions.This rule would be ideal for hunting for phishing attacks that would have gone undetected","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a59192eb-d308-48f1-8c0d-3a3039546c41","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1566","name":"Phishing","reference":"https://attack.mitre.org/techniques/T1566","subtechnique":[{"id":"T1566.001","name":"Spearphishing Attachment","reference":"https://attack.mitre.org/techniques/T1566/001"},{"id":"T1566.002","name":"Spearphishing Link","reference":"https://attack.mitre.org/techniques/T1566/002"}]}]}],"to":"now","references":["https://app.any.run/tasks/b85b3d5a-3efc-4dc4-b284-37c400b26ebe/","https://app.any.run/tasks/ea3a10ab-9cfe-42f4-bc55-38845a51a454/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.CommandLine in (    \"* .pdf.exe *\", \"* .pdf.zip *\", \"* .pdf.7zp *\", \"* .pdf.arj *\", \"* .pdf.xz *\", \"* .pdf.gz *\", \"* .xls.zip *\", \"* .bat.rar *\", \"* .zip.xxe *\", \"* .xlsx.swf *\", \"* .iso.zip *\", \"* .xls.exe *\", \"* .xls.arj *\", \"* .xls.xz *\", \"* .bat.zip *\", \"* .tar.lz *\", \"* .tgz.scr *\", \"* .pdf.cab *\", \"* .one.zip *\", \"* .one.rar *\", \"* .one.arj *\", \"* .one.tar *\", \"* .one.xz *\", \"* .one.7z *\", \"* .pdf.lnk *\", \"* .rtf.lnk *\")","filters":[],"actions":[]}
{"id":"1b8978fb-bb53-41c6-a970-1ddd1740f5ad","updated_at":"2025-04-17T03:13:32.006Z","updated_by":"purple1","created_at":"2025-04-08T08:12:41.325Z","created_by":"purple1","name":"UC034 : Credential Dumping Suspicious Lsass Access","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detected that an attacker tries to obtain the licenses stored in the process memory LSASS.exe.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"64ba9863-19fb-4c61-8d3f-a7981774f945","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.001","name":"LSASS Memory","reference":"https://attack.mitre.org/techniques/T1003/001"}]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.001/T1003.001.md","https://twitter.com/mrd0x/status/1511415432888131586?s=20&t=DvVrzeZ1OcGiWowbhPV8Lg","https://twitter.com/mrd0x/status/1511489821247684615","https://github.com/audibleblink/xordump"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n      (\n        event.code : \"4688\" and\n        (\n          winlog.event_data.NewProcessName : \"*\\\\DumpMinitool.exe\"\n          or winlog.event_data.ParentProcessName : \"*\\\\DumpMinitool.exe\"\n          or winlog.event_data.CommandLine : \"* --processId *\" and winlog.event_data.CommandLine : \"* --dumpType Full *\"\n          or winlog.event_data.CommandLine in (\"* .dmp *\",\"* -process lsass.exe *\")\n          or winlog.event_data.NewProcessName : \"*\\\\dump64.exe\"\n          or winlog.event_data.CommandLine : \"* --ma *\" and winlog.event_data.CommandLine : \"* lsass.exe *\" \n          or winlog.event_data.ProcessName : \"rundll32.exe\" and winlog.event_data.CommandLine : \"* MiniDump *\" and winlog.event_data.CommandLine : \"* comsvcs.dll *\"\n          or winlog.event_data.NewProcessName in (\"*\\\\wce.exe\", \"*\\\\Outflank-Dumpert.exe\", \"*\\\\pypykatz\", \"*\\\\createdump.exe\")\n        )\n      )\n      or event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\adplus.exe\" and winlog.event_data.ParentProcessName : \"*\\\\Adplus.exe\" and winlog.event_data.CommandLine in (\"* -hang *\",\"* -pn *\",\"* -pmn *\",\"* -p *\",\"* -po *\",\"* -c *\",\"* -sc *\")\n      or event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\dump64.exe\" and not winlog.event_data.NewProcessName : \"*\\\\Installer\\\\Feedback\\\\dump64.exe\"\n    )","filters":[],"actions":[]}
{"id":"9de182bc-d347-467d-bea0-23bee01c29ad","updated_at":"2025-04-16T03:32:40.118Z","updated_by":"purple1","created_at":"2025-02-26T02:47:25.249Z","created_by":"purple1","name":"UC356:  Dump Active Directory Database with NTDSUtil","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"This rule is based on a test from Red Canary's Atomic Red Team","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"52f0aade-d056-4698-a132-8d74c93ceea7","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.003/T1003.003.md","https://attack.mitre.org/techniques/T1003/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and (winlog.event_data.NewProcessName : \"*\\\\mkdir.exe\" and winlog.event_data.CommandLine in (\"* mkdir *\", \"* mkdir C:\\\\Windows\\\\Temp\\\\ *\")\n    or winlog.event_data.NewProcessName : \"*\\\\ntdsutil.exe\" and winlog.event_data.CommandLine in (\"ntdsutil \\\"ac i ntds\\\" \\\"ifm\\\" \\\"create full *\\\" q q\", \"ntdsutil \\\"ac i ntds\\\" \\\"ifm\\\" \\\"create full C:\\\\Windows\\\\Temp\\\\*\\\" q q\")\n    or winlog.event_data.NewProcessName : \"*rmdir.exe*\" and winlog.event_data.CommandLine in (\"rmdir /q /s * >nul 2>&1\", \"rmdir /q /s C:\\\\Windows\\\\Temp\\\\* >nul 2>&1\"))","filters":[],"actions":[]}
{"id":"ed05f423-2330-4e72-a93d-b9046dc6cbee","updated_at":"2025-04-14T10:05:58.975Z","updated_by":"purple1","created_at":"2025-04-14T10:05:58.975Z","created_by":"purple1","name":"UC294 : Environment Variables in Command Line Arguments (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may use environment variables to resolve path or get information on victim system. Usually used by droppers.","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"235ab994-1c44-4902-8565-b57191eef2bf","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[]}]}],"to":"now","references":["https://www.infosecurity-magazine.com/news/signature-techniques-of-asian-apt/     - https://www.securonix.com/blog/threat-labs-security-advisory-new-starkvortex-attack-campaign-threat-actors-use-drone-manual-lures-to-deliver-merlinagent-payloads/","https://www.cisa.gov/sites/default/files/2023-09/joint-cybersecurity-advisory-stopransomware-snatch-ransomware_0.pdf","https://medium.com/@knownsec404team/suspected-apt37-new-attack-weapon-fakecheck-analysis-report-c54a6991dd46"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.CommandLine in (\"* %WINDIR% *\", \"* %ALLUSERSPROFILE% *\", \"* %COMSPEC% *\", \"* %HOMEPATH% *\", \"* %LOGONSERVER% *\", \"* %USERPROFILE% *\", \"* %HOMEPATH% *\", \"* %COMPUTERNAME% *\", \"* %PUBLIC% *\", \"* %TMP% *\", \"* %CONHOST% *\", \"* %TEMP% *\", \"* %USERNAME% *\", \"* %USERDOMAIN% *\", \"* %APPDATA% *\", \"* %LOCALAPPDATA% *\")\n    and not winlog.event_data.CommandLine in (\"* Signal.exe *\", \"* where.exe *\") and winlog.event_data.ParentProcessName in (\"* jetbrains *\", \"* xmind *\", \"*\\\\gitkraken.exe\", \"*\\\\_1st.exe\", \"*\\\\PowerENGAGE.exe\", \"*\\\\UiPath.Assistant.exe\", \"*\\\\LogiTune.exe\", \"*\\\\BlueMail.exe\", \"*\\\\Tomcat8.exe\", \"*\\\\TestReach.exe\", \"*\\\\iissetup.exe\", \"*\\\\Code.exe\", \"*\\\\DTAppInstaller.exe\", \"*\\\\node.exe\", \"*\\\\code.exe\", \"*\\\\Sky Go.exe\", \"*\\\\java.exe\", \"*\\\\WD Discovery.exe\", \"*\\\\GoSignDesktop.exe\", \"*\\\\KKBOX.exe\", \"*\\\\javaw.exe\", \"*\\\\OnVUE.exe\", \"*\\\\GitHubDesktop.exe\", \"*\\\\client.exe\", \"*\\\\Microsoft.Sara.exe\")","filters":[],"actions":[]}
{"id":"14d79058-9427-4d42-9594-b9e4977b3dc9","updated_at":"2025-02-25T04:10:46.505Z","updated_by":"elastic","created_at":"2025-02-25T04:10:46.505Z","created_by":"elastic","name":"UC373 : Active Directory Recon Without Admin Rights (Powershell detection)","tags":["product: windows","service: powershell"],"interval":"5m","enabled":true,"revision":0,"description":"This rule detected a possible recon attempt in order to establish the bases for a future attack. Anyone could make this kind of activity without the needing of admin privileges.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"242c00e0-c4ca-44c6-b862-b2b051bfbb65","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":["https://adsecurity.org/?p=2535","https://attack.mitre.org/techniques/T1086/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code : \"4104\" and(\n        winlog.event_data.ScriptBlockText : \"\\\\[System.DirectoryServices.ActiveDirectory.Forest\\\\]::GetCurrentForest\\\\()\" \n        or winlog.event_data.ScriptBlockText : \"\\\\[System.DirectoryServices.ActiveDirectory.Domain\\\\]::GetCurrentDomain()\" \n        or winlog.event_data.ScriptBlockText : \"get-aduser -filter {ServicePrincipalName -like \\\"*\\\"} -Properties PasswordLastSet,LastLogonDate,ServicePrincipalName,TrustedForDelegation,TrustForDelegation\" \n        or winlog.event_data.ScriptBlockText : \"get-aduser -filter {AdminCount -eq 1} -Properties Name,AdminCount,ServicePrincipalName,PasswordLastSet,LastLogonDate,MemberOf\" \n        or winlog.event_data.ScriptBlockText : \"get-adgroup -filter {GroupCategory -eq ‘Security’ -AND Name -like \\\"*admin*\\\"} - Get-ADDefaultDomainPasswordPolicy - Get-NetGPOGroup\" \n        or winlog.event_data.ScriptBlockText : \"Get-ADDefaultDomainPasswordPolicy\" \n        or winlog.event_data.ScriptBlockText : \"Get-NetGPOGroup\"\n    )","filters":[],"actions":[]}
{"id":"525a1299-bc1f-4327-9c51-0046990946cc","updated_at":"2025-04-17T03:11:32.980Z","updated_by":"purple1","created_at":"2025-04-08T05:13:21.367Z","created_by":"purple1","name":"UC032 : Credential Dumping Suspicious Windows Processes","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may use suspicious process to dump credential.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2d4874f7-57f6-476a-a0a6-a107c4367c2d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.001","name":"LSASS Memory","reference":"https://attack.mitre.org/techniques/T1003/001"},{"id":"T1003.002","name":"Security Account Manager","reference":"https://attack.mitre.org/techniques/T1003/002"},{"id":"T1003.006","name":"DCSync","reference":"https://attack.mitre.org/techniques/T1003/006"},{"id":"T1003.004","name":"LSA Secrets","reference":"https://attack.mitre.org/techniques/T1003/004"}]}]}],"to":"now","references":["https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/","https://github.com/antonioCoco/RemotePotato0/blob/main/README.md","https://lolbas-project.github.io/lolbas/Binaries/Rpcping/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n  (\n    event.code : \"4688\" and\n    (winlog.event_data.NewProcessName : \"*\\\\reg.exe\" and winlog.event_data.CommandLine : \"save\" and winlog.event_data.CommandLine : \"HKLM\\\\security\\\\policy\\\\secrets\"\n      or winlog.event_data.NewProcessName : \"*\\\\reg.exe\" and winlog.event_data.CommandLine in (\"HKLM\\\\sam\", \"HKLM\\\\system\", \"HKLM\\\\security\", \"hkey_local_machine\\\\sam\", \"hkey_local_machine\\\\system\", \"hkey_local_machine\\\\security\")\n      or winlog.event_data.NewProcessName : \"\\\\esentutl.exe\" and winlog.event_data.CommandLine : \"* y *\" and winlog.event_data.CommandLine : \"* vss *\"\n      or winlog.event_data.NewProcessName in (\"*\\\\pwdumpx.exe\", \"*\\\\mimikatz.exe\", \"*\\\\gsecdump.exe\", \"*\\\\wce.exe\", \"*\\\\Outflank-Dumpert.exe\", \"*\\\\createdump.exe\", \"*\\\\WerFault.exe\")\n      or winlog.event_data.CommandLine in (\"* sekurlsa::minidump *\", \"* sekurlsa::logonpasswords *\", \"* lsadump::sam *\")\n      or winlog.event_data.CommandLine : \"* -u *\" and winlog.event_data.CommandLine : \"* -f *\"\n      or winlog.event_data.CommandLine in (\"* DumpCreds *\", \"* invoke-mimikatz *\")\n    )\n    or\n    (\n      winlog.event_data.NewProcessName : \"*\\\\rpcping.exe\"\n      and winlog.event_data.CommandLine in (\"* -s *\", \"* /s *\")\n      and\n      (\n        (winlog.event_data.CommandLine : \"* -u *\" and winlog.event_data.CommandLine : \"* NTLM *\")\n        or (winlog.event_data.CommandLine : \"* /u *\" and winlog.event_data.CommandLine : \"* NTLM *\")\n        or (winlog.event_data.CommandLine : \"* -t *\" and winlog.event_data.CommandLine : \"* ncacn_np *\")\n        or (winlog.event_data.CommandLine : \"* -t *\" and winlog.event_data.CommandLine : \"* ncacn_np *\")\n      )\n    )\n    or event.code : \"4688\" and winlog.event_data.CommandLine in (\"* rpc* \", \"* token *\", \"* crypto *\", \"* dpapi *\", \"* sekurlsa *\", \"* kerberos *\", \"* lsadump *\", \"* privilege *\", \"* process *\", \" vault *\") and winlog.event_data.CommandLine : \"* :: *\"\n  )","filters":[],"actions":[]}
{"id":"451caf0f-54c2-4fdb-8460-235034b283cc","updated_at":"2025-02-25T04:12:43.710Z","updated_by":"elastic","created_at":"2025-02-25T04:12:43.710Z","created_by":"elastic","name":"UC352 : Download or Upload via Powershell (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects downloads via powershell.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"c55affda-770e-424e-b70e-74b407acc1bd","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1105","name":"Ingress Tool Transfer","reference":"https://attack.mitre.org/techniques/T1105","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code : \"4104\" and(\n        (\n            (\n            (winlog.event_data.Image :\"*.exe\") \n            and (winlog.event_data.CommandLine : \"*Web*\" and winlog.event_data.CommandLine : \"*Client*\" and winlog.event_data.CommandLine : \"*New-Object*\") \n            and (winlog.event_data.CommandLine : \"*.DownloadData*\" or winlog.event_data.CommandLine : \"*.DownloadString*\" or winlog.event_data.CommandLine : \"*.DownloadFile*\" or winlog.event_data.CommandLine : \"*.UploadString*\" or winlog.event_data.CommandLine : \"*.uploaddata*\")\n            )\n        or\n        (\n            (winlog.event_data.CommandLine : \"*iwr*\" and winlog.event_data.CommandLine : \"*http*\")\n            or (winlog.event_data.CommandLine : \"*irm*\" and winlog.event_data.CommandLine : \"*http*\")\n            or (winlog.event_data.CommandLine : \"*wget*\" and winlog.event_data.CommandLine : \"*http*\")\n            or (winlog.event_data.CommandLine : \"*invoke*\" and winlog.event_data.CommandLine : \"*webrequest*\" and winlog.event_data.CommandLine : \"*http*\")\n        )\n        )\n        and not\n        (\n            (winlog.event_data.ParentImage : \"*_1st.exe\" or winlog.event_data.ParentImage : \"*mssense.exe\")\n            or (winlog.event_data.Image : \"SenseNdr.exe\")\n            or (winlog.event_data.CommandLine : \"*crashpad_handler*\" and winlog.event_data.CommandLine : \"*database*\")\n            or (winlog.event_data.CommandLine : \"*chrome*\" and winlog.event_data.CommandLine : \"*single*\" and winlog.event_data.CommandLine : \"*argument*\")\n            or (winlog.event_data.CommandLine : \"*sysvol*\" and winlog.event_data.CommandLine : \"*Policies*\")\n            or (winlog.event_data.CommandLine : \"*slackb.com*\" and winlog.event_data.CommandLine : \"*WebRequest*\" and winlog.event_data.CommandLine : \"*Servicing_Channel*\")\n\n        )\n    )","filters":[],"actions":[]}
{"id":"e7c54cd1-70bd-46ae-a783-9f8639823a97","updated_at":"2025-04-17T03:31:36.333Z","updated_by":"purple1","created_at":"2025-02-25T04:08:32.167Z","created_by":"elastic","name":"UC035 : Credential Dumping Suspicious Lsass Access","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":1,"description":"Credential Dumping Suspicious Lsass Access","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e1e0440f-5413-4643-bbaa-d34272f65f97","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003.001/T1003.001.md","https://twitter.com/mrd0x/status/1511415432888131586?s=20&t=DvVrzeZ1OcGiWowbhPV8Lg","https://twitter.com/mrd0x/status/1511489821247684615","https://github.com/audibleblink/xordump"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n(event.code : \"4656\" and winlog.event_data. ObjectName : \"\\\\lsass.exe\" and winlog.event_data.AccessMask in (\"0x40\", \"0x1400\", \"0x1000\", \"0x100000\", \"0x1410 \", \"0x1010 \", \"0x1438 \", \"0x143a \", \"0x1418 \", \"0x1f0fff\", \"0x1f1fff\", \"0x1f2fff\", \"0x1f3fff\")\n  or event.code : \"4656\" and winlog.event_data. ObjectName : \"\\\\lsass.exe\" and winlog.event_data.AccessList in (\"4484\", \"4416\"))\nand not winlog.event_data.NewProcessName in (\"*\\\\wmiprvse.exe\", \"*\\\\taskmgr.exe\", \"*\\\\procexp64.exe\", \"*\\\\procexp.exe\", \"*\\\\lsm.exe\", \"*\\\\csrss.exe\", \"*\\\\wininit.exe\", \"*\\\\vmtoolsd.exe\", \"*\\\\minionhost.exe\" , \"*\\\\VsTskMgr.exe\", \"*\\\\thor64.exe\", \"C:\\\\Windows\\\\System32\\\\*\",\"C:\\\\Windows\\\\SysWow64\\\\*\", \"C:\\\\Windows\\\\SysNative\\\\*\",\"C:\\\\Program Files\\\\*\", \"C:\\\\Windows\\\\Temp\\\\asgard2-agent\\\\*\")","filters":[],"actions":[]}
{"id":"649213cd-01dc-460c-b84a-c2a29ea409cf","updated_at":"2025-04-15T03:18:35.123Z","updated_by":"purple1","created_at":"2025-02-21T03:36:17.856Z","created_by":"purple1","name":"UC307 : Possible Credential Dumping Using Windows Error Reporting","tags":["product: windows","category: registry_event"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries can abuse WerFault.exe (Windows Error Reporting process that handles process crashes) to create a memory dump of lsass.exe.\n","risk_score":99,"severity":"critical","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"421eb038-16ab-4ed0-b14c-38ecebb7524a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.001","name":"LSASS Memory","reference":"https://attack.mitre.org/techniques/T1003/001"}]}]}],"to":"now","references":["https://www.deepinstinct.com/2021/02/16/lsass-memory-dumps-are-stealthier-than-ever-before-part-2/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and \n  (winlog.event_data.TargetObject : \"* SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\lsass.exe *\" and winlog.event_data.Details : \"DWORD (0x00000200)\"\n    or winlog.event_data.TargetObject : \"* SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SilentProcessExit\\\\lsass.exe *\"\n    or winlog.event_data.TargetObject : \"* SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\\\\RunAsPPL *\"\n      and winlog.event_data.Details : \"DWORD (0x00000000)\")","filters":[],"actions":[]}
{"id":"5c07d4d5-f08e-4e53-b812-6cb3d417d8a9","updated_at":"2025-04-22T08:10:41.318Z","updated_by":"purple1","created_at":"2025-04-09T01:50:08.332Z","created_by":"purple1","name":"UC047 : Windows Discovery Processes","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detected attacker performs the spying on the process information running on the windows system.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e52f7dd3-aeff-4918-b662-41825317cb89","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1057","name":"Process Discovery","reference":"https://attack.mitre.org/techniques/T1057","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1047/T1047.md#atomic-test-2---wmi-reconnaissance-processes"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and ( winlog.event_data.NewProcessName : \"*\\\\wmic.exe\" and winlog.event_data.CommandLine : \"* process *\" or  winlog.event_data.NewProcessName in (\"*\\\\tasklist.exe\", \"*\\\\qprocess.exe\"))","filters":[],"actions":[]}
{"id":"4d3aeef2-4272-48c9-bb9e-f25b197ebccc","updated_at":"2025-04-10T04:45:27.036Z","updated_by":"purple1","created_at":"2025-04-10T04:45:27.036Z","created_by":"purple1","name":"UC221 : The Possibility of Execution Through Hidden PowerShell Command Lines (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"A generic hunting rule to identify commonly used combinations by adversaries in offensive PowerShell execution.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a81507fd-acca-4d09-8d9d-81b280c899af","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1564","name":"Hide Artifacts","reference":"https://attack.mitre.org/techniques/T1564","subtechnique":[{"id":"T1564.003","name":"Hidden Window","reference":"https://attack.mitre.org/techniques/T1564/003"}]}]}],"to":"now","references":["https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/Syssphinx-FIN8-backdoor","https://www.esentire.com/blog/operation-phantomcontrol","https://github.com/alt3kx/CVE-2023-24055_PoC","https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/Syssphinx-FIN8-backdoor","https://www.securonix.com/securonix-threat-labs-security-advisory-multistorm-leverages-python-based-loader-as-onedrive-utilities-to-drop-rat-payloads/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    winlog.event_data.NewProcessName : \"*\\\\.exe\" \n    and\n    (\n      winlog.event_data.CommandLine : \"* -bypass *\" and winlog.event_data.CommandLine : \"* -hidden *\" and winlog.event_data.CommandLine : \"* -UnRestricted *\"\n      or winlog.event_data.CommandLine : \"* -NoL *\" and winlog.event_data.CommandLine : \"* -noP *\"\n      or winlog.event_data.CommandLine : \"* -NonI *\" and winlog.event_data.CommandLine : \"* -noP *\"\n      or winlog.event_data.CommandLine : \"* -NoI *\" and winlog.event_data.CommandLine : \"* -noP *\"\n      or winlog.event_data.CommandLine : \"* -noni *\" and winlog.event_data.CommandLine : \"* -noe *\"\n      or winlog.event_data.CommandLine in (\"* -e *\", \"* -en *\", \"* -enc *\") and winlog.event_data.CommandLine in (\"* -noni *\", \"* -noe *\", \"* -noI *\", \"* -noP *\", \"* -NoL *\", \"* -version *\", \"* hidden *\")\n    )\n    and not\n    (\n    winlog.event_data.ParentProcessName in (\"* senseir.exe *\", \"* microsoftdependencyagent.exe *\", \"* ISServerExec.exe *\", \"* Lenovo.Modern.ImController.exe *\", \"* VMware.Hub.SfdAgent.DeployCmd.exe *\", \"* node.exe *\", \"* PBIDesktop.exe *\", \"* Microsoft.Management.Services.IntuneWindowsAgent.exe *\", \"* mgts-sw-install.exe *\")\n      and \n      (\n        winlog.event_data.CommandLine in (\"* AzureDefenderForServers *\", \"* AutorunsToWinEventLog *\", \"* PROD_SSIS_WORKING_DIR *\", \"* Scripts\\\\SFTP *\", \"* git.exe *\", \"* ReplaceOMCert *\")\n        or winlog.event_data.CommandLine : \"* renderer *\" and winlog.event_data.CommandLine : \"* sandbox *\"\n        or winlog.event_data.CommandLine : \"* JetBrains *\" and winlog.event_data.CommandLine : \"* PyCharm *\"\n        or winlog.event_data.CommandLine : \"* AppxPackage *\" and winlog.event_data.CommandLine : \"* .scratch*\"\n        or winlog.event_data.CommandLine : \"* G4AdABdADoAOgBPAFM *\" and winlog.event_data.CommandLine : \"* AVgBlAHIAcwBpAG8AbgAuAFYAZQBy *\" and winlog.event_data.CommandLine : \"* outputFormat *\" and winlog.event_data.CommandLine : \"* noninteractive *\" and winlog.event_data.CommandLine : \"* - encodedCommand *\"\n        or winlog.event_data.CommandLine : \"* Lenovo *\" and winlog.event_data.CommandLine : \"* iMController *\" and winlog.event_data.CommandLine : \"* ThinkAPSPackage *\"\n        or winlog.event_data.CommandLine : \"* AppxProvisionedPackage *\" and winlog.event_data.CommandLine : \"* Office.Deprovision *\"\n        or winlog.event_data.CommandLine : \"* NoProfile *\" \n      )\n    )","filters":[],"actions":[]}
{"id":"41043828-566f-41d1-8d1b-cd508235cf13","updated_at":"2025-04-16T01:52:24.486Z","updated_by":"purple1","created_at":"2025-02-27T10:31:57.846Z","created_by":"elastic","name":"UC340 : Possible SAM/SYSTEM/SECURITY Dumping (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Creation of symbolic link to sensitive files within shadow copies (aka volume snapshots) via mklink or similar utility\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"02c18511-23e6-47ac-9f10-7090417d5a92","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1552","name":"Unsecured Credentials","reference":"https://attack.mitre.org/techniques/T1552","subtechnique":[{"id":"T1552.002","name":"Credentials in Registry","reference":"https://attack.mitre.org/techniques/T1552/002"}]},{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.003","name":"NTDS","reference":"https://attack.mitre.org/techniques/T1003/003"}]}]}],"to":"now","references":["https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-038a","https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html","https://cert.gov.ua/article/39518"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    ((\n        (winlog.event_data.CommandLine in (\"* ntds.dit *\", \"* \\\\system32\\\\config\\\\sam *\", \"* \\\\system32\\\\config\\\\security *\", \"* \\\\system32\\\\config\\\\system *\")\n        or winlog.event_data.CommandLine : \"* reg *\" and winlog.event_data.CommandLine : \"* save *\" and winlog.event_data.CommandLine : \"* HKLM\\\\SYSTEM *\"\n        or winlog.event_data.CommandLine : \"* reg *\" and winlog.event_data.CommandLine : \"* save *\" and winlog.event_data.CommandLine : \"* HKLM\\\\SAM *\"\n        or winlog.event_data.CommandLine : \"* reg *\" and winlog.event_data.CommandLine : \"* save *\" and winlog.event_data.CommandLine : \"* HKLM\\\\SECURITY *\")\n        and not (winlog.event_data.CommandLine : \"* config *\" and winlog.event_data.CommandLine : \"* systemprofile *\" and winlog.event_data.NewProcessName : \"*\\\\cacls.exe\")\n      )\n      or winlog.event_data.CommandLine : \"* mklink *\" and winlog.event_data.CommandLine : \"* HarddiskVolumeShadowCopy *\"\n      or winlog.event_data.CommandLine in (\"* UnattendedInstallFile *\", \"* Get-Webconfig *\", \"* Get-ApplicationHost *\", \"* SiteListPassword *\", \"* CachedGPPPassword *\", \"* RegistryAutoLogon *\")\n      or (winlog.event_data.NewProcessName : \"*reg.exe\" and winlog.event_data.CommandLine : \"* save *\"\n        and winlog.event_data.CommandLine in (\"* hklm\", \"* HKLM *\", \"* hkey_local_machine *\")\n        and winlog.event_data.CommandLine in (\"* system\", \"* SYSTEM *\", \"* sam *\", \"* SAM *\", \"* security *\", \"* SECURITY *\")))","filters":[],"actions":[]}
{"id":"d87f311c-bd0a-4b5b-aeb0-e361d7ce29f4","updated_at":"2025-02-27T10:31:49.808Z","updated_by":"elastic","created_at":"2025-02-27T10:31:49.808Z","created_by":"elastic","name":"UC332 : Detect MavInject32.exe (Microsoft Corp Signed) execution","tags":["service: sysmon","product: windows"],"interval":"5m","enabled":true,"revision":0,"description":"This rule detects execution and usage MavInject32.exe (Microsoft Corp Signed) that allows to load any dll in a running process.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":["Eugene Nechiporenko, SOC Prime"],"false_positives":[],"from":"now-360s","rule_id":"636bd683-5d9c-4e0d-a2ad-8ea62cf8e5da","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n        (\n            event.code : \"1\" \n            and winlog.event_data.ParentImage : \"*cmd.exe\" \n            and winlog.event_data.Image : \"C:\\\\Program Files\\\\Common Files\\\\microsoft shared\\\\ClickToRun\\\\MavInject32.exe\"\n        )\n        or \n        (\n            (\n                event.code : \"1\" \n                and winlog.event_data.ParentImage : \"*cmd.exe\" \n                and winlog.event_data.CommandLine : \"*\\\\MavInject32.exe*\"\n            )\n            and\n            (\n                winlog.keywords : \"INJECTRUNNING\"\n            )\n        )       \n    )","filters":[],"actions":[]}
{"id":"fb98ccac-ea05-46d4-b286-61db01a55a23","updated_at":"2025-03-26T02:27:35.506Z","updated_by":"purple1","created_at":"2025-03-25T02:37:22.257Z","created_by":"elastic","name":"UC210 : Detect bind shell","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Detect bind shell over Netcat","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"b1cb3c2c-83fd-4d42-a7e3-86fef96c99a1","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[]}]}],"to":"now","references":["https://www.hackingtutorials.org/networking/hacking-netcat-part-2-bind-reverse-shells/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.kind : \"event\"\n    and event.action : \"execve\"\n    and \n    (\n        (\n            process.args like \"nc\" and process.args like \"-e\"\n            and\n            (\n                process.args like \"/bin/bash\" or process.args like \"/bin/sh\"\n            )\n        )\n        or\n        (\n            process.args like \"ncat\" and process.args like \"-e\"\n            and\n            (\n                process.args like \"/bin/bash\" or process.args like \"/bin/sh\"\n            )\n        )\n\n    )\n    and\n    (\n        process.args like \"l\" and process.args like \"v\" and process.args like \"p\"\n    )","filters":[],"actions":[]}
{"id":"24437a09-ac86-4be8-8e7d-c4b1f1025745","updated_at":"2025-04-10T09:52:02.676Z","updated_by":"purple1","created_at":"2025-02-27T10:30:42.383Z","created_by":"elastic","name":"UC253 : Possible Abuse of Windows Themes [CVE-2023-38146 aka ThemeBleed] (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Malicious theme files (related to PoC of CVE-2023-38146 aka themebleed) could be used for arbitrary code execution in a phishing chain to gain access to the victim's host.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":["- Legitimate themes operation by user."],"from":"now-360s","rule_id":"d2cdf415-3544-484f-b2fe-1ff15e48eb9a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1204","name":"User Execution","reference":"https://attack.mitre.org/techniques/T1204","subtechnique":[{"id":"T1204.002","name":"Malicious File","reference":"https://attack.mitre.org/techniques/T1204/002"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0001","name":"Initial Access","reference":"https://attack.mitre.org/tactics/TA0001"},"technique":[{"id":"T1566","name":"Phishing","reference":"https://attack.mitre.org/techniques/T1566","subtechnique":[{"id":"T1566.001","name":"Spearphishing Attachment","reference":"https://attack.mitre.org/techniques/T1566/001"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.NewProcessName : \"*\\\\rundll32.exe\"\n    and (winlog.event_data.CommandLine : \"* themecpl.dll *\" and winlog.event_data.CommandLine : \"* OpenThemeAction *\" and winlog.event_data.CommandLine : \"* .theme *\" or winlog.event_data.CommandLine : \"* desk.cpl *\" and winlog.event_data.CommandLine : \"* Control_RunDLL *\" and winlog.event_data.CommandLine : \"* Themes *\" and winlog.event_data.CommandLine : \"* OpenTheme *\" and winlog.event_data.CommandLine : \"* .theme *\")","filters":[],"actions":[]}
{"id":"78096436-511b-4c79-b8b3-5f4924dc2c8a","updated_at":"2025-04-09T03:45:51.218Z","updated_by":"purple1","created_at":"2025-04-09T03:45:51.218Z","created_by":"purple1","name":"UC058 : Signed Binary Proxy Execution Mshta","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attacker can abuse mshta.exe as a proxy to execute malicious .hta files and Javascript or VBScript.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e45fc37d-9e99-4f45-9b2b-fda0da228ae1","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1218","name":"System Binary Proxy Execution","reference":"https://attack.mitre.org/techniques/T1218","subtechnique":[{"id":"T1218.005","name":"Mshta","reference":"https://attack.mitre.org/techniques/T1218/005"}]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1218.005/T1218.005.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and (winlog.event_data.NewProcessName : \"*\\\\mshta.exe\" and winlog.event_data.CommandLine in (\"* vbscript: *\", \"* javascript: *\"))","filters":[],"actions":[]}
{"id":"cfabf0f7-380a-4c16-88f7-3ac3b5a8cdc8","updated_at":"2025-02-27T10:31:41.743Z","updated_by":"elastic","created_at":"2025-02-27T10:31:41.743Z","created_by":"elastic","name":"UC324 : Possible ReverseShell HackTool Activity (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Possible PowerShell ReverseTCP Shell - Framework.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e5c5008e-e5cb-4ea3-b146-cfef9f2b2563","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]}],"to":"now","references":["https://github.com/ZHacker13/ReverseTCPShell"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n      (\n        winlog.event_data.CommandLine : \"*EChO*\" and winlog.event_data.CommandLine : \"*iex*\" and winlog.event_data.CommandLine : \"*joIN*\"\n      )\n      or\n      (\n        winlog.event_data.CommandLine : \"*FrOMBAsE64sTRiNg*\" and winlog.event_data.CommandLine : \"*iex*\" and winlog.event_data.CommandLine : \"*EnCODiNG*\"\n      )\n      or\n      (\n        winlog.event_data.CommandLine : \"*FrOMBAsE64sTRiNg*\" and winlog.event_data.CommandLine : \"*Invoke-Expression*\" and winlog.event_data.CommandLine : \"*EnCODiNG*\"\n      )\n    )","filters":[],"actions":[]}
{"id":"762fd8c7-ae23-4531-bbad-f73a0e64ad1a","updated_at":"2025-04-15T07:47:48.552Z","updated_by":"purple1","created_at":"2025-04-15T07:47:48.552Z","created_by":"purple1","name":"UC326 : Possible Command and Control by Console Spawning Remote Desktop Connection (mstsc.exe) (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects spawning of Remote Desktop Connection (mstsc.exe) from console applications such as Powershell or Command Prompt.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"91821c22-0d63-4416-84d8-e0521daf6d12","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1021","name":"Remote Services","reference":"https://attack.mitre.org/techniques/T1021","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1219","name":"Remote Access Software","reference":"https://attack.mitre.org/techniques/T1219","subtechnique":[]}]}],"to":"now","references":["https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"  any where host.os.type : \"windows\"\n    and winlog.event_data.ParentProcessName in (\"*\\\\powershell.exe\", \"*\\\\cmd.exe\")\n    and winlog.event_data.NewProcessName : \"*\\\\mstsc.exe\"\n    and winlog.event_data.CommandLine : \"* .rdp *\"","filters":[],"actions":[]}
{"id":"ee2c77d8-f32d-4515-b0e4-130823448f28","updated_at":"2025-04-14T09:50:46.710Z","updated_by":"purple1","created_at":"2025-02-27T10:31:02.588Z","created_by":"elastic","name":"UC293 : 10-Strike Network Inventory Explorer - Unquoted Service Path","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects 10-Strike Network Inventory Explorer for Windows Unquoted Search\n  Path explotation","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"96fadda3-976d-4375-98bb-f2d96939bee2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1036","name":"Masquerading","reference":"https://attack.mitre.org/techniques/T1036","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (event.code : \"1\" and winlog.event_data.Image in (\"C:\\\\InventoryWebServer.exe\", \"C:\\\\Program Files\\\\InventoryWebServer.exe\")\n      or event.code : \"11\" and winlog.event_data.TargetFilename in (\"C:\\\\InventoryWebServer.exe\", \"C:\\\\Program Files\\\\InventoryWebServer.exe\"))","filters":[],"actions":[]}
{"id":"f40b3903-1b5c-496f-b4a5-73cdc667b145","updated_at":"2025-04-09T03:48:42.247Z","updated_by":"purple1","created_at":"2025-04-09T03:48:42.247Z","created_by":"purple1","name":"UC060 : Windows File Atrribute Modification","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects that an attacker tries to change the file/folder properties","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e2388b8f-a4df-4663-bf24-ddea80a4986b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\attrib.exe\" and winlog.event_data.CommandLine in (\"* +s *\", \"* +h *\")","filters":[],"actions":[]}
{"id":"0728c15b-aca2-4616-ad7d-5182d1cb81c9","updated_at":"2025-04-10T07:24:27.651Z","updated_by":"purple1","created_at":"2025-02-27T10:30:26.252Z","created_by":"elastic","name":"UC233 : Potential CVE-2022-29072 Exploitation Attempt","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":2,"description":"Detects potential exploitation attempts of CVE-2022-29072, a 7-Zip privilege escalation and command execution vulnerability. 7-Zip version 21.07 and earlier on Windows allows privilege escalation (CVE-2022-29072) and command execution when a file with the .7z extension is dragged to the Help>Contents area. This is caused by misconfiguration of 7z.dll and a heap overflow. The command runs in a child process under the 7zFM.exe process.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"46a1682e-1e84-43e0-b3bb-fdb7ee823900","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":["https://github.com/kagancapar/CVE-2022-29072","https://twitter.com/kagancapar/status/1515219358234161153"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.ParentImage : \"*7zFM.exe*\"  and winlog.event_data.Image : \"*cmd.exe*\" and winlog.event_data.OriginalFileName : \"*cmd.exe*\" and not winlog.event_data.CommandLine in (\"*/c*\", \"*/k*\", \"*/r*\")","filters":[],"actions":[]}
{"id":"f3d65f64-8aab-4f2f-8cf1-68221972e9c8","updated_at":"2025-04-14T04:53:26.882Z","updated_by":"purple1","created_at":"2025-02-27T10:30:58.548Z","created_by":"elastic","name":"UC287 : Possible Search / Search-MS URI Protocol Handler Abuse (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may Search or Search-MS URI Protocoll to execute malicious payload on host.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2aff68c3-56c3-4f0c-803e-fafbb61912d4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1204","name":"User Execution","reference":"https://attack.mitre.org/techniques/T1204","subtechnique":[{"id":"T1204.001","name":"Malicious Link","reference":"https://attack.mitre.org/techniques/T1204/001"},{"id":"T1204.002","name":"Malicious File","reference":"https://attack.mitre.org/techniques/T1204/002"}]},{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"},{"id":"T1059.003","name":"Windows Command Shell","reference":"https://attack.mitre.org/techniques/T1059/003"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1218","name":"System Binary Proxy Execution","reference":"https://attack.mitre.org/techniques/T1218","subtechnique":[{"id":"T1218.010","name":"Regsvr32","reference":"https://attack.mitre.org/techniques/T1218/010"}]}]}],"to":"now","references":["https://cert.gov.ua/article/6276894","https://www.proofpoint.com/us/blog/threat-insight/battleroyal-darkgate-cluster-spreads-email-and-fake-browser-updates","https://research.checkpoint.com/2023/abusing-microsoft-access-linked-table-feature-to-perform-ntlm-forced-authentication-attacks/","https://blog.talosintelligence.com/qakbot-affiliated-actors-distribute-ransom/","https://x.com/anyrun_app/status/1703738919576109347"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and winlog.event_data.ParentProcessName : \"*\\\\explorer.exe\"\n    and winlog.event_data.NewProcessName in (\"*\\\\regsvr32.exe\", \"*\\\\powershell.exe\", \"*\\\\wscript.exe\", \"*\\\\cscript.exe\", \"*\\\\cmd.exe\", \"*\\\\mshta.exe\", \"*\\\\hh.exe\", \"*\\\\explorer.exe\")\n    and ( winlog.event_data.CommandLine in (\"* DavWWWRoot *\", \"* webdav *\")\n      or winlog.event_data.CommandLine : \"* @80\\\\ *\" and winlog.event_data.CommandLine : \"* \\\\ *\"\n      or winlog.event_data.CommandLine : \"* @SSL\\\\ *\" and winlog.event_data.CommandLine : \"* \\\\ *\")","filters":[],"actions":[]}
{"id":"60d6f7ad-75ea-4392-8d92-e20aeafa54d5","updated_at":"2025-04-09T04:07:03.556Z","updated_by":"purple1","created_at":"2025-04-09T04:07:03.556Z","created_by":"purple1","name":"UC063 : Add/Modify Scheduled Task","tags":["product: windows","category: process_creation","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detected an attacker trying to create or change taskschedules on windows","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"615ed08d-5aa9-41ce-a9ee-373230bd0833","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and (\n    winlog.event_data.NewProcessName : \"*\\\\schtasks.exe\" and winlog.event_data.CommandLine : \"* create *\"\n    or winlog.event_data.NewProcessName : \"*\\\\at.exe\" \n    or winlog.event_data.NewProcessName : \"*\\\\schtasks.exe\" and winlog.event_data.CommandLine : \"* /delete *\" and winlog.event_data.CommandLine : \"* /tn \\\\* *\" and winlog.event_data.CommandLine : \"* /f *\"\n    or event.code in (\"4698\",\"4699\"))","filters":[],"actions":[]}
{"id":"fd5367ab-c394-4d43-9ffb-c7146d8fbc85","updated_at":"2025-04-17T02:15:00.023Z","updated_by":"purple1","created_at":"2025-04-17T02:15:00.023Z","created_by":"purple1","name":"UC383 : Possible Command Execution via SQL Extended Stored Procedure xp_cmdshell (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Identifying potential command execution by utilizing the SQL extended stored procedure xp_cmdshell. A cyber attacker may use this method to execute arbitrary commands and potentially gain control of the system. One possible method for achieving this would be to download a program controlled by the attacker through mechanisms like curl or ftp and subsequently executing it.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"323b55d3-12b9-4186-b432-debfc7c46a92","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.horizon3.ai/attack-research/cve-2023-48788-fortinet-forticlientems-sql-injection-deep-dive/","https://labs.withsecure.com/publications/fin7-target-veeam-servers","https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \nand winlog.event_data.ParentProcessName in (\"*\\\\sqlservr.exe\", \"*\\\\sqlagent.exe\", \"*\\\\sqlps.exe\", \"*\\\\sqldumper.exe\")\nand winlog.event_data.NewProcessName in (\"*\\\\cmd.exe\", \"*\\\\taskkill.exe\", \"*\\\\mofcomp.exe\", \"*\\\\powershell.exe\",\"*\\\\certutil.exe\", \"*\\\\regsvr32.exe\", \"*\\\\rundll32.exe\", \"*\\\\cscript.exe\") ","filters":[],"actions":[]}
{"id":"53ea9c4c-63f4-4c59-8f3d-3ea92a2fa917","updated_at":"2025-02-25T04:09:10.208Z","updated_by":"elastic","created_at":"2025-02-25T04:09:10.208Z","created_by":"elastic","name":"UC085 : Suspicious Stop Windows Service","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects the usage of one of the the commands to stop services using powershell","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":["- Legitimate actions from administrators"],"from":"now-360s","rule_id":"d5dab169-66c8-4d97-ae0c-fbb7e84f1647","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]}],"to":"now","references":["https://www.trendmicro.com/content/dam/trendmicro/global/en/research/22/h/ransomware-actor-abuses-genshin-impact-anti-cheat-driver-to-kill-antivirus/Genshin%20Impact%20Figure%2010.jpg","https://www.trellix.com/en-sg/about/newsroom/stories/threat-labs/lockergoga-ransomware-family-used-in-targeted-attacks.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n        (winlog.event_data.Image : \"*powershell.exe\" or winlog.event_data.Image : \"*pwsh.exe\")\nand winlog.event_data.CommandLine : \"*Stop-Service*\"\n    )","filters":[],"actions":[]}
{"id":"f0ea38d3-e299-43f4-8918-6364eb86ff0d","updated_at":"2025-04-09T04:22:28.792Z","updated_by":"purple1","created_at":"2025-04-09T04:22:28.792Z","created_by":"purple1","name":"UC067 : XSL File Processing","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Extensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files. Rule detects when adversaries abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"be30239b-950f-4ee0-b801-919e633e8bef","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1220","name":"XSL Script Processing","reference":"https://attack.mitre.org/techniques/T1220","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1220/T1220.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and (winlog.event_data.NewProcessName : \"*\\\\wmic.exe\" and winlog.event_data.CommandLine in (\"* /format *\", \"* -format *\") and not winlog.event_data.CommandLine in (\"* Format:List *\", \"* Format:htable *\", \"* Format:hform *\", \"* Format:table *\", \"* Format:mof *\", \"* Format:value *\", \"* Format:rawxml *\", \"* Format:xml *\", \"* Format:csv *\") or winlog.event_data.NewProcessName : \"*\\\\msxsl.exe\")","filters":[],"actions":[]}
{"id":"1b9ec348-7863-41ee-a087-5a9382526aff","updated_at":"2025-04-21T01:40:43.236Z","updated_by":"purple1","created_at":"2025-03-25T02:36:15.635Z","created_by":"elastic","name":"UC103 : Lateral Tools Transfer ","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may transfer tools or other files between systems in a compromised environment. Files may be copied from one system to another to stage adversary tools or other files over the course of an operation.\n","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":["Legitimate administration activities"],"from":"now-360s","rule_id":"bbc32704-6eee-4c99-8dd6-506b431b3f64","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1570","name":"Lateral Tool Transfer","reference":"https://attack.mitre.org/techniques/T1570","subtechnique":[]}]}],"to":"now","references":["https://attack.mitre.org/techniques/T1570","https://github.com/SigmaHQ/sigma/blob/master/rules/linux/lnx_file_copy.yml"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.executable in (\"scp\", \"rsync\", \"sftp\")","filters":[],"actions":[]}
{"id":"f01c7b37-1f9b-4a49-a340-911d01efb166","updated_at":"2025-03-25T04:09:39.866Z","updated_by":"purple1","created_at":"2025-03-25T02:36:27.846Z","created_by":"elastic","name":"UC156 : Detect edit of .bash_profile and .bashrc","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Detects change of user environment. Adversaries can insert code into these files to gain persistence each time a user logs in or opens a new shell","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"9896275d-53eb-4e31-b1e8-ce18716b73c2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1546","name":"Event Triggered Execution","reference":"https://attack.mitre.org/techniques/T1546","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.args in (\"/root/.bashrc\", \"root/.bash_profile\", \"root/.profile\", \"home/*/.bashrc\", \"home/*/.bash_profile\", \"home/*/.profile\", \"etc/profile\", \"etc/shells\", \"etc/bashrc\", \"etc/csh.cshrc\", \"etc/csh.login\")","filters":[],"actions":[]}
{"id":"65a77e36-8e04-408f-b41f-237efa7ca11d","updated_at":"2025-03-25T04:11:05.885Z","updated_by":"purple1","created_at":"2025-03-25T02:36:29.016Z","created_by":"elastic","name":"UC157 : Unsecured Credentials Private Keys","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"f5a6ab33-e0b9-4c9c-83f7-94fcfe46abac","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1552","name":"Unsecured Credentials","reference":"https://attack.mitre.org/techniques/T1552","subtechnique":[{"id":"T1552.004","name":"Private Keys","reference":"https://attack.mitre.org/techniques/T1552/004"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.args in (\"rootkey\", \"userkey\", \"privatekey\")","filters":[],"actions":[]}
{"id":"f28a29d1-414c-4fae-a4bf-a78ef0d9ae84","updated_at":"2025-03-25T04:14:29.938Z","updated_by":"purple1","created_at":"2025-03-25T02:36:30.003Z","created_by":"elastic","name":"UC158 : Create or Modify System Process Systemd Service","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may create or modify systemd services to repeatedly execute malicious payload as part of persistence. Systemd is a system and service manager commonly used for managing background deamon processes (also know as services) and other system resources","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"5fe757f0-4fd1-4648-b789-f7ff19247c49","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action : \"execve\"\n    and process.args in (\"/usr/lib/systemd/system/*\", \"/etc/systemd/system/*\", \"*/.config/systemd/user/*\")","filters":[],"actions":[]}
{"id":"d711ff23-d617-4eb1-8fba-b4f6448e8713","updated_at":"2025-04-22T03:28:46.507Z","updated_by":"purple1","created_at":"2025-02-27T10:31:21.664Z","created_by":"elastic","name":"UC314 : LOLBAS RunDLL32 (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":2,"description":"Detects use of rundll32 as a living off the land technique by looking for calls to suspicious exports in commonly abused LOLBAS DLLs","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2c2bda9b-19c3-40b7-bbfe-5c9012642397","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":["https://unit42.paloaltonetworks.com/turla-pensive-ursa-threat-assessment/","https://www.fortinet.com/blog/threat-research/ukrainian-excel-file-delivers-multi-stage-cobalt-strike-loader"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n      (winlog.event_data.NewProcessName : \"*\\\\rundll32.exe\"\n        and winlog.event_data.CommandLine in (\"* WaitForExplorerRestart *\", \"* FromBase64String *\", \"* RunHTMLApplication *\", \"* RegisterOCX *\", \"* OpenURL *\", \"* PrintHTML *\", \"* LaunchApplication *\", \"* InstallHinfSection *\", \"* SetupInfObjectInstallAction *\", \"* RouteTheCall *\", \"* LoadHta *\") \n        and not (winlog.event_data.CommandLine in (\"* \\\\Program Files *\", \"* LaunchINFSectionEx *\") and winlog.event_data.ParentProcessName : \"*\\\\ie4uinit.exe\"))\n      or \n      (winlog.event_data.NewProcessName : \"*\\\\rundll32.exe\"\n        and winlog.event_data.CommandLine in (\"* Control_RunDLL*\", \"* ShellExec_RunDLL*\")\n        and winlog.event_data.CommandLine in (\"* .exe\",\"* .htm\",\"* .txt\",\"* .png\",\"* .jpeg\",\"* .jpg\",\"* .pdf\",\"* .xml\",\"* .doc\",\"* .xls\",\"* .log\",\"* .tmp\",\"* .dat\",\"* .lnk\")))","filters":[],"actions":[]}
{"id":"728e89ff-8325-404a-b86e-4203fd0bd77e","updated_at":"2025-04-15T08:07:21.812Z","updated_by":"purple1","created_at":"2025-04-15T08:07:21.812Z","created_by":"purple1","name":"UC330 : Environment Path Changes (via registry_event)","tags":["product: windows","category: registry_event"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may execute their own malicious payloads by hijacking environment variables used to load libraries.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"eb9ea32b-35ae-484e-962f-67557ced44ae","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1574","name":"Hijack Execution Flow","reference":"https://attack.mitre.org/techniques/T1574","subtechnique":[{"id":"T1574.007","name":"Path Interception by PATH Environment Variable","reference":"https://attack.mitre.org/techniques/T1574/007"}]}]}],"to":"now","references":["https://cert.gov.ua/article/37815"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and winlog.event_data.TargetObject in (\"* HKEY_LOCAL_MACHINE *\", \"* HKML *\", \"* HKEY_CURRENT_USER *\", \"* HKCU *\")\n  and (winlog.event_data.TargetObject : \"* CurrentControlSet *\" and winlog.event_data.TargetObject : \"* Environment *\" and winlog.event_data.TargetObject : \"* SYSTEM *\" or winlog.event_data.TargetObject : \"* \\\\Environment *\")","filters":[],"actions":[]}
{"id":"7d38d047-7e1d-4f63-8c24-16c844e62cb7","updated_at":"2025-03-25T02:56:44.857Z","updated_by":"purple1","created_at":"2025-03-25T02:36:54.115Z","created_by":"elastic","name":"UC173 : Network Service Scanning","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"46527c49-9c66-4e5a-ba61-303d9c24d7e5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"syscall\"\n        and\n        (\n            process.executable : \"*/telnet\"\n            or process.executable : \"*/netcat\"\n            or process.executable : \"*/nc\"\n            or process.executable : \"*/nmap\"\n        )","filters":[],"actions":[]}
{"id":"1a7c8976-8eff-4e0c-8092-de14f55eabf3","updated_at":"2025-03-25T02:36:25.997Z","updated_by":"elastic","created_at":"2025-03-25T02:36:25.997Z","created_by":"elastic","name":"UC155 : Obfuscated Files or Information Steganography","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may use steganography techniques in order to prevent the detection of hidden information. Steganographic techniques can be used to hide data in digital media such as images, audio tracks, video clips, or text files.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2c4959d3-9f7c-4a14-b3ab-6f07d545e361","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1027","name":"Obfuscated Files or Information","reference":"https://attack.mitre.org/techniques/T1027","subtechnique":[{"id":"T1027.003","name":"Steganography","reference":"https://attack.mitre.org/techniques/T1027/003"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action : \"execve\"\n    and process.executable : \"cat\"\n    and process.args : \"zip\"\n    and process.args in (\"jpg\",\"png\")","filters":[],"actions":[]}
{"id":"3acf9c5b-4e24-40b2-b69c-d9342ce23ae2","updated_at":"2025-04-09T03:42:08.164Z","updated_by":"purple1","created_at":"2025-04-09T03:42:08.164Z","created_by":"purple1","name":"UC057 : Bypass Windows UAC","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attacker trying to escalate privileges using windows UAC - User Access Control","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"bc106f3c-91a5-461d-84ba-00c5c96a3837","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548","subtechnique":[{"id":"T1548.002","name":"Bypass User Account Control","reference":"https://attack.mitre.org/techniques/T1548/002"}]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1548.002/T1548.002.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and event.code : \"4688\" \n    and \n    (\n      winlog.event_data.NewProcessName : \"*\\\\reg.exe\" and winlog.event_data.CommandLine : \"* hkcu\\\\software\\\\classes\\\\mscfile\\\\shell\\\\open\\\\command *\" and winlog.event_data.NewProcessName : \"*\\\\eventvwr.msc\"\n      or winlog.event_data.NewProcessName : \"*\\\\reg.exe\" and winlog.event_data.CommandLine : \"* hkcu\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command *\" and winlog.event_data.NewProcessName : \"*\\\\fodhelper.exe\"\n      or winlog.event_data.NewProcessName : \"*\\\\reg.exe\" and winlog.event_data.CommandLine : \"* HKCU:\\\\software\\\\classes\\\\ms-settings\\\\shell\\\\open\\\\command *\" and winlog.event_data.NewProcessName : \"*\\\\computerdefault.exe\"\n      or winlog.event_data.NewProcessName : \"*\\\\reg.exe\" and winlog.event_data.CommandLine : \"* HKCU:\\\\Software\\\\Classes\\\\Folder\\\\shell\\\\open\\\\command *\" and winlog.event_data.NewProcessName : \"*\\\\sdclt.exe\"\n      or  winlog.event_data.NewProcessName : \"*\\\\dism.exe\"\n      or winlog.event_data.NewProcessName : \"*\\\\reg.exe\" and winlog.event_data.CommandLine : \"* HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System *\"\n    )","filters":[],"actions":[]}
{"id":"ecf964fe-bfb7-44b7-b3e9-afee2360f9c8","updated_at":"2025-03-26T02:19:20.309Z","updated_by":"purple1","created_at":"2025-03-25T02:37:14.227Z","created_by":"elastic","name":"UC184 : Data Exfiltration","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Data Exfiltration","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"059a0fe6-1b5d-4f4a-a68b-4390b732f11b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010"},"technique":[]}],"to":"now","references":["https://blog.apnic.net/2022/03/31/how-to-detect-and-prevent-common-data-exfiltration-attacks/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action : \"execve\"\n    and \n    (\n        (process.args : \"curl\" and process.args : \"POST\")\n        or (process.args : \"dig\" and process.args : \"noidnin\" and process.args : \"noidnout\")\n        or (process.args : \"nping\" and process.args : \"--icmp\")\n        or process.args in (\"sender.py\", \"exfiltrate.py\")\n    )","filters":[],"actions":[]}
{"id":"38f84223-b4a3-4976-adc7-1ebec7fb2753","updated_at":"2025-04-21T01:40:20.804Z","updated_by":"purple1","created_at":"2025-03-25T02:36:20.707Z","created_by":"elastic","name":"UC137 : Deploy Container","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may deploy a container into an environment to facilitate execution or evade defenses. In some cases, adversaries may deploy a new container to execute processes associated with a particular image or deployment, such as processes that execute or download malware. In others, an adversary may deploy a new container configured without network rules, user limitations, etc. to bypass existing defenses within the environment.\n","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"ee8f313e-8174-4f44-9dee-8fe2ecbba5f2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.executable in (\"docker\")\n        and\n        (\n            process.args in (\"*build*\", \"*run*\", \"*compose-up*\")\n        )","filters":[],"actions":[]}
{"id":"30b7ab8a-a56f-4b11-9225-001b6977773c","updated_at":"2025-03-25T02:37:36.315Z","updated_by":"elastic","created_at":"2025-03-25T02:37:36.315Z","created_by":"elastic","name":"UC272 : Linux SUID Binary Search (via cmdline)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to find binaries with SUID permission in order to try to escalate their priveleges","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"bda14b20-564c-4d63-96d1-456b65f50804","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[]}],"to":"now","references":["https://linux.die.net/man/1/find","https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":" any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.executable : \"find\"\n        and process.args : \"-perm\"\n        and\n        (\n            process.args : \"4000\"\n            or process.args : \"2000\"\n        )","filters":[],"actions":[]}
{"id":"40773223-4dc8-4d5f-a4d2-81f37aed9024","updated_at":"2025-03-25T02:36:45.074Z","updated_by":"elastic","created_at":"2025-03-25T02:36:45.074Z","created_by":"elastic","name":"UC165 : Indicator Removal: Timestomp","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may modify file time attributes to hide new or changes to existing files. Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"45276dd6-a579-41d9-b9d8-49ec5376e0f5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action : \"execve\"\n    and process.executable : \"touch\"\n    and process.args in (\"-t\", \"-d\", \"-r\", \"-acmr\")","filters":[],"actions":[]}
{"id":"13142525-23fc-41a2-b5d4-088c7570bdba","updated_at":"2025-03-25T02:37:28.279Z","updated_by":"elastic","created_at":"2025-03-25T02:37:28.279Z","created_by":"elastic","name":"UC267 : Possible Sudo heap-based buffer overflow exploitation [sudoedit variants] (CVE-2021-3156)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"This rule detects one of the possible techniques [sudoedit] which can be used for exploitation of CVE-2021-3156 (Heap-based buffer overflow in Sudo).\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"c239e8e3-b96e-48ee-afe6-d2243aaaaefa","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt","https://github.com/r4j0x00/exploits/blob/0ca79419359e482ada264af2ddabafa7b3a4c0e1/CVE-2021-3156/exploit.c#L84"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.executable : \"sudoedit\"\n        and\n        (\n            process.args: \"-s\" \n            or process.args: \"-i\"\n        )","filters":[],"actions":[]}
{"id":"3d0b5922-4c22-4204-b0fc-4bb5e9677b5b","updated_at":"2025-04-15T01:52:50.628Z","updated_by":"purple1","created_at":"2025-04-15T01:52:50.628Z","created_by":"purple1","name":"UC298 :  Possible Scheduled Task via COM Object (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Scheduled task can be used to schedule programs or scripts to be executed at a date and time.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"7ab27446-56b5-4811-8d35-fb1dab9adaeb","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1053","name":"Scheduled Task/Job","reference":"https://attack.mitre.org/techniques/T1053","subtechnique":[]}]}],"to":"now","references":["https://www.fireeye.com/blog/threat-research/2019/06/hunting-com-objects.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and (winlog.event_data.CommandLine : \"* activator *\"  and winlog.event_data.CommandLine : \"* CreateInstance *\"  and winlog.event_data.CommandLine : \"* Schedule.Service *\" \n      or winlog.event_data.CommandLine : \"* 0F87369F-A4E5-4CFC-BD3E-73E6154572DD *\")","filters":[],"actions":[]}
{"id":"e88969ef-4b6d-4106-94ff-a34d80502479","updated_at":"2025-04-15T08:39:58.329Z","updated_by":"purple1","created_at":"2025-04-15T08:39:58.329Z","created_by":"purple1","name":"UC333 : Anonymous User Changed Machine Password","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detects Anonymous Users Changing Machine Password. This is the behavior of many zerologon POCs. This behavior must be correlated with windows events - 4624/5829 or IDS events, like Zeek.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"015f4069-5de5-4a5b-ae25-323b74ed6c50","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1210","name":"Exploitation of Remote Services","reference":"https://attack.mitre.org/techniques/T1210","subtechnique":[]}]}],"to":"now","references":["https://github.com/nccgroup/nccfsas/tree/main/Tools/SharpZeroLogon"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"  any where host.os.type : \"windows\" \n  and (event.code : \"4742\" and winlog.event_data.SubjectUserName : \"* anonymous *\" and winlog.event_data.TargetUserName : \"*$\"\n    or event.code : \"4742\" and winlog.event_data.SubjectUserName : \"* S-1-0 *\" and winlog.event_data.TargetUserName : \"*$\")","filters":[],"actions":[]}
{"id":"d3204520-3c51-4ad3-ab0b-bd313826cdb3","updated_at":"2025-04-15T04:30:00.319Z","updated_by":"purple1","created_at":"2025-02-27T10:31:35.722Z","created_by":"elastic","name":"UC319 : Suspicious Encoded PowerShell Command Line","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects suspicious powershell process starts with base64 encoded commands","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"9b5dde4c-6909-40b5-b0cb-eee90f9311a3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]}],"to":"now","references":["https://app.any.run/tasks/6217d77d-3189-4db2-a957-8ab239f3e01e"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (winlog.event_data.CommandLine : \"* -e *\"\n        and winlog.event_data.CommandLine in (\"* SUVYI *\",\"* aWV4I *\", \"* SQBFAFgA *\", \"* aQBlAHgA *\", \"* JAB *\")\n        and not winlog.event_data.CommandLine : \"* -ExecutionPolicy *\" and winlog.event_data.CommandLine : \"* remotesigned *\")","filters":[],"actions":[]}
{"id":"8067a80a-2aa3-4d3d-982b-38f3a1aea4c1","updated_at":"2025-02-21T07:53:18.328Z","updated_by":"purple1","created_at":"2025-02-21T07:53:18.328Z","created_by":"purple1","name":"UC349 : Possible Wsmprovhost.exe Dsrole Dll Side-Loading","tags":["product: windows","category: image_load"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to side-load malicious dynamic library named as legitimate Dsrole one in order to perfom malicious activity.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"65058e31-ed10-4fe7-99a5-cdbfaecacc35","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1574","name":"Hijack Execution Flow","reference":"https://attack.mitre.org/techniques/T1574","subtechnique":[{"id":"T1574.002","name":"DLL Side-Loading","reference":"https://attack.mitre.org/techniques/T1574/002"}]}]}],"to":"now","references":["https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and \n  (\n    (\n      winlog.event_data.Image : \"*wsmprovhost.exe\"\n      or winlog.event_data.ImageLoaded : \"*dsrole.dll\"\n    )\n    and not\n    (\n      winlog.event_data.ImageLoaded : \"*SysWOW64*\"\n      or winlog.event_data.ImageLoaded : \"*System32*\"\n    )\n  )","filters":[],"actions":[]}
{"id":"4a0a9561-5c08-4724-9af1-98c41402999c","updated_at":"2025-04-08T10:23:06.076Z","updated_by":"purple1","created_at":"2025-04-08T10:23:06.076Z","created_by":"purple1","name":"UC043 : Windows Discovery Credentials","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attackers spy on credential information on windows. These credentials optional can be service/application accounts stored in configuration files.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2685cd21-e86b-49d0-9d9f-61e9bd020c7d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[]}],"to":"now","references":["https://twitter.com/cube0x0/status/1418920190759378944","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.001/T1552.001.md#atomic-test-3---extracting-passwords-with-findstr; https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1552.001/T1552.001.md#atomic-test-4---access-unattendxml","https://github.com/OTRF/detection-hackathon-apt29/issues/14","https://github.com/GossiTheDog/HiveNightmare","https://threathunterplaybook.com/evals/apt29/detections/6.B.1_6392C9F1-D975-4F75-8A70-433DEDD7F622.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n      winlog.event_data.NewProcessName : \"*\\\\findstr.exe\" and winlog.event_data.CommandLine in (\"* si pass *\", \"* .pgp *\", \"* .gpg *\", \"* .ppk *\", \"* .p12 *\", \"* .pem *\", \"* .pfx *\", \"* .cer *\", \"* .p7b *\", \"* .asc *\")\n      or (\n        winlog.event_data.CommandLine : \"* type C:\\\\Windows\\\\Panther\\\\unattend.xml\"\n        or winlog.event_data.CommandLine : \"* type C:\\\\Windows\\\\Panther\\\\Unattend\\\\unattend.xml\"\n      )\n      or (\n        winlog.event_data.NewProcessName : \"*\\\\reg.exe\"\n        and (\n          winlog.event_data.CommandLine : \"* HKCU /f password /t REG_SZ /s *\"\n          or winlog.event_data.CommandLine : \"* HKLM /f password /t REG_SZ /s *\"\n          or winlog.event_data.CommandLine : \"* HKCU\\\\Software\\\\SimonTatham\\\\PuTTY\\\\Sessions /t REG_SZ /s *\"\n        )\n      )\n      or winlog.event_data.NewProcessName in (\"*\\\\where.exe\", \"*\\\\LaaZagne.exe\")\n    )","filters":[],"actions":[]}
{"id":"714dfa02-fcf7-437f-ba83-e3c7991b0d33","updated_at":"2025-03-26T02:17:44.262Z","updated_by":"purple1","created_at":"2025-03-25T02:37:12.219Z","created_by":"elastic","name":"UC182 : Vulnerability Scanner Tool Detection on Linux (via process_creation)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Attacker can use your system with some penetration tools as kali tools etc.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":["- Red team activity"],"from":"now-360s","rule_id":"1d7a6954-b684-4243-ae79-a94e09c3a5d5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0043","name":"Reconnaissance","reference":"https://attack.mitre.org/tactics/TA0043"},"technique":[]}],"to":"now","references":["https://geekflare.com/brute-force-attack-tools/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and  process.executable in (\"gobuster\", \"bruteX\", \"dirsearch\", \"callow\", \"hydra\", \"patator\", \"pydictor\", \"ncrack\", \"hashcat\", \"nmap\", \"dirbuster\", \"nessus\", \"netsparker\", \"sqlmap\", \"nikto\", \"dirb\", \"wfuzz\", \"msfconsole\", \"zenmap\")","filters":[],"actions":[]}
{"id":"e4ab51a3-37cc-40ce-bdcf-1f3942cbfed6","updated_at":"2025-04-10T07:28:29.721Z","updated_by":"purple1","created_at":"2025-04-10T07:28:29.721Z","created_by":"purple1","name":"UC232 : Possible 7-Zip CVE-2022-29072 Exploitation (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"7-Zip through 21.07 on Windows allows privilege escalation and command execution when a file with the .7z extension is dragged to the Help>Contents area.","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"cc8ac560-c4f8-4802-8464-f48a03f000b9","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068","subtechnique":[]}]}],"to":"now","references":["https://github.com/kagancapar/CVE-2022-29072"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"    any where host.os.type : \"windows\" \n    and winlog.event_data.ParentProcessName : \"*\\\\7zFM.exe\"\n    and winlog.event_data.NewProcessName in (\"*\\\\powershell.exe\", \"*\\\\cmd.exe\", \"*\\\\at.exe\", \"*\\\\AtBroker.exe\", \"*\\\\bash.exe\", \"*\\\\bitsadmin.exe\", \"*\\\\certoc.exe\", \"*\\\\cmstp.exe\", \"*\\\\diskshadow.exe\", \"*\\\\DllHost.exe\", \"*\\\\dnscmd.exe\", \"*\\\\explorer.exe\", \"*\\\\extexport.exe\", \"*\\\\forfiles.exe\", \"*\\\\ftp.exe\", \"*\\\\gpscript.exe\", \"*\\\\hh.exe\", \"*\\\\ie4uinit.exe\", \"*\\\\ieexec.exe\", \"*\\\\infdefaultinstall.exe\", \"*\\\\installutil.exe\", \"*\\\\mavinject.exe\", \"*\\\\microsoft.workflow.compiler.exe\", \"*\\\\mmc.exe\", \"*\\\\msconfig.exe\", \"*\\\\MSBuild.exe\", \"*\\\\msdt.exe\", \"*\\\\mshta.exe\", \"*\\\\msiexec.exe\", \"*\\\\netsh.exe\", \"*\\\\odbcconf.exe\", \"*\\\\offlinescannershell.exe\", \"*\\\\pcalua.exe\", \"*\\\\pcwrun.exe\", \"*\\\\pnputil.exe\", \"*\\\\presentationhost.exe\", \"*\\\\rasautou.exe\", \"*\\\\RegAsm.exe\", \"*\\\\register-cimprovider.exe\", \"*\\\\regsvcs.exe\", \"*\\\\regsvr32.exe\", \"*\\\\rundll32.exe\", \"*\\\\runonce.exe\", \"*\\\\runscripthelper.exe\", \"*\\\\schtasks.exe\", \"*\\\\scriptrunner.exe\", \"*\\\\settingsynchost.exe\", \"*\\\\stordiag.exe\", \"*\\\\syncappvpublishingserver.exe\", \"*\\\\ttdinject.exe\", \"*\\\\tttracer.exe\", \"*\\\\verclsid.exe\", \"*\\\\wab.exe\", \"*\\\\WMIC.exe\", \"*\\\\workfolders.exe\", \"*\\\\wuauclt.exe\", \"*\\\\xwizard.exe\")","filters":[],"actions":[]}
{"id":"0f45c96d-a437-43e7-8ad3-85ec0b4f417d","updated_at":"2025-03-25T04:08:33.891Z","updated_by":"purple1","created_at":"2025-03-25T02:36:24.765Z","created_by":"elastic","name":"UC147 : Sudo And Sudo Caching","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may attempt to dump the contents of /etc/passwd and /etc/shadow to enable offline password cracking. Most modern Linux operating systems use a combination of /etc/passwd and /etc/shadow to store user account information including password hashes in /etc/shadow\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"39da6d8f-ce0d-4990-9a8b-5e4ee2e4d23d","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.008","name":"/etc/passwd and /etc/shadow","reference":"https://attack.mitre.org/techniques/T1003/008"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.executable in (\"cat\", \"head\", \"tail\", \"more\")\n        and process.args in (\"pass\", \"shadow\", \"sudoers\")","filters":[],"actions":[]}
{"id":"0cce67bd-476f-4f27-b2ae-1826bd9635b9","updated_at":"2025-04-17T03:58:52.871Z","updated_by":"purple1","created_at":"2025-04-08T09:02:13.591Z","created_by":"purple1","name":"UC040 : Windows Discovery System Network Connection","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detected attackers spy on network connection information on windows.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"1889b582-9092-4b67-8e96-63652928d2a2","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1049","name":"System Network Connections Discovery","reference":"https://attack.mitre.org/techniques/T1049","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1049/T1049.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (\n      winlog.event_data.NewProcessName in (\"*\\\\netstat.exe\", \"*\\\\sharpview.exe\")\n      or winlog.event_data.NewProcessName in (\"*\\\\net.exe\", \"*\\\\net1.exe\") and winlog.event_data.CommandLine in (\"* use *\",\"* session *\", \"*  share *\")\n    )","filters":[],"actions":[]}
{"id":"68238c07-3674-40eb-a862-7a9dfdb1dcf1","updated_at":"2025-03-25T02:37:26.272Z","updated_by":"elastic","created_at":"2025-03-25T02:37:26.272Z","created_by":"elastic","name":"UC255 : Possible Apache ActiveMQ CVE-2023-46604 Exploitation (via process creation)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"The rule analyzes process creation events on Linux systems, specifically scrutinizing command lines for the presence of predefined elements associated with the CVE. By monitoring for these patterns, the rule aims to provide early detection of suspicious activities related to the exploitation of CVE-2023-46604.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"2dca6c9e-b2b8-4800-b578-749bdf13b874","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.004","name":"Unix Shell","reference":"https://attack.mitre.org/techniques/T1059/004"}]}]}],"to":"now","references":["https://github.com/duck-sec/CVE-2023-46604-ActiveMQ-RCE-pseudoshell/blob/master/exploit.py","https://pentesting.academy/p/new-exploit-for-apache-activemq-cve","https://activemq.apache.org/news/cve-2023-46604"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and \n        (\n            process.args: \"ls\" \n            and process.args: \"-lah\"\n            and process.args: \"awk\"\n            and process.args: \"print $0\"\n            and process.args: \"curl\"\n            and process.args: \"POST\"\n            and process.args: \"receive_data\"\n        )","filters":[],"actions":[]}
{"id":"9416cece-3cc4-497b-992a-e7e93a85a0f8","updated_at":"2025-03-26T03:06:23.199Z","updated_by":"purple1","created_at":"2025-03-25T02:37:46.361Z","created_by":"elastic","name":"UC343 : Possible Exfiltration via Kubectl (GTFOBins) (via cmdline)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects potential attempts to exfiltrate files using the proxy option of the Kubernetes kubectl command-line tool.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"340f7b31-f7a4-469b-bdd1-d3741357bbd3","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://gtfobins.github.io/gtfobins/kubectl/","https://www.mankier.com/1/kubectl-proxy"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\nand event.action : \"execve\"\nand process.executable : \"kubectl\"\nand process.args : \"proxy\" and process.args : \"adddress\" and process.args : \"port\" and process.args : \"www\"","filters":[],"actions":[]}
{"id":"005a18fe-bf0c-4e17-869e-d806f2fa33b7","updated_at":"2025-03-26T02:25:41.472Z","updated_by":"purple1","created_at":"2025-03-25T02:37:20.250Z","created_by":"elastic","name":"UC204 : Use Of Hidden Paths Or Files","tags":["service: auditd","product: linux"],"interval":"5m","enabled":true,"revision":3,"description":"Detects calls to hidden files or files located in hidden directories in NIX systems.","risk_score":21,"severity":"low","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"c73dc45c-2fe3-4bdf-a121-046306f0199c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action: \"execve\"\n    and process.args : (\"/.\")\n    and not process.args in (\"/.cache/\", \"/.cache/\", \"/.cache/\", \"/.cache/\")","filters":[],"actions":[]}
{"id":"dcaf502d-f0a2-42b9-a5e7-7f46af95ef14","updated_at":"2025-04-09T09:58:14.415Z","updated_by":"purple1","created_at":"2025-04-09T09:58:14.415Z","created_by":"purple1","name":"UC141 : Suspicious Rundll32 Activity","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects suspicious process related to rundll32 based on arguments","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e3f2b499-ff39-4657-9834-30c76901cbee","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":["http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/","https://twitter.com/Hexacorn/status/885258886428725250","https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and (     \n winlog.event_data.CommandLine : \"* \\rundll32.exe* url.dll,*OpenURL *\"\n      or winlog.event_data.CommandLine : \"* \\rundll32.exe* url.dll,*OpenURLA *\"\n      or winlog.event_data.CommandLine : \"* \\rundll32.exe* url.dll,*FileProtocolHandler *\"\n      or winlog.event_data.CommandLine : \"* \\rundll32.exe* zipfldr.dll,*RouteTheCall *\"\n      or winlog.event_data.CommandLine : \"* \\rundll32.exe* Shell32.dll,*Control_RunDLL *\"\n      or winlog.event_data.CommandLine : \"* \\rundll32.exe javascript: *\"\n      or winlog.event_data.CommandLine : \"*  url.dll,*OpenURL *\"\n      or winlog.event_data.CommandLine : \"* url.dll,*OpenURLA *\"\n      or winlog.event_data.CommandLine : \"* url.dll,*FileProtocolHandler *\"\n      or winlog.event_data.CommandLine : \"* zipfldr.dll,*RouteTheCall *\"\n      or winlog.event_data.CommandLine : \"* Shell32.dll,*Control_RunDLL *\"\n      or winlog.event_data.CommandLine : \"* javascript: *\"\n      or winlog.event_data.CommandLine : \"* .RegisterXLL *\")","filters":[],"actions":[]}
{"id":"05ec7c95-9e04-40e1-8262-4716a3e1ed6c","updated_at":"2025-04-09T07:22:30.844Z","updated_by":"purple1","created_at":"2025-04-09T07:22:30.844Z","created_by":"purple1","name":"UC072 : Suspicious Registry Detected","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects attacker trying to change registry values including adding/editing/deleting some important registries.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"013dbebf-61d7-4b1c-aedc-ef267bd1c38a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1546","name":"Event Triggered Execution","reference":"https://attack.mitre.org/techniques/T1546","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1112","name":"Modify Registry","reference":"https://attack.mitre.org/techniques/T1112","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1547.004/T1547.004.md#atomic-test-3---winlogon-notify-key-logon-persistence---powershell","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1546.002/T1546.002.md","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and (\n      winlog.event_data.CommandLine : \"* HKLM\\\\system\\\\currentcontrolset\\\\services /s | findstr ImagePath 2>nul | findstr /Ri \\\".*\\\\.sys$\\\" *\"\n      or winlog.event_data.CommandLine : \"* HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\ShellServiceObjectDelayLoad *\"\n      or winlog.event_data.CommandLine : \"* HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows *\"\n      or winlog.event_data.CommandLine : \"* \\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify *\"\n      or winlog.event_data.CommandLine : \"* HKEY_CURRENT_USER\\\\Control Panel\\\\Desktop *\"\n      or winlog.event_data.CommandLine : \"* HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f *\"\n      )","filters":[],"actions":[]}
{"id":"3eb7be62-9fd0-4db3-ae4a-3fe45233ef2f","updated_at":"2025-04-08T07:42:44.792Z","updated_by":"purple1","created_at":"2025-02-27T10:30:11.031Z","created_by":"elastic","name":"UC066 : WMImplant Hack Tool","tags":["product: windows","service: powershell"],"interval":"5m","enabled":true,"revision":0,"description":"Detects parameters used by WMImplant","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a80ef073-cbdf-403f-ab4e-9b48117f60c5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1047","name":"Windows Management Instrumentation","reference":"https://attack.mitre.org/techniques/T1047","subtechnique":[]},{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]}],"to":"now","references":["https://github.com/FortyNorthSecurity/WMImplant","https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_wmimplant.yml"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code : \"4104\" and winlog.event_data.ScriptBlockText : \"Invoke-WMImplant\" and not (winlog.user.identifier : \"S-1-5-18*\" or winlog.user.identifier : \"S-1-5-19*\")","filters":[],"actions":[]}
{"id":"44b133da-899e-4644-aac6-0579681ff3e9","updated_at":"2025-04-16T02:36:39.202Z","updated_by":"purple1","created_at":"2025-04-16T02:36:39.202Z","created_by":"purple1","name":"UC346 : Possible Usage of Sysinternals Tools (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"For example, PsExec for lateral movement; malicious service was installed and configured to execute via a renamed version of DBGview; ProcDump for dump LSASS process memory.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"f2660678-065d-41da-bdf3-5284287932f9","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":["https://www.huntress.com/blog/blackcat-ransomware-affiliate-ttps","https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a","https://www.attackiq.com/2023/07/28/emulating-gallium/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\.exe\" and winlog.event_data.CommandLine : \"* -accepteula *\" and not winlog.event_data.NewProcessName in (\"*\\\\Sysmon.exe\", \"*\\\\Sysmon64.exe\")","filters":[],"actions":[]}
{"id":"361db5c7-e656-4b5a-b0ac-f8cbaf140af5","updated_at":"2025-04-15T08:53:18.551Z","updated_by":"purple1","created_at":"2025-04-15T08:53:18.551Z","created_by":"purple1","name":"UC338 : Possible Command and Control by Use of ngrok Port Tunnel (via process creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"The rule detects the possible use of an ngrok RDP/SMB  Tunnel.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":["https://www.socinvestigation.com/ngrok-threat-hunting-detect-hackers-at-the-end-of-the-tunnel/","https://stackoverflow.com/questions/42442320/ssh-tunnel-to-ngrok-and-initiate-rdp","https://cybleinc.com/2021/02/15/ngrok-platform-abused-by-hackers-to-deliver-a-new-wave-of-phishing-attacks/"],"from":"now-360s","rule_id":"a2e9e212-efb6-4c50-84ff-c6741dd2d63e","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1572","name":"Protocol Tunneling","reference":"https://attack.mitre.org/techniques/T1572","subtechnique":[]},{"id":"T1572","name":"Protocol Tunneling","reference":"https://attack.mitre.org/techniques/T1572","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and (winlog.event_data.NewProcessName : \"*\\\\ngrok.exe\" and winlog.event_data.CommandLine in (\"* tcp *\" , \"* http *\" , \"* authtoken *\")\n  or (winlog.event_data.CommandLine : \"*  start *\" and winlog.event_data.CommandLine : \"* all *\" and winlog.event_data.CommandLine : \"* config *\" and winlog.event_data.CommandLine : \"* .yml *\" and winlog.event_data.CommandLine : \"* tcp *\" and winlog.event_data.CommandLine in (\"* 139 *\" , \"* 445 *\" , \"* 3389 *\", \"* 5985 *\", \"* 5986 *\" )))","filters":[],"actions":[]}
{"id":"4f2092c5-2116-495f-beb3-c0817f42e17f","updated_at":"2025-04-09T10:59:34.439Z","updated_by":"purple1","created_at":"2025-04-09T10:59:34.439Z","created_by":"purple1","name":"UC145 : System Service Discovery","tags":["product: windows","service: windows event log"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as sc query, tasklist /svc, systemctl --type=service, and net start.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"0ac609b6-8207-43ae-bfa2-d02a4ca8c9c6","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and \n    (\n      winlog.event_data.CommandLine : \"* sc *\" and winlog.event_data.CommandLine : \"* query *\"\n      or winlog.event_data.CommandLine : \"* net *\" and winlog.event_data.CommandLine : \"* start *\" \n      or winlog.event_data.CommandLine : \"* tasklist *\" and winlog.event_data.CommandLine : \"* svc *\"\n      or winlog.event_data.CommandLine : \"* schtasks *\" \n    )","filters":[],"actions":[]}
{"id":"3c584a07-8268-46b7-a830-f91f591c70e3","updated_at":"2025-04-10T09:57:18.758Z","updated_by":"purple1","created_at":"2025-02-27T10:30:44.399Z","created_by":"elastic","name":"UC254 : Possible Access Token Manipulation by Rare Process (via audit)","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries commonly use token stealing to elevate their security context from the administrator level to the SYSTEM level.\nstatus: stable","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":["- Legitimate software."],"from":"now-360s","rule_id":"64e97e11-3cde-4907-9000-8943fc78b1d5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1134","name":"Access Token Manipulation","reference":"https://attack.mitre.org/techniques/T1134","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and event.code : \"4656\"\n    and winlog.event_data.AccessMask in (\"0x1000\", \"0x1400\", \"0x0010\")\n    and winlog.event_data.ObjectName in (\"*dllhost.exe*\", \"*lsass.exe*\", \"*OfficeClickToRun.exe*\", \"*svchost.exe*\", \"*Sysmon64.exe*\", \"*unsecapp.exe*\", \"*VGAuthService.exe*\", \"*vmacthlp.exe*\",\"*vmtoolsd.exe*\", \"*winlogon.exe*\", \"*csrss.exe*\", \"*services.exe*\", \"*smss.exe*\", \"*wininit.exe*\")\n    and not (winlog.event_data.ProcessName : \"*Defender*\" and winlog.event_data.ProcessName : \"*Platform*\" and winlog.event_data.ProcessName : \"*ProgramData*\" and winlog.event_data.ProcessName : \"*MsMpEng.exe*\")","filters":[],"actions":[]}
{"id":"91f176f9-6970-4fe4-8160-ed10bc831b56","updated_at":"2025-02-21T07:44:57.200Z","updated_by":"purple1","created_at":"2025-02-21T07:44:57.200Z","created_by":"purple1","name":"UC348 : Possible LSASS Memory Dump File Creation","tags":["product: windows","category: file_event"],"interval":"5m","enabled":true,"revision":0,"description":"There is a possibility that a memory dump of the LSASS process has been created in order to gain access to credentials. It is possible that the attacker may transfer this dump to another location for further analysis.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":["- Files that are legitimate and contain patterns chosen from a selection."],"from":"now-360s","rule_id":"fdcea177-578c-4fbc-9429-6bf1861a6f15","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[]}]}],"to":"now","references":["https://blog.talosintelligence.com/lazarus_new_rats_dlang_and_telegram/","https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a","https://www.infosecurity-magazine.com/news/signature-techniques-of-asian-apt/","https://www.mandiant.com/resources/blog/unc961-multiverse-financially-motivated","https://www.logpoint.com/wp-content/uploads/2023/12/et-cactus-4-12.pdf"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and \n  (\n    (\n      winlog.event_data.TargetObject : \"*lsass*\"\n      or winlog.event_data.TargetObject : \"*ssasl*\"\n    )\n    and \n    (\n      winlog.event_data.TargetObject : \"*dmp *\"\n      or winlog.event_data.TargetObject : \"*pmd *\"\n      or winlog.event_data.TargetObject : \"*dump *\"\n      or winlog.event_data.TargetObject : \"*zip *\"\n      or winlog.event_data.TargetObject : \"*out *\"\n      or winlog.event_data.TargetObject : \"*rar *\"\n      or winlog.event_data.TargetObject : \"*tmp *\"\n    )\n  )","filters":[],"actions":[]}
{"id":"5528432b-f55d-4051-a692-c62dfb66884b","updated_at":"2025-04-16T03:01:59.622Z","updated_by":"purple1","created_at":"2025-04-16T03:01:59.622Z","created_by":"purple1","name":"UC347 : Suspicious Domain Trusts Discovery (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may attempt to gather information on domain trust relationships that may be used to identify lateral movement opportunities in Windows multi-domain/forest environments.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"c41686ec-b1db-4d5c-a27e-b03917a9c023","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1482","name":"Domain Trust Discovery","reference":"https://attack.mitre.org/techniques/T1482","subtechnique":[]}]}],"to":"now","references":["https://thedfirreport.com/2022/09/26/bumblebee-round-two/","https://www.infosecurity-magazine.com/news/signature-techniques-of-asian-apt/","https://blogs.blackberry.com/en/2023/08/cuba-ransomware-deploys-new-tools-targets-critical-infrastructure-sector-in-the-usa-and-it-integrator-in-latin-america"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.CommandLine in (\"* DOMAIN_TRUSTS *\" , \"* ALL_TRUSTS *\" , \"* dclist *\", \"* dsgetdc *\")","filters":[],"actions":[]}
{"id":"6455c864-b46b-4e97-8216-9f5e72bf1f5b","updated_at":"2025-04-10T09:31:07.415Z","updated_by":"purple1","created_at":"2025-04-10T09:31:07.415Z","created_by":"purple1","name":"UC245 : Password Protected ZIP File Opened (Suspicious Filenames)","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detects the extraction of password protected ZIP archives with suspicious file names. See the filename variable for more details on which file has been opened.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"38deb1f4-6cfc-440d-88a3-b58904dafc9b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://twitter.com/sbousseaden/status/1523383197513379841","https://www.socinvestigation.com/windows-event-id-5379-to-detect-malicious-password-protected-file-unlock/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and event.code : \"5379\"\n    and winlog.event_data.TargetName : \"* Microsoft_Windows_Shell_ZipFolder:filename *\" \n    and winlog.event_data.TargetName in (\"* invoice *\", \"* new order *\", \"* rechnung *\", \"* factura *\", \"* delivery *\", \"* purchase *\", \"* order *\", \"* payment *\")","filters":[],"actions":[]}
{"id":"6badd3cf-ccaa-470a-9f16-8cd1531fee43","updated_at":"2025-04-10T08:15:14.457Z","updated_by":"purple1","created_at":"2025-04-10T08:15:14.457Z","created_by":"purple1","name":"UC240 : Suspicious Execution from Mounted Drive (via audit)","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may abuse container files such as disk image (.iso, .vhd) file formats to deliver malicious payloads.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"3f163cea-6def-4616-8fe1-9b6b94c20a69","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.trendmicro.com/en_us/research/23/f/malvertising-used-as-entry-vector-for-blackcat-actors-also-lever.html","https://www.cynet.com/orion-threat-alert-flight-of-the-bumblebee/","https://www.bleepingcomputer.com/news/security/uptick-seen-in-iso-email-attachments-delivering-malware/","https://www.trendmicro.com/en_no/research/21/k/bazarloader-adds-compromised-installers-iso-to-arrival-delivery-vectors.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and event.code : \"4688\"\n    and (winlog.event_data.NewProcessName : \"Device\" and winlog.event_data.NewProcessName : \"CdRom\"\n    or winlog.event_data.NewProcessName : \"Device\" and winlog.event_data.NewProcessName : \"HarddiskVolume\")\n    and not winlog.event_data.SubjectUserName : \"*$\"","filters":[],"actions":[]}
{"id":"c10b01f2-cc85-41db-850f-38515ffcc4ca","updated_at":"2025-04-15T04:27:59.286Z","updated_by":"purple1","created_at":"2025-02-27T10:31:33.715Z","created_by":"elastic","name":"UC318 : Suspicious Ntdsutil Activity (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"NTDSUTIL allows an adversary to create copies of Ntds.dit (active directory database)","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"6a8599ca-7972-4dee-b639-478ac1accd7a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.003","name":"NTDS","reference":"https://attack.mitre.org/techniques/T1003/003"}]}]}],"to":"now","references":["https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-038a","https://www.infosecurity-magazine.com/news/signature-techniques-of-asian-apt/","https://posts.specterops.io/domain-of-thrones-part-i-c183ee4bf379"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\ntdsutil.exe\" and  winlog.event_data.CommandLine in (\"* ifm *\", \"* full *\", \"* ac *\", \"* create *\")","filters":[],"actions":[]}
{"id":"3de27502-339e-406e-86b5-021af1f53202","updated_at":"2025-04-09T03:52:48.310Z","updated_by":"purple1","created_at":"2025-04-09T03:52:48.310Z","created_by":"purple1","name":"UC061 : Windows File Permission Modification","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected an attacker trying to change file/folder permissions","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"f97790a6-65b6-4936-a6a6-bf155b85ae46","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1222","name":"File and Directory Permissions Modification","reference":"https://attack.mitre.org/techniques/T1222","subtechnique":[{"id":"T1222.001","name":"Windows File and Directory Permissions Modification","reference":"https://attack.mitre.org/techniques/T1222/001"}]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1222.001/T1222.001.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and (winlog.event_data.NewProcessName : \"*\\\\attrib.exe\" and winlog.event_data.CommandLine in (\"* -r *\", \"* +h *\") or winlog.event_data.NewProcessName in (\"*\\\\icacls.exe\", \"*\\\\cacls.exe\", \"*\\\\takeown.exe\"))","filters":[],"actions":[]}
{"id":"4e432612-2ab6-4405-9b42-09a7fe16337f","updated_at":"2025-04-10T02:09:25.473Z","updated_by":"purple1","created_at":"2025-04-10T02:09:25.473Z","created_by":"purple1","name":"UC194 : BITS Jobs","tags":["product: windows","category: ps_script"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may abuse BITS jobs to persistently execute code and perform various background tasks. Windows Background Intelligent Transfer Service (BITS) is a low-bandwidth, asynchronous file transfer mechanism exposed through Component Object Model (COM).","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"5cc5c154-b869-4a57-a0e9-aefac76740c8","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1197","name":"BITS Jobs","reference":"https://attack.mitre.org/techniques/T1197","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (event.code : \"4688\" and winlog.event_data.NewProcessName : \"*\\\\desktopimgdownldr.exe\"\n    or event.code : \"4688\" and winlog.event_data.CommandLine in (\"* Transfer *\", \"* Create *\", \"* AddFile *\", \"* SetNotifyFlags *\", \"* SetNotifyCmdLine *\", \"* SetMinRetryDelay *\", \"* SetCustomHeaders *\", \"* Resume *\", \"* Complete *\", \"* download *\", \"* upload *\")\n    or event.code : \"4104\" and winlog.event_data.ScriptBlockText in (\"* Start-BitsTransfer *\", \"* bitsadmin.exe*/Transfer *\", \"* bitsadmin.exe*/Create *\", \"* bitsadmin.exe*/AddFile *\", \"* bitsadmin.exe*/SetNotifyFlags *\", \"* bitsadmin.exe*/SetNotifyCmdLine *\", \"* bitsadmin.exe*/SetMinRetryDelay *\", \"* bitsadmin.exe*/SetCustomHeaders *\", \"* bitsadmin.exe*/Resume *\", \"* bitsadmin.exe*/Complete *\", \"* bitsadmin.exe*/download *\", \"* bitsadmin.exe*/upload *\"))","filters":[],"actions":[]}
{"id":"70a951dd-2400-42eb-b83c-0c0b2ba04696","updated_at":"2025-04-09T04:10:28.600Z","updated_by":"purple1","created_at":"2025-04-09T04:10:28.600Z","created_by":"purple1","name":"UC065 : Obfuscate/Deobfuscate File Or String","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detected that an attacker tries to encrypt or decrypt files and strings to bypass firewall mechanisms, or steal data.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"4cc54a26-6de6-4b83-9730-398fe1fbdb4b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1140","name":"Deobfuscate/Decode Files or Information","reference":"https://attack.mitre.org/techniques/T1140","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1140/T1140.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\certutil.exe\" and winlog.event_data.CommandLine in (\"* -encode *\", \"* -decode *\")","filters":[],"actions":[]}
{"id":"df182e83-f592-4dab-af51-34e9eaf3c951","updated_at":"2025-04-15T04:20:40.139Z","updated_by":"purple1","created_at":"2025-02-27T10:31:24.671Z","created_by":"elastic","name":"UC315 : Possible Credential Dumping Using Comsvcs.dll (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries can use built-in library comsvcs.dll to dump credentials on a compromised host.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"18fd2f1c-a40c-4d05-b29e-e1cbeb95ff26","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.001","name":"LSASS Memory","reference":"https://attack.mitre.org/techniques/T1003/001"}]}]}],"to":"now","references":["https://www.infosecurity-magazine.com/news/signature-techniques-of-asian-apt/","https://badoption.eu/blog/2023/06/21/dumpit.html","https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (winlog.event_data.CommandLine : \"* comsvcs *\" and winlog.event_data.CommandLine : \"* MiniDump *\"\n      or winlog.event_data.CommandLine : \"* comsvcs *\" and winlog.event_data.CommandLine : \"* #24 *\"\n      or winlog.event_data.CommandLine : \"* comsvcs *\" and winlog.event_data.CommandLine : \"* full *\"\n      or winlog.event_data.CommandLine : \"* full *\" and winlog.event_data.CommandLine : \"* MiniDump *\")","filters":[],"actions":[]}
{"id":"e3229f4e-207f-4d8f-a323-9bfe2901d0f1","updated_at":"2025-02-27T10:31:47.764Z","updated_by":"elastic","created_at":"2025-02-27T10:31:47.764Z","created_by":"elastic","name":"UC331 : Probable Use of WinPwn Windows Hacktool (via powershell)","tags":["product: windows","category: ps_script"],"interval":"5m","enabled":true,"revision":0,"description":"WinPwn is a large collection of offensive PowerShell scripts that are utilized to automate reconnaissance and exploitation of victim machines in penetration testing environments. Attackers may use these scripts for malicious purposes in their operations. Causes of false positives could be due to the use of similar or related tools that have the same command names, or a software that uses the same codebase.s\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"d314aeb6-8017-4b1a-b315-a99c473271dc","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548","subtechnique":[{"id":"T1548.002","name":"Bypass User Account Control","reference":"https://attack.mitre.org/techniques/T1548/002"}]},{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068","subtechnique":[]},{"id":"T1078","name":"Valid Accounts","reference":"https://attack.mitre.org/techniques/T1078","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1555","name":"Credentials from Password Stores","reference":"https://attack.mitre.org/techniques/T1555","subtechnique":[]},{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[]},{"id":"T1558","name":"Steal or Forge Kerberos Tickets","reference":"https://attack.mitre.org/techniques/T1558","subtechnique":[{"id":"T1558.003","name":"Kerberoasting","reference":"https://attack.mitre.org/techniques/T1558/003"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1087","name":"Account Discovery","reference":"https://attack.mitre.org/techniques/T1087","subtechnique":[]},{"id":"T1135","name":"Network Share Discovery","reference":"https://attack.mitre.org/techniques/T1135","subtechnique":[]},{"id":"T1082","name":"System Information Discovery","reference":"https://attack.mitre.org/techniques/T1082","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0009","name":"Collection","reference":"https://attack.mitre.org/tactics/TA0009"},"technique":[{"id":"T1005","name":"Data from Local System","reference":"https://attack.mitre.org/techniques/T1005","subtechnique":[]}]}],"to":"now","references":["https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-352a","https://github.com/S3cur3Th1sSh1t/WinPwn/blob/master/WinPwn.ps1","https://twitter.com/ShitSecure/status/1660240562228719622"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n      winlog.event_data.ScriptBlockText : \"*KrbRelayUp*\"\n      or winlog.event_data.ScriptBlockText : \"*Kerbrute*\"\n      or winlog.event_data.ScriptBlockText : \"*BloodHound*\"\n      or winlog.event_data.ScriptBlockText : \"*S3cur3Th1sSh1t*\"\n      or winlog.event_data.ScriptBlockText : \"*AmsiBypass*\"\n      or winlog.event_data.ScriptBlockText : \"*sharpcradle*\"\n      or winlog.event_data.ScriptBlockText : \"*Inveigh*\"\n      or winlog.event_data.ScriptBlockText : \"*SessionGopher*\"\n      or winlog.event_data.ScriptBlockText : \"*Kittielocal*\"\n      or winlog.event_data.ScriptBlockText : \"*lsassdumps*\"\n      or winlog.event_data.ScriptBlockText : \"*NanoDump*\"\n      or winlog.event_data.ScriptBlockText : \"*HandleKatz*\"\n      or winlog.event_data.ScriptBlockText : \"*Decryptteamviewer*\"\n      or winlog.event_data.ScriptBlockText : \"*SharpCloud*\"\n      or winlog.event_data.ScriptBlockText : \"*Safedump*\"\n      or winlog.event_data.ScriptBlockText : \"*Obfuskittiedump*\"\n      or winlog.event_data.ScriptBlockText : \"*Wificreds*\"\n      or winlog.event_data.ScriptBlockText : \"*Kittenz*\"\n      or winlog.event_data.ScriptBlockText : \"*Dumplsass*\"\n      or winlog.event_data.ScriptBlockText : \"*Kernelexploits*\"\n      or winlog.event_data.ScriptBlockText : \"*PrintNightmare*\"\n      or winlog.event_data.ScriptBlockText : \"*printspoofer*\"\n      or winlog.event_data.ScriptBlockText : \"*Juicypot*\"\n      or winlog.event_data.ScriptBlockText : \"*Localreconmodules*\"\n      or winlog.event_data.ScriptBlockText : \"*Generalrecon*\"\n      or winlog.event_data.ScriptBlockText : \"*Morerecon*\"\n      or winlog.event_data.ScriptBlockText : \"*Browserpwn*\"\n      or winlog.event_data.ScriptBlockText : \"*UACBypass*\"\n      or winlog.event_data.ScriptBlockText : \"*Passhunt*\"\n      or winlog.event_data.ScriptBlockText : \"*Searchservers*\"\n      or winlog.event_data.ScriptBlockText : \"*Domainreconmodules*\"\n      or winlog.event_data.ScriptBlockText : \"*generaldomaininfo*\"\n      or winlog.event_data.ScriptBlockText : \"*ADCSInfos*\"\n      or winlog.event_data.ScriptBlockText : \"*Domainshares*\"\n      or winlog.event_data.ScriptBlockText : \"*Snaffler*\"\n      or winlog.event_data.ScriptBlockText : \"*oxidresolver*\"\n      or winlog.event_data.ScriptBlockText : \"*Spoolvulnscan*\"\n      or winlog.event_data.ScriptBlockText : \"*GPORemoteAccessPolicy*\"\n      or winlog.event_data.ScriptBlockText : \"*Printercheck*\"\n      or winlog.event_data.ScriptBlockText : \"*GPOAudit*\"\n      or winlog.event_data.ScriptBlockText : \"*reconAD*\"\n      or winlog.event_data.ScriptBlockText : \"*Bluekeep*\"\n      or winlog.event_data.ScriptBlockText : \"*zerologon*\"\n      or winlog.event_data.ScriptBlockText : \"*PowerSQL*\"\n      or winlog.event_data.ScriptBlockText : \"*hacktool*\"\n      or winlog.event_data.ScriptBlockText : \"*Get-currentIP*\"\n      or winlog.event_data.ScriptBlockText : \"*Sharphound*\"\n      or winlog.event_data.ScriptBlockText : \"*itm4nprivesc*\"\n      or winlog.event_data.ScriptBlockText : \"*winPEAS*\"\n      or winlog.event_data.ScriptBlockText : \"*Reg1c1de*\"\n      or winlog.event_data.ScriptBlockText : \"*laZagnemodule*\"\n      or winlog.event_data.ScriptBlockText : \"*latmov*\"\n      or winlog.event_data.ScriptBlockText : \"*Domainpassspray*\"\n      or winlog.event_data.ScriptBlockText : \"*Shareenumeration*\"\n      or winlog.event_data.ScriptBlockText : \"*proxydetect*\"\n      or winlog.event_data.ScriptBlockText : \"*Kerberoasting*\"\n      or winlog.event_data.ScriptBlockText : \"*inv-phantom*\"\n      or winlog.event_data.ScriptBlockText : \"*Lapschecks*\"\n      or winlog.event_data.ScriptBlockText : \"*Mimiload*\"\n      or winlog.event_data.ScriptBlockText : \"*BlockEtw*\"\n      or winlog.event_data.ScriptBlockText : \"*WinPwn*\"\n      or winlog.event_data.ScriptBlockText : \"*scriptblocklogbypass*\"\n      or (winlog.event_data.ScriptBlockText : \"*loldrivers.io*\" and winlog.event_data.ScriptBlockText : \"*api*\" and winlog.event_data.ScriptBlockText : \"*drivers.json*\")\n    )","filters":[],"actions":[]}
{"id":"b8a42f38-591c-47c5-954a-236ee012efa5","updated_at":"2025-03-26T02:14:13.207Z","updated_by":"purple1","created_at":"2025-03-25T02:37:08.204Z","created_by":"elastic","name":"UC180 : Suspicious ddexec Privilege Escalation by Usage For Execution In Memory (via cmdline)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":2,"description":"Attackers can utilize shell scripting with ddexec to hijack process memory in order to execute other programs without touching disk\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"241afed9-5ce3-4e7a-95d7-bd6ae18a87ae","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://github.com/arget13/DDexec"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.args in (\"base64\",\".b64\")\n        and process.args in (\"bash\", \"zsh\", \".ash\")\n        and process.args : \"/bin/\"\n        and process.args : \"ddexec\"\n","filters":[],"actions":[]}
{"id":"d7170e21-bf95-4524-a063-30b70892f5e6","updated_at":"2025-03-26T02:38:10.743Z","updated_by":"purple1","created_at":"2025-03-25T02:37:34.307Z","created_by":"elastic","name":"UC271 : Downloads to Suspicious Folders (via cmdline)","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":2,"description":"Detects a file download and saves it to a temporary directory.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a2020f3d-d337-402a-beb5-058f51b43143","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.rapid7.com/blog/post/2023/02/07/etr-cve-2022-21587-rapid7-observed-exploitation-of-oracle-e-business-suite-vulnerability/","https://github.com/pha5matis/Pentesting-Guide/blob/master/privilege_escalation_-_linux.md","https://www.secureworks.com/research/gold-melody-profile-of-an-initial-access-broker"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\" \n      and event.action : \"execve\" \n      and \n      (\n        process.executable in (\"sh\", \"crond\")\n        and process.args in  (\"wget\", \"curl\", \"tftp\", \"ftp\")\n      )\n      and process.args in (\"/tmp\",\"/var/tmp\",\"/dev/shm\",\"/run/shm\",\"/var/spool/vbox\",\"/var/sppool/samba\")\n      and not process.args in (\"/dpkg-deb\",\"github\",\"Homebrew\",\"cookie\")","filters":[],"actions":[]}
{"id":"765a63a8-ba39-423f-865a-2988bc4873c4","updated_at":"2025-03-25T02:37:42.337Z","updated_by":"elastic","created_at":"2025-03-25T02:37:42.337Z","created_by":"elastic","name":"UC276 : Sudo Vulnerability Check Detection Patterns (CVE-2021-3156)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"This rule detects activity related for checking target to be vulnerable against CVE-2021-3156 (Heap-based buffer overflow in Sudo).\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"bf535a13-b30f-471e-94bd-8f2cdf4d4413","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548","subtechnique":[]},{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068","subtechnique":[]}]}],"to":"now","references":["https://www.sudo.ws/alerts/unescape_overflow.html","https://www.qualys.com/2021/01/26/cve-2021-3156/baron-samedit-heap-based-overflow-sudo.txt"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\" and event.action : \"execve\" and process.executable : \"sudoedit\" and process.args : \"-s\" and process.args : \"/\"","filters":[],"actions":[]}
{"id":"cc3bb53e-e97c-4d67-b485-94a7c902e997","updated_at":"2025-04-09T01:45:01.231Z","updated_by":"purple1","created_at":"2025-04-09T01:45:01.231Z","created_by":"purple1","name":"UC046 : Windows Discovery Network Share","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detected attackers spy on information about shared folders and files on windows.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"9e74ee97-902f-4920-848a-bd4971cc7432","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1135","name":"Network Share Discovery","reference":"https://attack.mitre.org/techniques/T1135","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1135/T1135.md"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and event.code : \"4688\"\n    and winlog.event_data.NewProcessName in (\"*\\\\net.exe\", \"*\\\\net1.exe\") and winlog.event_data.CommandLine in (\"* view *\", \"* share *\")","filters":[],"actions":[]}
{"id":"524ea55a-e4c0-49ad-90b5-e3e253942d23","updated_at":"2025-04-10T08:21:27.536Z","updated_by":"purple1","created_at":"2025-04-10T08:21:27.536Z","created_by":"purple1","name":"UC242 : Possible PingCastle Tool Patterns (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"PingCastle is a security assessment tool for Active Directory environments. It scans and scores the security of AD structures, identifies vulnerabilities, misconfigurations, and trust issues, and provides detailed reports with remediation recommendations, making it valuable for improving AD security. Detection based on command line patterns that could be related to PingCastle execution.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"ff5ab406-2a05-4f3b-82e9-a04357cb8208","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://www.pingcastle.com/","https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/","https://cheatsheet.haax.fr/windows-systems/network-and-domain-recon/domain_mapping/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and (winlog.event_data.NewProcessName : \"*\\\\PingCastle.exe\" \n    or winlog.event_data.NewProcessName : \"*\\\\.exe\" and \n    (winlog.event_data.CommandLine : \"* -healthcheck *\" and winlog.event_data.CommandLine : \"* full *\"\n    or winlog.event_data.CommandLine : \"* -healthcheck *\" and winlog.event_data.CommandLine : \"* -server*\"\n    or winlog.event_data.CommandLine : \"* --carto\"))","filters":[],"actions":[]}
{"id":"6e508621-c5cf-4ee5-b46b-c7600eed360c","updated_at":"2025-04-09T08:04:44.546Z","updated_by":"purple1","created_at":"2025-04-09T08:04:44.546Z","created_by":"purple1","name":"UC081 : Modify An AD Security-Enabled Universal Group","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Modify an AD security-enabled universal group.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"da3cd3aa-ebdb-4a0d-82a2-da2644e9cd44","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0003","name":"Persistence","reference":"https://attack.mitre.org/tactics/TA0003"},"technique":[{"id":"T1098","name":"Account Manipulation","reference":"https://attack.mitre.org/techniques/T1098","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and event.code in (\"4755\", \"4756\", \"4757\" , \"4758\")","filters":[],"actions":[]}
{"id":"3dfecf2f-d18f-4780-b820-f460ecc04841","updated_at":"2025-04-17T04:00:40.869Z","updated_by":"purple1","created_at":"2025-04-08T09:18:35.856Z","created_by":"purple1","name":"UC041 : Windows Discovery Software","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":2,"description":"Detected attackers spy on security applications/software on windows.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e5dad29a-f70c-4bbd-bc3a-6675e0ae3c81","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1010","name":"Application Window Discovery","reference":"https://attack.mitre.org/techniques/T1010","subtechnique":[]},{"id":"T1518","name":"Software Discovery","reference":"https://attack.mitre.org/techniques/T1518","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518.001/T1518.001.md","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1518/T1518.md#atomic-test-2---applications-installed","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1047/T1047.md#atomic-test-3---wmi-reconnaissance-software "],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (\n      winlog.event_data.NewProcessName in (\"*\\\\wmic.exe\") and winlog.event_data.CommandLine in (\"* path AntiVirusProduct *\",\"* path FirewallProduct *\")\n      or winlog.event_data.NewProcessName in (\"*\\\\netsh.exe\") and winlog.event_data.CommandLine : \"* advfirewall show *\"\n      or winlog.event_data.NewProcessName in (\"*\\\\findstr.exe\") and winlog.event_data.CommandLine in (\"* /i virus *\", \"* /i cb *\", \"* /i defender *\", \"* /i cylance *\")\n      or winlog.event_data.CommandLine in (\"HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\*\", \"HKLM:\\\\Software\\\\Wow6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\*\", \"HKLM:\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\*\")\n      or winlog.event_data.NewProcessName in (\"*\\\\WMIC.exe\") and winlog.event_data.CommandLine : \"* qfe *\"\n    )","filters":[],"actions":[]}
{"id":"4fd3b530-882d-42e2-bd1d-517785ecec7d","updated_at":"2025-04-16T03:45:41.325Z","updated_by":"purple1","created_at":"2025-04-16T03:45:41.325Z","created_by":"purple1","name":"UC357 : FireEye Red Team Tool - Modified Impacket WMIEXEC (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"This rule has been ported from Fireeye's HXIOC format to SIGMA. It detects a modified implmentation of WMIEXEC by FireEye.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"5fa4df29-61d3-4761-b723-bdc1d55e938c","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":["https://github.com/fireeye/red_team_tool_countermeasures/blob/ac479ae150e1541445023952f569b7ca0d190b7b/rules/IMPACKETOBF/production/hxioc/IMPACKET-OBFUSCATION%20WMIEXEC%20(UTILITY).ioc","https://github.com/fireeye/red_team_tool_countermeasures/blob/master/LICENSE.txt"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n  and winlog.event_data.ParentProcessName : \"*\\\\WmiPrvSE.exe\" and winlog.event_data.NewProcessName : \"*\\\\cmd.exe\" and winlog.event_data.CommandLine : \"* cmd.exe *\" and winlog.event_data.CommandLine : \"* /Q *\" and winlog.event_data.CommandLine : \"* /K *\" and winlog.event_data.CommandLine : \"* 127.0.0.1 *\" and winlog.event_data.CommandLine : \"* Admin *\" and winlog.event_data.CommandLine : \"* dat *\" and winlog.event_data.CommandLine : \"* $ *\" and winlog.event_data.CommandLine : \"* \\\\ *\"","filters":[],"actions":[]}
{"id":"fb2245a2-b47d-44e1-b3d5-a023d73dde6b","updated_at":"2025-04-10T01:39:10.959Z","updated_by":"purple1","created_at":"2025-04-10T01:39:10.959Z","created_by":"purple1","name":"UC190 : Possible Raccoon Stealer Behavior by Creating Suspicious Processes (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"This rule detects suspicious processes associated with Raccoon Stealer.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"20daf978-835c-49a1-87dc-0bb852d0c990","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[]}],"to":"now","references":["https://app.any.run/tasks/f016a1d8-f0ad-443c-85dd-75108bec2ea1/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\cmd.exe\" and winlog.event_data.ParentProcessName : \"*\\\\forfiles.exe\" and winlog.event_data.CommandLine : \"* SpyNetReporting *\"","filters":[],"actions":[]}
{"id":"08a1e6f3-4bce-424c-bb1c-cb04d5e5ca55","updated_at":"2025-04-15T04:06:48.883Z","updated_by":"purple1","created_at":"2025-04-15T04:06:48.883Z","created_by":"purple1","name":"UC312 : Possible Impacket SecretDump Activity (via audit)","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detects credential dumping using the impacket python script secretdump.py","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"97005110-ff65-410b-8b36-6f1b36eb3265","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[]}]}],"to":"now","references":["https://www.microsoft.com/en-us/security/blog/2023/07/11/storm-0978-attacks-reveal-financial-and-espionage-motives/","https://blog.menasec.net/2019/02/threat-huting-10-impacketsecretdump.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and event.code : \"5145\" and winlog.event_data.TargetName : \"* SYSTEM *\" and winlog.event_data.TargetName : \"* tmp *\"\n  and not (winlog.event_data.SubjectUserName : \"*$\" \n  or winlog.event_data.ShareName : \"* DFS *\"  and winlog.event_data.ShareName : \"* Link *\" and winlog.event_data.ShareName : \"* Shared *\" and winlog.event_data.ShareName : \"* Data *\")","filters":[],"actions":[]}
{"id":"8438d12c-3b7c-4fd5-8edc-8823105483cf","updated_at":"2025-02-27T10:31:37.729Z","updated_by":"elastic","created_at":"2025-02-27T10:31:37.729Z","created_by":"elastic","name":"UC320 : Installation of Mimikatz Driver (via audit)","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Mimikatz driver was installed.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e98e5743-93a4-443b-b1c3-b7305e0be812","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[]}]}],"to":"now","references":["https://github.com/gentilkiwi/mimikatz/blob/master/mimidrv/mimidrv.rc"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (\n        event.code : \"7045\" and winlog.event_data.ServiceName : \"*mimidrv*\"\n    )","filters":[],"actions":[]}
{"id":"18b6e814-10e6-4e23-b275-b25eb21db10d","updated_at":"2025-04-15T04:33:59.382Z","updated_by":"purple1","created_at":"2025-02-27T10:31:39.736Z","created_by":"elastic","name":"UC323 : Possible Local Privilege Escalation via KrbRelayUp Tool (via audit)","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":1,"description":"KrbRelayUp - a universal no fix local privilege escalation in windows domain environments where LDAP signing is not enforced (the default settings).","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"e2715381-ea2a-45b0-94b5-e0d956507643","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (event.code : \"4697\" and winlog.event_data.ServiceName : \"*KrbSCM*\"\n    or\n    (event.code : \"4624\" and winlog.event_data.AuthenticationPackageName : \"Kerberos\" and winlog.event_data.ElevatedToken : \"*1842\" and (winlog.event_data.IpAddress : \"127.0.0.1\" or winlog.event_data.IpAddress : \"-\") and winlog.event_data.TargetUserSid : \"*-500\"\n      and winlog.event_data.ProcessId : \"0x0\" and winlog.event_data.SubjectLogonId : \"0x0\"))","filters":[],"actions":[]}
{"id":"1fdba26e-523d-43ab-a7d7-b809f20389b3","updated_at":"2025-04-16T08:51:21.417Z","updated_by":"purple1","created_at":"2025-02-25T04:10:03.474Z","created_by":"elastic","name":"UC377 : LOLBAS WScript / Cscript with Powershell (via process_creation)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Identifies the employment of WScript as a living-off-the-land tactic in conjunction with PowerShell.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"4ec812eb-260b-45ca-b41e-12e57d8e7d4a","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1216","name":"System Script Proxy Execution","reference":"https://attack.mitre.org/techniques/T1216","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[{"id":"T1059.001","name":"PowerShell","reference":"https://attack.mitre.org/techniques/T1059/001"},{"id":"T1059.005","name":"Visual Basic","reference":"https://attack.mitre.org/techniques/T1059/005"}]}]}],"to":"now","references":["https://www.mcafee.com/blogs/other-blogs/mcafee-labs/from-email-to-rat-deciphering-a-vbs-script-driven-campaign/","https://www.zscaler.com/blogs/security-research/hibernating-qakbot-comprehensive-study-and-depth-campaign-analysis"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and (\n  (winlog.event_data.ParentProcessName : \"*\\\\WScript.exe\" and winlog.event_data.NewProcessName : \"*\\\\powershell.exe\" and winlog.event_data.CommandLine in (\"* Unrestricted\", \"* Webrequest\", \"* iwr\", \"* hidden\", \"* bypass\", \"* download\", \"* http\", \"* [String]\", \"* -command\") and winlog.event_data.CommandLine in (\"* File *\", \"* Windows *\", \"* secops.ps1 *\")) \n    or winlog.event_data.ParentProcessName : \"*\\\\Cscript.exe\" and winlog.event_data.NewProcessName: \"*\\\\powershell.exe\")","filters":[],"actions":[]}
{"id":"2bb3488e-9fcc-4053-bba6-c1c7c11652d5","updated_at":"2025-04-16T03:12:56.829Z","updated_by":"purple1","created_at":"2025-04-16T03:12:56.829Z","created_by":"purple1","name":"UC351 : Possible Execution by Disabling of LSA Protection (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may try to disable LSA protection in order to perfom their malicious actions.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"b968eedb-8a8a-41d0-b9fb-5c32183c3526","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]}],"to":"now","references":["https://itm4n.github.io/lsass-runasppl/","https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/","https://github.com/RedCursorSecurityConsulting/PPLKiller?tab=readme-ov-file","https://medium.com/h7w/lsa-protection-bypass-detection-16e8db3ab66c"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n  and (winlog.event_data.CommandLine : \"* reg *\" and winlog.event_data.CommandLine : \"* CurrentControlSet *\" and winlog.event_data.CommandLine : \"* Control *\" and winlog.event_data.CommandLine : \"* LSA *\" and winlog.event_data.CommandLine : \"* RunAsPPL *\" and winlog.event_data.CommandLine : \"* REG_DWORD *\" and winlog.event_data.CommandLine : \"* 0 *\"\n  or winlog.event_data.NewProcessName : \"*\\\\PPLKiller.exe\" and winlog.event_data.NewProcessName : \"PPLKiller.exe\" and winlog.event_data.CommandLine in (\"* //installDriver *\", \"* //disableLSAProtection *\"))","filters":[],"actions":[]}
{"id":"b34f0fe6-027e-4aeb-aa17-a17c7c652a42","updated_at":"2025-04-09T07:05:25.563Z","updated_by":"purple1","created_at":"2025-04-09T07:05:25.563Z","created_by":"purple1","name":"UC071 : Tunnel Establishment Tool Detected","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detect tunneling technique using.","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a99ccb19-b0ed-4326-b87d-1dbf44d4d151","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1090","name":"Proxy","reference":"https://attack.mitre.org/techniques/T1090","subtechnique":[]},{"id":"T1572","name":"Protocol Tunneling","reference":"https://attack.mitre.org/techniques/T1572","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1090.001/T1090.001.md","https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html","https://tdm.socprime.com/tdm/info/med0dZc0EZC0/#sigma"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":" any where host.os.type : \"windows\" and (\nwinlog.event_data.NewProcessName : \"*\\\\plink.exe\" and winlog.event_data.CommandLine : \"* :(127\\\\.0\\\\.0\\\\.1|localhost)\\\\:\\\\d+ \" \nor winlog.event_data.NewProcessName : \"*\\\\netsh.exe\" and winlog.event_data.CommandLine in (\"* portproxy *\", \"* add *\"))","filters":[],"actions":[]}
{"id":"3cc697ec-d3d8-4b34-b858-c5229a096be8","updated_at":"2025-04-14T02:47:19.825Z","updated_by":"purple1","created_at":"2025-04-14T02:47:19.825Z","created_by":"purple1","name":"UC265 : Suspicious MsiExec Remote Installer Hidden Installation Attempts (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"Detects the use of MsiExec as a living off the land technique to fetch and execute a hidden installation of a possible malware MSI package.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"cc55ade2-a1f6-4328-a6cf-1a23c94b11c8","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1218","name":"System Binary Proxy Execution","reference":"https://attack.mitre.org/techniques/T1218","subtechnique":[{"id":"T1218.007","name":"Msiexec","reference":"https://attack.mitre.org/techniques/T1218/007"}]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":["https://arcticwolf.com/resources/blog/tellmethetruth-exploitation-of-cve-2023-46604-leading-to-ransomware/","https://redcanary.com/blog/intelligence-insights-june-2022/","https://lolbas-project.github.io/lolbas/Binaries/Msiexec/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and winlog.event_data.NewProcessName : \"*\\\\MsiExec.exe\" \n    and winlog.event_data.CommandLine in (\"* http *\", \"* :// *\")\n    and winlog.event_data.CommandLine in (\"* quiet *\", \"* /q *\", \"* -q *\", \"* -z *\", \"* /z *\", \"* /i*\", \"* -i*\")","filters":[],"actions":[]}
{"id":"025d3bcc-aa3c-4417-a4db-39ad4ae1f803","updated_at":"2025-04-16T08:34:26.127Z","updated_by":"purple1","created_at":"2025-02-25T04:11:09.556Z","created_by":"elastic","name":"UC362 : Suspicious Mshta.EXE Execution Patterns","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects suspicious mshta process execution patterns\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"563e238c-44d0-451e-b475-ca4167e08100","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1106","name":"Native API","reference":"https://attack.mitre.org/techniques/T1106","subtechnique":[]}]}],"to":"now","references":["https://www.echotrail.io/insights/search/mshta.exe","https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    ((winlog.event_data.NewProcessName : \"*\\\\mshta.exe\" and winlog.event_data.OriginalFileName : \"MSHTA.EXE\" and winlog.event_data.ParentProcessName in (\"*\\\\cmd.exe\", \"*\\\\cscript.exe\", \"*\\\\powershell.exe\", \"*\\\\pwsh.exe\", \"*\\\\regsvr32.exe\", \"*\\\\rundll32.exe\", \"*\\\\wscript.exe\") and winlog.event_data.CommandLine in (\"* AppData\\\\Local *\", \"* C:\\\\ProgramData\\\\ *\", \"* C:\\\\Users\\\\Public\\\\ *\", \"* C:\\\\Windows\\\\Temp\\\\ *\"))\n      or (winlog.event_data.NewProcessName : \"*\\\\mshta.exe\" and winlog.event_data.OriginalFileName : \"MSHTA.EXE\" and not (winlog.event_data.NewProcessName in (\"C:\\\\Windows\\\\System32\\\\*\", \"C:\\\\Windows\\\\SysWOW64\\\\*\") and winlog.event_data.CommandLine in (\"* .htm *\", \"* .hta *\", \"*\\\\mshta.exe\", \"*\\\\mshta\"))))","filters":[],"actions":[]}
{"id":"246c063f-263f-44c2-8798-5c4c30867bac","updated_at":"2025-04-17T02:36:59.378Z","updated_by":"purple1","created_at":"2025-04-17T02:36:59.378Z","created_by":"purple1","name":"UC397 : Possible php Application Command and Control by Reverse Shell Inline Execution   (via cmdline)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":0,"description":"This rule identifies a reverse shell that uses the php shell utility to handle streams of commands and output over a network device file","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"267014f9-f93f-4455-85ac-2e3dcdb59543","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[{"id":"T1095","name":"Non-Application Layer Protocol","reference":"https://attack.mitre.org/techniques/T1095","subtechnique":[]}]}],"to":"now","references":["https://highon.coffee/blog/reverse-shell-cheat-sheet/","https://www.php.net/manual/en/function.fsockopen.php"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.NewProcessName : \"*\\\\php\" and winlog.event_data.CommandLine in (\"* -r *\", \"* fsockopen( *\", \"* fsockopen( *\") and winlog.event_data.CommandLine regex \".{0,5}sh.*[3-9][0-9]*\"","filters":[],"actions":[]}
{"id":"489e2eab-476a-4f80-9b96-469ab25f77cb","updated_at":"2025-04-10T09:39:59.525Z","updated_by":"purple1","created_at":"2025-04-10T09:39:59.525Z","created_by":"purple1","name":"UC246 : Active Directory Replication from Non Machine Account","tags":["product: windows","service: security"],"interval":"5m","enabled":true,"revision":0,"description":"Detects potential abuse of Active Directory Replication Service (ADRS) from a non machine account to request credentials.","risk_score":99,"severity":"critical","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"dfee5dab-acfd-41ee-9382-8271cff208be","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1003","name":"OS Credential Dumping","reference":"https://attack.mitre.org/techniques/T1003","subtechnique":[{"id":"T1003.006","name":"DCSync","reference":"https://attack.mitre.org/techniques/T1003/006"}]}]}],"to":"now","references":["https://threathunterplaybook.com/hunts/windows/180815-ADObjectAccessReplication/notebook.html","https://threathunterplaybook.com/library/windows/active_directory_replication.html"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" \n    and event.code : \"4662\"\n    and winlog.event_data.AccessMask : \"0x100\" \n    and winlog.event_data.Properties in (\"* 1131f6aa-9c07-11d1-f79f-00c04fc2dcd2 *\", \"* 1131f6ad-9c07-11d1-f79f-00c04fc2dcd2 *\", \"* 89e95b76-444d-4c62-991a-0facbeda640c *\")\n    and not (winlog.event_data.SubjectUserName: \"* $\" or  winlog.event_data.SubjectUserName: \"MSOL_*\")","filters":[],"actions":[]}
{"id":"f293a60e-8e28-45dc-ad9f-f9183bf37129","updated_at":"2025-04-10T02:05:28.445Z","updated_by":"purple1","created_at":"2025-04-10T01:45:56.077Z","created_by":"purple1","name":"UC192 : Permission Groups Discovery (Local Groups)","tags":["product: windows","category: ps_script"],"interval":"5m","enabled":true,"revision":1,"description":"Permission Groups Discovery (Local Groups)","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"178c74d6-6c2c-462c-81b6-2e765c052c42","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1069","name":"Permission Groups Discovery","reference":"https://attack.mitre.org/techniques/T1069","subtechnique":[{"id":"T1069.001","name":"Local Groups","reference":"https://attack.mitre.org/techniques/T1069/001"}]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and \n    (event.code : \"4688\" and winlog.event_data.CommandLine in (\"* net  localgroup *\", \"* wmic * group *\")\n    or event.code : \"4104\" and winlog.event_data.ScriptBlockText in (\"* net localgroup *\", \"* get-locagroup *\", \"* get-WMIObject * Win32_Group *\", \"* wmic * group *\"))","filters":[],"actions":[]}
{"id":"4f97ee42-1aed-46cf-82db-bf92d1671e9d","updated_at":"2025-04-10T09:47:58.628Z","updated_by":"purple1","created_at":"2025-02-27T10:30:40.365Z","created_by":"elastic","name":"UC252 : CVE-2020-1350 DNS Remote Code Exploit [SIGRED] (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detects exploitation of CVE-2020-1350 (aka SIGRED) using suspicious child processes spawned by the exploitable Windows DNS process.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"a59244d2-2f87-4c54-ba7f-15b66129ffa4","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and winlog.event_data.ParentProcessName : \"*\\\\System32\\\\dns.exe\" and winlog.event_data.NewProcessName in (\"*\\\\werfault.exe\", \"*conhost.exe\")","filters":[],"actions":[]}
{"id":"08812d68-9a95-454d-ae5a-5b10b31e0687","updated_at":"2025-04-17T02:48:09.606Z","updated_by":"purple1","created_at":"2025-02-25T04:08:03.144Z","created_by":"elastic","name":"UC024 : Pass The Cache Attack","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"The attack technique allows to steal kerberos license information from linux system and use to authenticate on windows system in Active Directory environment without the need for account password.","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"59118f15-9401-45f8-84fe-095cf8ee62eb","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0008","name":"Lateral Movement","reference":"https://attack.mitre.org/tactics/TA0008"},"technique":[{"id":"T1550","name":"Use Alternate Authentication Material","reference":"https://attack.mitre.org/techniques/T1550","subtechnique":[]}]}],"to":"now","references":["https://stealthbits.com/blog/lateral-movement-through-pass-the-cache/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"\nany where host.os.type : \"windows\" and winlog.event_data.NewProcessName: \"*\\\\mimikatz.exe\" and winlog.event_data.CommandLine : \"* kerberos::ptc *\"","filters":[],"actions":[]}
{"id":"81ceb88a-47b6-451c-8388-f0f5747814b4","updated_at":"2025-04-16T08:16:39.838Z","updated_by":"purple1","created_at":"2025-02-25T04:11:37.571Z","created_by":"elastic","name":"UC361 : Disable Windows Defender Realtime Monitoring (via cmdline)","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Adversaries may disable security tools, such like Windows Defender, to avoid possible detection of their tools and activities.\n","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"22b6f94c-e28e-4fcc-8155-87a498ed1e88","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1562","name":"Impair Defenses","reference":"https://attack.mitre.org/techniques/T1562","subtechnique":[]}]}],"to":"now","references":["https://blog.sekoia.io/lucky-mouse-incident-response-to-detection-engineering/","https://malware.news/t/signed-dll-campaigns-as-a-service/56219","https://asec.ahnlab.com/ko/61288/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\" and\n    (winlog.event_data.CommandLine in (\"*true*\", \"*Add*\") and winlog.event_data.CommandLine in (\"*ExclusionProcess*\", \"*ExclusionPath*\", \"*ExclusionExtension*\")\n        or winlog.event_data.CommandLine in (\"*true*\", \"*Add*\") and winlog.event_data.CommandLine in (\"*DisableAntiSpyware*\", \"*DisableBehaviorMonitoring*\", \"*DisableIOAVProtection*\", \"*DisableOnAccessProtection*\", \"*DisableRealtimeMonitoring*\", \"*DisableScanOnRealtimeEnable*\", \"*DisableEnhancedNotifications*\", \"*DisableBlockAtFirstSeen*\", \"*DisableScriptScanning*\", \"*DisableIntrusionPreventionSystem*\", \"*DisableArchiveScanning*\", \"*SignatureDisableUpdateOnStartupWithoutEngine*\", \"*DisablePrivacyMode*\", \"*PUAProtection*\"))","filters":[],"actions":[]}
{"id":"243ac4eb-e5b6-42b7-b91d-2477dd472999","updated_at":"2025-03-25T02:48:46.661Z","updated_by":"purple1","created_at":"2025-03-25T02:36:21.717Z","created_by":"elastic","name":"UC143 : System shutdown or reboot","tags":["product: linux","service: auditd"],"interval":"5m","enabled":true,"revision":0,"description":"Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems. Operating systems may contain commands to initiate a shutdown/reboot of a machine or network device.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"c8f5de55-9f8b-49f7-a709-31c67e77f2e9","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0040","name":"Impact","reference":"https://attack.mitre.org/tactics/TA0040"},"technique":[{"id":"T1529","name":"System Shutdown/Reboot","reference":"https://attack.mitre.org/techniques/T1529","subtechnique":[]}]}],"to":"now","references":[],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and \n        (\n            (\n                event.action : \"execve\"\n                and process.args in (\"%_init 0%\", \"%_halt %\", \"%_reboot %\", \"%_poweroff%\", \"%_init 6%\", \"%_shutdown%\")\n            )\n            or\n            (\n                event.action in (\"boot\", \"shutdown\")\n            )\n        )","filters":[],"actions":[]}
{"id":"c5f35cba-3d76-48a8-932a-442df096766b","updated_at":"2025-03-26T02:11:40.129Z","updated_by":"purple1","created_at":"2025-03-25T02:37:06.170Z","created_by":"elastic","name":"UC179 : CVE-2021-41773 via a path traversal vulnerability in Apache (via linux).","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"This rule is detect commands with arguments of CVE-2021-41773 via a path traversal vulnerability in the event mod-cgi is enabled and CVE-2021-42013 via Remote Code Execution on Apache","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"69660537-36b4-4d4c-aefa-99a19fbbc3f5","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[],"to":"now","references":["https://twitter.com/hackerfantastic/status/1445531829985968137?s=20"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.executable : \"curl\"\n        and process.args : \"--data\"\n        and process.args : \"A=|id>>/tmp/x;uname\\\\$IFS-a>>/tmp/x\"\n        and process.args : \"cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh\"","filters":[],"actions":[]}
{"id":"2566067b-bac6-4347-a9f6-2810471c4ab8","updated_at":"2025-04-17T03:50:32.658Z","updated_by":"purple1","created_at":"2025-04-08T08:24:16.476Z","created_by":"purple1","name":"UC036 : Registry Query Execution","tags":["product: windows","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Detected when attackers use the reg.exe utility available on windows to spy on registry information on the system, especially the registry stores important information","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"https://elk.gsoc.ncc.local/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"ec3276e6-3a62-4dac-884b-18f2db46952b","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0007","name":"Discovery","reference":"https://attack.mitre.org/tactics/TA0007"},"technique":[{"id":"T1012","name":"Query Registry","reference":"https://attack.mitre.org/techniques/T1012","subtechnique":[]}]}],"to":"now","references":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1012/T1012.md","https://lolbas-project.github.io/lolbas/Binaries/Regedit/","https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"and\n    (\n      winlog.event_data.NewProcessName : \"*\\\\reg.exe\" and winlog.event_data.CommandLine : \"* query *\" \n      or  winlog.event_data.NewProcessName : \"*\\\\regedit.exe\" and winlog.event_data.CommandLine in (\"* /E *\", \"* -E *\", \"* export *\")\n    )","filters":[],"actions":[]}
{"id":"f5b80092-98e0-4152-8eba-3039c80e1268","updated_at":"2025-03-26T02:48:10.890Z","updated_by":"purple1","created_at":"2025-03-25T02:37:40.329Z","created_by":"elastic","name":"UC274 : Possible Malicious php (GTFOBin) Activity by Use of Unusual Command Arguments (via cmdline)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"Php can be used by attackers to start system shells, run commands, reverse shells, modify/download files, and abuse SUID/Sudo privileges.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"8198b6bc-9794-4026-80c6-0142af3ab8ef","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068","subtechnique":[]},{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0009","name":"Collection","reference":"https://attack.mitre.org/tactics/TA0009"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010"},"technique":[]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0011","name":"Command and Control","reference":"https://attack.mitre.org/tactics/TA0011"},"technique":[]}],"to":"now","references":["https://gtfobins.github.io/gtfobins/php/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n        and event.action : \"execve\"\n        and process.executable : \"*php*\"\n        and process.args in (\"system(getenv\", \"passthru(getenv\", \"print(shell_exec\", \"exec(getenv\", \"popen(getenv\")\n        and\n        (\n            (process.args : \"array\" and process.args : \"pipe\")\n            or process.args : \"fsockopen(getenv\"\n            or process.args : \"file_get_contents\"\n            or process.args : \"file_put_contents\"\n            or process.args : \"readfile(getenv\"\n            or process.args : \"pcntl_exec(\"\n            or (process.args : \"sudo\" and process.args : \"system(\")\n        )","filters":[],"actions":[]}
{"id":"30729259-b1d5-4b30-9e74-0ddca146fe95","updated_at":"2025-04-15T04:23:27.229Z","updated_by":"purple1","created_at":"2025-02-27T10:31:29.695Z","created_by":"elastic","name":"UC316 : CVE-2021-31979 CVE-2021-33771 Exploits by Sourgum","tags":["product: windows","category: file_event"],"interval":"5m","enabled":true,"revision":3,"description":"Detects patterns as noticed in exploitation of Windows CVE-2021-31979 CVE-2021-33771 vulnerability and DevilsTongue malware by threat group Sourgum","risk_score":99,"severity":"critical","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"6d34fa0e-07a1-4d46-8a23-3aba625b1254","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1556","name":"Modify Authentication Process","reference":"https://attack.mitre.org/techniques/T1556","subtechnique":[]}]}],"to":"now","references":["https://www.microsoft.com/security/blog/2021/07/15/protecting-customers-from-a-private-sector-offensive-actor-using-0-day-exploits-and-devilstongue-malware/","https://citizenlab.ca/2021/07/hooking-candiru-another-mercenary-spyware-vendor-comes-into-focus/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and ( winlog.event_data.TargetFilename : \"* C:\\\\Windows\\\\system32\\\\physmem.sys *\"\n        or winlog.event_data.TargetFilename : \"* C:\\\\Windows\\\\System32\\\\IME\\\\IMEJP\\\\imjpueact.dll *\"\n        or winlog.event_data.TargetFilename : \"* C:\\\\Windows\\\\system32\\\\ime\\\\IMETC\\\\IMTCPROT.DLL *\"\n        or winlog.event_data.TargetFilename : \"* C:\\\\Windows\\\\system32\\\\ime\\\\SHARED\\\\imecpmeid.dll *\"\n        or winlog.event_data.TargetFilename : \"* C:\\\\Windows\\\\system32\\\\config\\\\spp\\\\ServiceState\\\\Recovery\\\\pac.dat *\"\n        or winlog.event_data.TargetFilename : \"* C:\\\\Windows\\\\system32\\\\config\\\\cy-GB\\\\Setup\\\\SKB\\\\InputMethod\\\\TupTask.dat *\"\n        or winlog.event_data.TargetFilename : \"* C:\\\\Windows\\\\system32\\\\config\\\\config\\\\startwus.dat *\"\n        or winlog.event_data.TargetFilename : \"* C:\\\\Windows\\\\system32\\\\ime\\\\SHARED\\\\WimBootConfigurations.ini *\"\n        or winlog.event_data.TargetFilename : \"* C:\\\\Windows\\\\system32\\\\ime\\\\IMEJP\\\\WimBootConfigurations.ini *\"\n        or winlog.event_data.TargetFilename : \"* C:\\\\Windows\\\\system32\\\\ime\\\\IMETC\\\\WimBootConfigurations.ini *\")","filters":[],"actions":[]}
{"id":"3eac7172-fa36-494a-8a14-c74573bcf179","updated_at":"2025-03-26T03:05:00.145Z","updated_by":"purple1","created_at":"2025-03-25T02:37:44.354Z","created_by":"elastic","name":"UC325 : Possible Python (GTFOBin) Activity by Use of Unusual Command Arguments (via cmdline)","tags":["product: linux","category: process_creation"],"interval":"5m","enabled":true,"revision":1,"description":"description: Python can be used by attackers to start system shells, reverse shells, load libraries, and modify & upload/download files.\n","risk_score":47,"severity":"medium","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"61b0a786-bb8d-4940-8a0d-e94a677b5811","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0004","name":"Privilege Escalation","reference":"https://attack.mitre.org/tactics/TA0004"},"technique":[{"id":"T1068","name":"Exploitation for Privilege Escalation","reference":"https://attack.mitre.org/techniques/T1068","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0005","name":"Defense Evasion","reference":"https://attack.mitre.org/tactics/TA0005"},"technique":[{"id":"T1548","name":"Abuse Elevation Control Mechanism","reference":"https://attack.mitre.org/techniques/T1548","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0006","name":"Credential Access","reference":"https://attack.mitre.org/tactics/TA0006"},"technique":[{"id":"T1212","name":"Exploitation for Credential Access","reference":"https://attack.mitre.org/techniques/T1212","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0009","name":"Collection","reference":"https://attack.mitre.org/tactics/TA0009"},"technique":[{"id":"T1005","name":"Data from Local System","reference":"https://attack.mitre.org/techniques/T1005","subtechnique":[]}]},{"framework":"MITRE ATT&CK","tactic":{"id":"TA0010","name":"Exfiltration","reference":"https://attack.mitre.org/tactics/TA0010"},"technique":[{"id":"T1567","name":"Exfiltration Over Web Service","reference":"https://attack.mitre.org/techniques/T1567","subtechnique":[]}]}],"to":"now","references":["https://www.cadosecurity.com/spinning-yarn-a-new-linux-malware-campaign-targets-docker-apache-hadoop-redis-and-confluence/","https://www.imperva.com/blog/imperva-detects-undocumented-8220-gang-activities/","https://gtfobins.github.io/gtfobins/python/"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"linux\"\n    and event.action : \"execve\"\n    and process.executable : \"*python*\"\n    and\n    (\n        ( process.args :\"os.system(\"  and process.args :\"sh\")\n        or ( process.args :\"socket\"  and process.args :\"connect\" and process.args :\"spawn\" and process.args :\"sh\")\n        or ( process.args : \"write\" and process.args : \"open\")\n        or ( process.args : \"read\" and process.args : \"open\" and process.args : \"print\")\n        or ( process.args : \"serve\" and process.args : \"socketserver\" and process.args : \"HTTP\")\n        or ( process.args : \"urllib\" and process.args : \"urlopen\" and process.args : \"read\")\n        or ( process.args : \"urllib\" and process.args : \"urlretrieve\" and process.args : \"request\")\n        or ( process.args : \"urllib2\" and process.args : \"urlopen\" and process.args : \"http\")\n        or ( process.args : \"ctypes\" and process.args : \"cdll\" and process.args : \"LoadLibrary\")\n    )","filters":[],"actions":[]}
{"id":"6017b0e2-2654-485e-8d9c-67a4ccd0569a","updated_at":"2025-04-10T04:46:56.061Z","updated_by":"purple1","created_at":"2025-02-27T10:30:18.215Z","created_by":"elastic","name":"UC222 : Accessing WinAPI in PowerShell","tags":["product: windows","category: ps_script"],"interval":"5m","enabled":true,"revision":1,"description":"Detecting use WinAPI Functions in PowerShell","risk_score":73,"severity":"high","license":"","output_index":"","meta":{"from":"1m","kibana_siem_app_url":"http://localhost:5601/app/security"},"author":[],"false_positives":[],"from":"now-360s","rule_id":"daeed1f8-fa41-47af-adc6-e88f73c1cdcf","max_signals":100,"risk_score_mapping":[],"severity_mapping":[],"threat":[{"framework":"MITRE ATT&CK","tactic":{"id":"TA0002","name":"Execution","reference":"https://attack.mitre.org/tactics/TA0002"},"technique":[{"id":"T1059","name":"Command and Scripting Interpreter","reference":"https://attack.mitre.org/techniques/T1059","subtechnique":[]},{"id":"T1106","name":"Native API","reference":"https://attack.mitre.org/techniques/T1106","subtechnique":[]}]}],"to":"now","references":["https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"],"version":1,"exceptions_list":[],"immutable":false,"related_integrations":[],"required_fields":[],"setup":"","type":"eql","language":"eql","index":["apm-*-transaction*","auditbeat-*","endgame-*","filebeat-*","logs-*","packetbeat-*","traces-apm*","winlogbeat-*","-*elastic-cloud-logs-*"],"query":"any where host.os.type : \"windows\"\n    and\n    (\n        winlog.event_data.ScriptBlockText : \"* WaitForSingleObject *\"\n        or winlog.event_data.ScriptBlockText : \"* QueueUserApc *\"\n        or winlog.event_data.ScriptBlockText : \"* RtlCreateUserThread *\"\n        or winlog.event_data.ScriptBlockText : \"* OpenProcess *\"\n        or winlog.event_data.ScriptBlockText : \"* VirtualAlloc *\"\n        or winlog.event_data.ScriptBlockText : \"* VirtualFree *\"\n        or winlog.event_data.ScriptBlockText : \"* WriteProcessMemory *\"\n        or winlog.event_data.ScriptBlockText : \"* CreateUserThread *\"\n        or winlog.event_data.ScriptBlockText : \"* CloseHandle *\"\n        or winlog.event_data.ScriptBlockText : \"* GetDelegateForFunctionPointer *\"\n        or winlog.event_data.ScriptBlockText : \"* CreateThread *\"\n        or winlog.event_data.ScriptBlockText : \"* memcpy *\"\n        or winlog.event_data.ScriptBlockText : \"* LoadLibrary *\"\n        or winlog.event_data.ScriptBlockText : \"* GetModuleHandle *\"\n        or winlog.event_data.ScriptBlockText : \"* GetProcAddress *\"\n        or winlog.event_data.ScriptBlockText : \"* VirtualProtect *\"\n        or winlog.event_data.ScriptBlockText : \"* FreeLibrary *\"\n        or winlog.event_data.ScriptBlockText : \"* ReadProcessMemory *\"\n        or winlog.event_data.ScriptBlockText : \"* CreateRemoteThread *\"\n        or winlog.event_data.ScriptBlockText : \"* AdjustTokenPrivileges *\"\n        or winlog.event_data.ScriptBlockText : \"* WriteInt32 *\"\n        or winlog.event_data.ScriptBlockText : \"* OpenThreadToken *\"\n        or winlog.event_data.ScriptBlockText : \"* ZeroFreeGlobalAllocUnicode *\"\n        or winlog.event_data.ScriptBlockText : \"* OpenProcessToken *\"\n        or winlog.event_data.ScriptBlockText : \"* GetTokenInformation *\"\n        or winlog.event_data.ScriptBlockText : \"* SetThreadToken *\"\n        or winlog.event_data.ScriptBlockText : \"* ImpersonateLoggedOnUser *\"\n        or winlog.event_data.ScriptBlockText : \"* RevertToSelf *\"\n        or winlog.event_data.ScriptBlockText : \"* GetLogonSessionData *\"\n        or winlog.event_data.ScriptBlockText : \"* CreateProcessWithToken *\"\n        or winlog.event_data.ScriptBlockText : \"* DuplicateTokenEx *\"\n        or winlog.event_data.ScriptBlockText : \"* OpenWindowStation *\"\n        or winlog.event_data.ScriptBlockText : \"* OpenDesktop *\"\n        or winlog.event_data.ScriptBlockText : \"* MiniDumpWriteDump *\"\n        or winlog.event_data.ScriptBlockText : \"* AddSecurityPackage *\"\n        or winlog.event_data.ScriptBlockText : \"* EnumerateSecurityPackages *\"\n        or winlog.event_data.ScriptBlockText : \"* GetProcessHandle *\"\n        or winlog.event_data.ScriptBlockText : \"* DangerousGetHandle *\"\n        or winlog.event_data.ScriptBlockText : \"* kernel32 *\"\n        or winlog.event_data.ScriptBlockText : \"* Advapi32 *\"\n        or winlog.event_data.ScriptBlockText : \"* msvcrt *\"\n        or winlog.event_data.ScriptBlockText : \"* ntdll *\"\n        or winlog.event_data.ScriptBlockText : \"* secur32 *\"\n    )\n    and not\n    (\n        winlog.event_data.ScriptBlockText : \"* # Copyright 2016 Amazon.com, Inc. or its affiliates. *\"\n    )","filters":[],"actions":[]}
{"exported_count":257,"exported_rules_count":257,"missing_rules":[{"rule_id":"4b4e9c99-27ea-4621-95c8-82341bc6e512"},{"rule_id":"9a1a2dae-0b5f-4c3d-8305-a268d404c306"}],"missing_rules_count":2,"exported_exception_list_count":0,"exported_exception_list_item_count":0,"missing_exception_list_item_count":0,"missing_exception_list_items":[],"missing_exception_lists":[],"missing_exception_lists_count":0,"exported_action_connector_count":0,"missing_action_connection_count":0,"missing_action_connections":[],"excluded_action_connection_count":0,"excluded_action_connections":[]}
