---
- name: List installed packages
  hosts: centos
  become: yes
  tasks:
    - name: Run dpkg to list installed packages on Debian/Ubuntu
      ansible.builtin.shell: dpkg -l
      register: dpkg_output
      when: ansible_os_family == "Debian"

    - name: Run rpm to list installed packages on RHEL/CentOS
      ansible.builtin.shell: rpm -qa
      register: rpm_output
      when: ansible_os_family == "RedHat"

    - name: Print installed packages (Debian/Ubuntu)
      ansible.builtin.debug:
        var: dpkg_output.stdout_lines
      when: ansible_os_family == "Debian"

    - name: Print installed packages (RHEL/CentOS)
      ansible.builtin.debug:
        var: rpm_output.stdout_lines
      when: ansible_os_family == "RedHat"
